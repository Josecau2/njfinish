import{j as e}from"./date-vendor-D9pAgX5F.js";import{u as s,r}from"./react-vendor-DF7UJAlN.js";import{h as t,e as a,u as i,H as l,U as o,V as n,I as c,b as d,d as m,W as u,X as x,J as p,a7 as f}from"./ui-vendor-DjmSPU99.js";import{P as h,l as g}from"./DefaultLayout-BUcG_pV2.js";import{u as j,a as b}from"./redux-vendor-BzdbewH4.js";import{u as y,O as v}from"./index-DW-yAxzW.js";import{S as N}from"./utils-vendor-Nl-sF5xe.js";import{c as k}from"./cil-arrow-left-D66Kb3Zq.js";import{c as w,a as C}from"./cil-user-follow-B22R2zcO.js";import{c as G}from"./cil-save-CHBg7z_U.js";import"./form-vendor-CKNVq0c_.js";import"./icons-vendor-D82TZqJV.js";const z=({title:s,icon:r,children:t,className:a="",customization:l={}})=>e.jsx(d,{className:`border-0 shadow-sm mb-2 mb-md-4 ${a}`,children:e.jsxs(m,{className:"p-3 p-md-4",children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-2 me-md-3",style:{width:"32px",height:"32px",backgroundColor:`${l.headerBg||"#667eea"}20`,color:l.headerBg||"#667eea"},children:e.jsx(i,{icon:r,size:"sm"})}),e.jsx("h6",{className:"mb-0 fw-semibold text-dark small",children:s})]}),t]})}),S=({label:s,name:r,type:t="text",required:a=!1,icon:l=null,placeholder:o="",value:n,onChange:d,isInvalid:m,feedback:h,...g})=>e.jsxs("div",{className:"mb-3",children:[e.jsxs(c,{htmlFor:r,className:"fw-medium text-dark mb-2 small",children:[s,a&&e.jsx("span",{className:"text-danger ms-1",children:"*"})]}),e.jsxs(u,{children:[l&&e.jsx(x,{className:"d-none d-md-flex",style:{background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",border:"1px solid #e3e6f0",borderRight:"none"},children:e.jsx(i,{icon:l,size:"sm",style:{color:"#6c757d"}})}),e.jsx(p,{id:r,name:r,type:t,value:n,onChange:d,invalid:m,placeholder:o,style:{border:"1px solid "+(m?"#dc3545":"#e3e6f0"),borderRadius:l?"0 8px 8px 0":"8px",fontSize:"14px",padding:"12px 16px",transition:"all 0.3s ease",borderLeft:l&&window.innerWidth>=768?"none":"1px solid #e3e6f0"},...g})]}),h&&e.jsx(f,{invalid:!0,children:h})]}),B={name:"",group_type:"standard",modules:{dashboard:!1,proposals:!1,customers:!1,resources:!1}},R=()=>{const{t:u}=y(),x=j(),p=s(),[f,R]=r.useState(B),I=r.useRef(B),[D,O]=r.useState({}),[$,A]=r.useState(!1),F=b(e=>e.customization),H=e=>{if(!e)return"#ffffff";const s=e.replace("#","");return(.299*parseInt(s.substr(0,2),16)+.587*parseInt(s.substr(2,2),16)+.114*parseInt(s.substr(4,2),16))/255>.5?"#2d3748":"#ffffff"},P=e=>{const{name:s,value:r,type:t,checked:a}=e.target;R(e=>({...e,[s]:"checkbox"===t?a:r})),D[s]&&O(e=>({...e,[s]:""}))};return e.jsxs(t,{fluid:!0,className:"p-1 p-md-2 m-0 m-md-2",style:{backgroundColor:"#f8fafc",minHeight:"100vh"},children:[e.jsx("style",{children:"\n                            .settings-form-container .btn, .notification-mobile-dropdown .btn, .btn { min-height: 44px; }\n                        "}),e.jsx(h,{title:e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"12px"},children:e.jsx(i,{icon:w,style:{fontSize:"16px",color:"white"}})}),u("settings.userGroups.create.title")]}),subtitle:u("settings.userGroups.create.subtitle"),rightContent:e.jsxs(a,{variant:"outline",onClick:()=>{p("/settings/users/groups")},className:"me-2","aria-label":u("common.back"),style:{borderColor:"rgba(255, 255, 255, 0.3)",color:"rgba(255, 255, 255, 0.9)"},children:[e.jsx(i,{icon:k,className:"me-1",size:"sm"}),u("common.back")]})}),e.jsxs(l,{onSubmit:async(e,s=!1)=>{if(e.preventDefault(),(()=>{const e={};return f.name.trim()||(e.name=u("settings.userGroups.form.validation.nameRequired")),O(e),0===Object.keys(e).length})()){A(!0);try{const e=await x(v({...f,force:s})),r=e?.payload;if(200===r?.status)return await N.fire(u("common.success")+"!",r.message||u("settings.userGroups.alerts.created"),"success"),void p("/settings/users/groups");const t=r?.message||e?.error?.message||u("settings.userGroups.alerts.createFailed");await N.fire(u("common.error"),t,"error")}catch(r){await N.fire(u("common.error"),r?.message||u("settings.userGroups.alerts.genericError"),"error")}finally{A(!1)}}},children:[e.jsxs(z,{title:u("settings.userGroups.form.titles.groupInfo"),icon:C,customization:F,children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"d-flex align-items-start p-3 rounded-3",style:{backgroundColor:"#fff3cd",border:"1px solid #ffecb5"},children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 flex-shrink-0",style:{width:"32px",height:"32px",backgroundColor:"#856404",color:"white"},children:e.jsx(i,{icon:g,size:"sm"})}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold text-dark small mb-1",children:u("settings.userGroups.about.title")}),e.jsx("div",{className:"text-muted",style:{fontSize:"12px",lineHeight:"1.4"},children:u("settings.userGroups.about.description")})]})]})}),e.jsxs(o,{children:[e.jsx(n,{xs:12,md:8,lg:6,children:e.jsx(S,{label:u("settings.userGroups.form.labels.name"),name:"name",required:!0,icon:C,placeholder:u("settings.userGroups.form.placeholders.name"),value:f.name,onChange:P,isInvalid:!!D.name,feedback:D.name})}),e.jsx(n,{xs:12,md:4,lg:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(c,{className:"fw-medium text-dark mb-2 small",children:[u("settings.userGroups.form.labels.type"),e.jsx("span",{className:"text-danger ms-1",children:"*"})]}),e.jsxs("select",{name:"group_type",value:f.group_type,onChange:P,className:"form-select",style:{border:"1px solid #e3e6f0",borderRadius:"8px",fontSize:"14px",padding:"12px 16px"},children:[e.jsx("option",{value:"standard",children:u("settings.userGroups.types.standard")}),e.jsx("option",{value:"contractor",children:u("settings.userGroups.types.contractor")})]})]})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-2",style:{width:"24px",height:"24px",backgroundColor:"#e6ffed",color:"#28a745"},children:e.jsx(i,{icon:g,size:"sm"})}),e.jsx("h6",{className:"mb-0 fw-semibold text-dark",style:{fontSize:"13px"},children:u("settings.userGroups.create.afterCreateTitle")})]}),e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex align-items-center p-2 rounded-2",style:{backgroundColor:"#f8f9fa"},children:[e.jsx("div",{className:"me-2",style:{color:"#28a745",fontSize:"12px"},children:"✓"}),e.jsx("span",{style:{fontSize:"12px",color:"#6c757d"},children:u("settings.userGroups.create.afterCreate.assignUsers")})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex align-items-center p-2 rounded-2",style:{backgroundColor:"#f8f9fa"},children:[e.jsx("div",{className:"me-2",style:{color:"#28a745",fontSize:"12px"},children:"✓"}),e.jsx("span",{style:{fontSize:"12px",color:"#6c757d"},children:u("settings.userGroups.create.afterCreate.setPermissions")})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex align-items-center p-2 rounded-2",style:{backgroundColor:"#f8f9fa"},children:[e.jsx("div",{className:"me-2",style:{color:"#28a745",fontSize:"12px"},children:"✓"}),e.jsx("span",{style:{fontSize:"12px",color:"#6c757d"},children:u("settings.userGroups.create.afterCreate.manageAccess")})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex align-items-center p-2 rounded-2",style:{backgroundColor:"#f8f9fa"},children:[e.jsx("div",{className:"me-2",style:{color:"#28a745",fontSize:"12px"},children:"✓"}),e.jsx("span",{style:{fontSize:"12px",color:"#6c757d"},children:u("settings.userGroups.create.afterCreate.bulkManagement")})]})})]})]})]}),"contractor"===f.group_type&&e.jsxs(z,{title:u("settings.userGroups.form.titles.modulePermissions"),icon:g,customization:F,children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"d-flex align-items-start p-3 rounded-3",style:{backgroundColor:"#e7f3ff",border:"1px solid #b3d7ff"},children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3 flex-shrink-0",style:{width:"32px",height:"32px",backgroundColor:F.headerBg||"#667eea",color:H(F.headerBg||"#667eea")},children:e.jsx(i,{icon:g,size:"sm"})}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold text-dark small mb-1",children:u("settings.userGroups.moduleAccess.title")}),e.jsx("div",{className:"text-muted",style:{fontSize:"12px",lineHeight:"1.4"},children:u("settings.userGroups.moduleAccess.description")})]})]})}),e.jsx(o,{children:Object.entries(f.modules).map(([s,r])=>e.jsxs(n,{xs:12,sm:6,md:3,className:"mb-3",children:[e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:`module-${s}`,name:`modules.${s}`,checked:r,onChange:e=>{R(r=>({...r,modules:{...r.modules,[s]:e.target.checked}}))},style:{width:"3rem",height:"1.5rem"}}),e.jsx("label",{className:"form-check-label fw-medium",htmlFor:`module-${s}`,children:s.charAt(0).toUpperCase()+s.slice(1)})]}),e.jsxs("small",{className:"text-muted d-block mt-1",children:["dashboard"===s&&u("settings.userGroups.moduleDescriptions.dashboard"),"proposals"===s&&u("settings.userGroups.moduleDescriptions.proposals"),"customers"===s&&u("settings.userGroups.moduleDescriptions.customers"),"resources"===s&&u("settings.userGroups.moduleDescriptions.resources")]})]},s))})]}),e.jsx(d,{className:"border-0 shadow-sm",children:e.jsx(m,{className:"p-3 p-md-4",children:e.jsxs("div",{className:"d-flex flex-column flex-md-row gap-2 gap-md-3 justify-content-end",children:[e.jsxs(a,{type:"button",color:"light",size:"md",className:"px-3 px-md-4 fw-semibold order-2 order-md-1",onClick:()=>{JSON.stringify(f)!==JSON.stringify(I.current)?N.fire({title:u("common.confirm"),text:u("settings.userGroups.alerts.leaveWarning"),icon:"warning",showCancelButton:!0,confirmButtonText:u("settings.userGroups.alerts.leaveAnyway"),cancelButtonText:u("settings.userGroups.alerts.stayOnPage"),confirmButtonColor:"#d33",cancelButtonColor:"#6c757d"}).then(e=>{e.isConfirmed&&p("/settings/users")}):p("/settings/users")},style:{borderRadius:"25px",border:"1px solid #e3e6f0",transition:"all 0.3s ease"},children:[e.jsx(i,{icon:k,className:"me-2"}),u("common.cancel")]}),e.jsx(a,{type:"submit",color:"primary",size:"md",disabled:$,className:"px-4 px-md-5 fw-semibold order-1 order-md-2",style:{borderRadius:"25px",border:"none",background:F.headerBg||"#667eea",color:H(F.headerBg||"#667eea"),transition:"all 0.3s ease"},children:$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",style:{width:"14px",height:"14px"},children:e.jsx("span",{className:"visually-hidden",children:u("common.loading")})}),u("settings.userGroups.create.creating")]}):e.jsxs(e.Fragment,{children:[e.jsx(i,{icon:G,className:"me-2"}),u("settings.userGroups.create.submit")]})})]})})})]})]})};export{R as default};
