import{j as e}from"./date-vendor-D9pAgX5F.js";import{i as s,u as t,r as n}from"./react-vendor-DF7UJAlN.js";import{d as i}from"./DefaultLayout-BUcG_pV2.js";import{S as o}from"./utils-vendor-Nl-sF5xe.js";import{u as a}from"./index-BmZAsEKv.js";import{f as l,g as r}from"./dateHelpers-BGZ-n686.js";import{u as c,U as d,V as m}from"./index-DW-yAxzW.js";import{u}from"./redux-vendor-BzdbewH4.js";import{h,b as j,c as x,d as g,H as f,U as v,V as p,I as b,J as y,a7 as N,w,e as z}from"./ui-vendor-DjmSPU99.js";import"./form-vendor-CKNVq0c_.js";import"./icons-vendor-D82TZqJV.js";const C={locationName:"",address:"",website:"",email:"",phone:"",country:"",timezone:""},R=()=>{const{t:R}=c(),{id:S}=s(),q=i(S),O=t(),[B,T]=n.useState(C),E=n.useRef(C),[I,k]=n.useState({}),[H,J]=n.useState(""),[A,D]=n.useState(!1),U=u(),V=Object.values(a.getAllCountries()),F=B.country&&a.getCountry(B.country)?.timezones||[];n.useEffect(()=>{(async()=>{if(q)try{const e=await U(d(q)).unwrap();T(e),E.current=e}catch(e){o.fire(R("common.error"),R("settings.locations.edit.loadFailedOne"),"error")}})()},[q,U]),n.useEffect(()=>{if(B.timezone){const e=setInterval(()=>{J(l(r(),B.timezone))},1e3);return()=>clearInterval(e)}},[B.timezone]);const L=e=>{const{name:s,value:t}=e.target;if("country"===s){const e=(a.getCountry(t)?.timezones||[])[0]||"";return T(s=>({...s,country:t,timezone:e})),void J(e?l(r(),e):"")}T(e=>({...e,[s]:t}))};return e.jsx(h,{className:"mt-4 mb-4",children:e.jsxs(j,{children:[e.jsx(x,{className:"bg-body border-bottom",children:e.jsx("h5",{className:"mb-2 mt-2",children:R("settings.locations.edit.title")})}),e.jsx(g,{children:e.jsxs(f,{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return B.locationName.trim()||(e.locationName=R("settings.locations.form.validation.locationNameRequired")),B.address.trim()||(e.address=R("settings.locations.form.validation.addressRequired")),B.website.trim()||(e.website=R("settings.locations.form.validation.websiteRequired")),B.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(B.email)||(e.email=R("settings.locations.form.validation.invalidEmail")):e.email=R("settings.locations.form.validation.emailRequired"),B.phone.trim()||(e.phone=R("settings.locations.form.validation.phoneRequired")),B.country||(e.country=R("settings.locations.form.validation.countryRequired")),B.timezone||(e.timezone=R("settings.locations.form.validation.timezoneRequired")),k(e),0===Object.keys(e).length})()){D(!0);try{const e=await U(m({id:q,data:B})).unwrap();200==e?.status&&(o.fire(R("settings.locations.alerts.updatedTitle"),R("settings.locations.alerts.updatedText"),"success"),O("/settings/locations"))}catch(s){o.fire(R("common.error"),s.message||R("settings.locations.alerts.genericError"),"error")}finally{D(!1)}}},children:[e.jsxs(v,{className:"mb-3",children:[e.jsxs(p,{md:6,children:[e.jsx(b,{children:R("settings.locations.form.labels.locationName")}),e.jsx(y,{name:"locationName",value:B.locationName,onChange:L,invalid:!!I.locationName}),e.jsx(N,{invalid:!0,children:I.locationName})]}),e.jsxs(p,{md:6,children:[e.jsx(b,{children:R("settings.locations.form.labels.address")}),e.jsx(y,{name:"address",value:B.address,onChange:L,invalid:!!I.address}),e.jsx(N,{invalid:!0,children:I.address})]})]}),e.jsxs(v,{className:"mb-3",children:[e.jsxs(p,{md:6,children:[e.jsx(b,{children:R("settings.locations.form.labels.website")}),e.jsx(y,{name:"website",value:B.website,onChange:L,invalid:!!I.website}),e.jsx(N,{invalid:!0,children:I.website})]}),e.jsxs(p,{md:6,children:[e.jsx(b,{children:R("settings.locations.form.labels.email")}),e.jsx(y,{name:"email",value:B.email,onChange:L,invalid:!!I.email}),e.jsx(N,{invalid:!0,children:I.email})]})]}),e.jsxs(v,{className:"mb-3",children:[e.jsxs(p,{md:6,children:[e.jsx(b,{children:R("settings.locations.form.labels.phone")}),e.jsx(y,{name:"phone",value:B.phone,onChange:L,invalid:!!I.phone}),e.jsx(N,{invalid:!0,children:I.phone})]}),e.jsxs(p,{md:6,children:[e.jsx(b,{children:R("settings.locations.form.labels.country")}),e.jsxs(w,{name:"country",value:B.country,onChange:L,invalid:!!I.country,children:[e.jsx("option",{value:"",children:R("settings.locations.form.select.country")}),V.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(N,{invalid:!0,children:I.country})]})]}),e.jsxs(v,{className:"mb-3",children:[e.jsxs(p,{md:6,children:[e.jsx(b,{children:R("settings.locations.form.labels.timezone")}),e.jsxs(w,{name:"timezone",value:B.timezone,onChange:L,invalid:!!I.timezone,children:[e.jsx("option",{value:"",children:R("settings.locations.form.select.timezone")}),F.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx(N,{invalid:!0,children:I.timezone})]}),e.jsxs(p,{md:6,children:[e.jsx(b,{children:R("settings.locations.form.labels.currentTime")}),e.jsx(y,{value:H,readOnly:!0,tabIndex:-1,style:{backgroundColor:"#e9ecef",cursor:"not-allowed"}})]})]}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"d-flex gap-2 mt-4 form-buttons",children:[e.jsx(z,{type:"submit",color:"success",disabled:A,"aria-label":R("settings.locations.edit.update"),style:{minHeight:"44px"},children:R(A?"settings.locations.edit.updating":"settings.locations.edit.update")}),e.jsx(z,{type:"button",color:"secondary","aria-label":R("common.cancel"),onClick:()=>{JSON.stringify(B)!==JSON.stringify(E.current)?o.fire({title:R("common.confirm"),text:R("settings.locations.alerts.leaveWarning"),icon:"warning",showCancelButton:!0,confirmButtonText:R("settings.locations.alerts.leaveAnyway"),cancelButtonText:R("settings.locations.alerts.stayOnPage"),confirmButtonColor:"#d33",cancelButtonColor:"#6c757d"}).then(e=>{e.isConfirmed&&O("/settings/locations")}):O("/settings/locations")},children:R("common.cancel")})]})]})})]})})};export{R as default};
