import{j as e}from"./date-vendor-D9pAgX5F.js";import{u as s,r as a,R as t,i as l}from"./react-vendor-DF7UJAlN.js";import{u as i,a as n}from"./redux-vendor-BzdbewH4.js";import{u as r,b as c,a as o,C as d}from"./index-DW-yAxzW.js";import{h as m,b as p,c as u,e as g,d as h,a as x,H as y,U as j,V as b,I as f,J as v,K as N,a6 as C,a5 as w,W as S,X as k,w as M,$ as I,a0 as T,a1 as F,a4 as P,a3 as z,o as $,p as R,r as A,t as D,v as H,a2 as E,i as B,l as q,m as U,C as L,R as O,B as W,E as _,S as V,T as G}from"./ui-vendor-DjmSPU99.js";import{P as Y}from"./PaginationControls-DFQNokso.js";import{P as Q,d as K}from"./DefaultLayout-BUcG_pV2.js";import{S as J}from"./utils-vendor-Nl-sF5xe.js";import{C as X}from"./react-select-creatable.esm-Ljx4lJgZ.js";import{P as Z,C as ee,i as se,a as ae}from"./icons-vendor-D82TZqJV.js";import{T as te}from"./icons-lucide-DddGqAYX.js";import"./form-vendor-CKNVq0c_.js";import"./cil-chevron-right-DSvcss7_.js";const le=({manufacturer:t,id:l})=>{const{t:S}=r(),k=i(),M=s(),I=n(e=>e.customization).headerBg||"#667eea",T=c(I),[F,P]=a.useState({name:"",email:"",phone:"",address:"",website:"",isPriceMSRP:!0,costMultiplier:"",instructions:"",assembledEtaDays:"",unassembledEtaDays:"",deliveryFee:""}),[z,$]=a.useState([]),[R,A]=a.useState(null),[D,H]=a.useState({text:"",type:""}),[E,B]=a.useState(!1);a.useEffect(()=>{t&&P({name:t.name||"",email:t.email||"",phone:t.phone||"",address:t.address||"",website:t.website||"",isPriceMSRP:t.isPriceMSRP??!0,costMultiplier:t.costMultiplier||"",instructions:t.instructions||"",assembledEtaDays:t.assembledEtaDays||"",unassembledEtaDays:t.unassembledEtaDays||"",deliveryFee:t.deliveryFee||""})},[t]);const q=e=>{const{name:s,value:a,type:t,checked:l}=e.target;P(e=>({...e,[s]:"checkbox"===t?l:a}))},U=e=>P(s=>({...s,isPriceMSRP:e}));return e.jsx(m,{className:"mt-4 mb-4",children:e.jsxs(p,{children:[e.jsxs(u,{className:"d-flex justify-content-between align-items-center bg-body border-bottom",children:[e.jsx("h5",{className:"mb-0",children:S("settings.manufacturers.edit.title")}),e.jsx(g,{color:"light",onClick:()=>M(-1),className:"icon-btn","aria-label":S("settings.manufacturers.edit.back"),children:S("settings.manufacturers.edit.back")})]}),e.jsxs(h,{children:[D.text&&e.jsx(x,{color:D.type,dismissible:!0,onClose:()=>H({text:"",type:""}),children:D.text}),e.jsxs(y,{onSubmit:async e=>{e.preventDefault(),B(!0);try{const e=new FormData;Object.keys(F).forEach(s=>{const a=F[s]||"";e.append(s,a)}),R&&e.append("manufacturerImage",R),z.forEach(s=>e.append("catalogFiles",s));const s=await o.put(`/api/manufacturers/${l}/update`,e,{headers:{"Content-Type":"multipart/form-data"}});window.scrollTo({top:0,behavior:"smooth"}),200===s.data.status?(H({text:S("settings.manufacturers.edit.updated"),type:"success"}),k(d({id:l,includeCatalog:!1})),setTimeout(()=>M("/settings/manufacturers"),2e3)):H({text:s.data.message||S("settings.manufacturers.edit.updateFailed"),type:"danger"})}catch(s){H({text:`Error: ${s.response?.data?.message||S("settings.manufacturers.edit.updateFailed")}`,type:"danger"})}finally{B(!1)}},children:[e.jsx(p,{className:"mb-4",children:e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(b,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(f,{htmlFor:"name",children:[S("settings.manufacturers.fields.manufacturerName")," *"]}),e.jsx(v,{id:"name",name:"name",value:F.name,onChange:q,required:!0})]})}),e.jsx(b,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(f,{htmlFor:"email",children:[S("settings.manufacturers.fields.orderEmail")," *"]}),e.jsx(v,{type:"email",id:"email",name:"email",value:F.email,onChange:q,required:!0})]})})]}),e.jsxs(j,{children:[e.jsx(b,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(f,{htmlFor:"phone",children:[S("settings.manufacturers.fields.phone")," *"]}),e.jsx(v,{type:"tel",id:"phone",name:"phone",value:F.phone,onChange:q,required:!0,inputMode:"tel","aria-describedby":"phoneHelp"}),e.jsx(N,{id:"phoneHelp",className:"text-muted",children:S("settings.manufacturers.help.phoneFormat","Include country/area code if needed")})]})}),e.jsx(b,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(f,{htmlFor:"website",children:[S("settings.manufacturers.fields.website")," *"]}),e.jsx(v,{type:"url",id:"website",name:"website",value:F.website,onChange:q,required:!0,inputMode:"url","aria-describedby":"websiteHelp"}),e.jsx(N,{id:"websiteHelp",className:"text-muted",children:S("settings.manufacturers.help.websiteFormat","https://example.com")})]})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(f,{htmlFor:"address",children:[S("settings.manufacturers.fields.address")," *"]}),e.jsx(v,{id:"address",name:"address",value:F.address,onChange:q,required:!0})]}),e.jsxs(j,{children:[e.jsx(b,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"assembledEtaDays",children:S("settings.manufacturers.fields.assembledEtaDays","Assembled Items ETA")}),e.jsx(v,{type:"text",id:"assembledEtaDays",name:"assembledEtaDays",value:F.assembledEtaDays,onChange:q,placeholder:"e.g., 7-14 days","aria-describedby":"assembledEtaHelp"}),e.jsx(N,{id:"assembledEtaHelp",className:"text-muted",children:S("settings.manufacturers.help.assembledEta","Estimated delivery time for assembled cabinets")})]})}),e.jsx(b,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"unassembledEtaDays",children:S("settings.manufacturers.fields.unassembledEtaDays","Unassembled Items ETA")}),e.jsx(v,{type:"text",id:"unassembledEtaDays",name:"unassembledEtaDays",value:F.unassembledEtaDays,onChange:q,placeholder:"e.g., 3-7 days","aria-describedby":"unassembledEtaHelp"}),e.jsx(N,{id:"unassembledEtaHelp",className:"text-muted",children:S("settings.manufacturers.help.unassembledEta","Estimated delivery time for unassembled cabinets")})]})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"manufacturerImage",children:S("settings.manufacturers.edit.updateImage")}),t?.image&&!R&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-muted",children:[S("settings.manufacturers.edit.currentImage"),":"]}),e.jsx("img",{src:`https://app.nj.contractors/uploads/images/${t.image}`,alt:t.name,style:{maxWidth:"200px",maxHeight:"150px",objectFit:"contain"},className:"border rounded"})]}),e.jsx(v,{type:"file",id:"manufacturerImage",accept:"image/*",onChange:e=>A(e.target.files[0]),"aria-describedby":"manufacturerImageHelp"}),e.jsx(N,{id:"manufacturerImageHelp",className:"text-muted",children:S("settings.manufacturers.edit.imageHelp","PNG or JPG recommended. Max ~5MB.")}),R&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-success",children:S("settings.manufacturers.edit.newImageSelected",{name:R.name})}),e.jsx("img",{src:URL.createObjectURL(R),alt:"Preview",style:{maxWidth:"200px",maxHeight:"150px",objectFit:"contain"},className:"border rounded mt-2"})]})]})]})}),e.jsx(p,{className:"mb-4",children:e.jsxs(h,{children:[e.jsxs("fieldset",{className:"mb-3",children:[e.jsx(f,{as:"legend",children:S("settings.manufacturers.edit.priceInfo")}),e.jsx("span",{className:"visually-hidden",id:"priceTypeDesc",children:S("settings.manufacturers.help.priceInfo","Choose how prices are handled")}),e.jsx(C,{type:"radio",name:"priceType",id:"msrpPrices",label:S("settings.manufacturers.fields.msrpOption"),checked:F.isPriceMSRP,onChange:()=>U(!0),className:"mb-2","aria-describedby":"priceTypeDesc"}),e.jsx(C,{type:"radio",name:"priceType",id:"costPrices",label:S("settings.manufacturers.fields.costOption"),checked:!F.isPriceMSRP,onChange:()=>U(!1),"aria-describedby":"priceTypeDesc"})]}),e.jsxs(j,{children:[e.jsx(b,{md:4,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(f,{htmlFor:"costMultiplier",children:[S("settings.manufacturers.edit.costMultiplier")," *"]}),e.jsx(v,{type:"number",step:"0.1",id:"costMultiplier",name:"costMultiplier",value:F.costMultiplier,onChange:q,required:!0,inputMode:"decimal"}),(()=>{if(!F.costMultiplier)return null;const s=parseFloat(F.costMultiplier);return e.jsx(N,{className:"text-muted",children:S("settings.manufacturers.example.multiplier",{msrp:200..toFixed(2),cost:100..toFixed(2),multiplier:s.toFixed(1)})})})()]})}),e.jsx(b,{md:4,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"deliveryFee",children:S("settings.manufacturers.edit.deliveryFee")}),e.jsx(v,{type:"number",step:"0.01",min:"0",id:"deliveryFee",name:"deliveryFee",value:F.deliveryFee,onChange:q,inputMode:"decimal","aria-describedby":"deliveryFeeHelp"}),e.jsx(N,{id:"deliveryFeeHelp",className:"text-muted",children:S("settings.manufacturers.edit.deliveryFeeHelp")})]})})]})]})}),e.jsx(p,{className:"mb-4",children:e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"instructions",children:S("settings.manufacturers.fields.instructions")}),e.jsx(w,{id:"instructions",rows:4,name:"instructions",value:F.instructions,onChange:q})]})})}),e.jsx(p,{className:"mb-4",children:e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"catalogFiles",children:S("settings.manufacturers.edit.uploadNewCatalog")}),e.jsx(v,{type:"file",id:"catalogFiles",multiple:!0,onChange:e=>$([...e.target.files]),"aria-describedby":"catalogFilesHelp"}),e.jsx(N,{id:"catalogFilesHelp",className:"text-muted",children:S("settings.manufacturers.edit.supported")})]})})}),e.jsx("div",{className:"text-end",children:e.jsx(g,{type:"submit",disabled:E,style:{background:I,color:T,border:"none"},children:S(E?"settings.manufacturers.edit.saving":"settings.manufacturers.edit.saveChanges")})})]})]})]})})},ie=({manufacturer:s})=>{const{t:t}=r(),[l,i]=a.useState([]),[n,c]=a.useState([]),[d,m]=a.useState(!1),[u,g]=a.useState(""),[x,y]=a.useState(1),[j,b]=a.useState(5),[N,w]=a.useState(""),[H,E]=a.useState([]),[B,q]=a.useState(""),[U,L]=a.useState(""),[O,W]=a.useState(1),[_,V]=a.useState(5),[G,Q]=a.useState(""),[K,J]=a.useState([]),[X,Z]=a.useState(""),ee=a.useMemo(()=>["code",...Array.isArray(l)?l.slice(0,5).map(e=>e?.style).filter(e=>"string"==typeof e&&""!==e.trim()):[]],[l]);a.useEffect(()=>{if(ee.length>0){const e=ee.slice(0,5);E(e),J(e)}},[ee,n]),a.useEffect(()=>{(async()=>{if(s?.id){m(!0);try{const e=await o.get(`/api/manufacturers/${s.id}/catalog`,{params:{page:1,limit:1e3,sortBy:"code",sortOrder:"ASC"}});e.data&&Array.isArray(e.data.catalogData)?c(e.data.catalogData):c([])}catch(e){c([])}finally{m(!1)}}else c([])})()},[s?.id]),a.useEffect(()=>{(async()=>{if(s?.id)try{const e=await o.get(`/api/manufacturers/${s.id}/styles`,{});i(e.data)}catch(e){}})()},[s?.id]),a.useEffect(()=>{s?.costMultiplier&&(w(s.costMultiplier),Q(s.costMultiplier))},[s]);const se=(e,s,a)=>{"string"==typeof e&&""!==e.trim()&&s(s=>{let a;if(s.includes(e))a=s.filter(s=>s!==e);else if(s.length>=6){const t=["code","description"],l=s.filter(e=>!t.includes(e));a=l.length>0?[...t,...l.slice(0,-1),e]:s}else a=[...s,e];return["code",...a.filter(e=>"code"!==e&&"description"!==e)]})},ae=e=>{const s=(n?.filter(s=>"string"==typeof s.code&&s.code.toLowerCase().includes(e.toLowerCase()))||[]).reduce((e,s)=>(e[s.code]||(e[s.code]=s),e),{});return Object.values(s)},te=ae(u),le=Math.ceil(te.length/j),ie=te.slice((x-1)*j,x*j),ne=ae(U),re=Math.ceil(ne.length/_),ce=ne.slice((O-1)*_,O*_);a.useEffect(()=>{y(1)},[u,j,H]),a.useEffect(()=>{W(1)},[U,_,K]);const oe=(s,a,l)=>e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs($,{className:"ms-2",children:[e.jsxs(R,{color:"secondary",variant:"outline",size:"sm","aria-label":t("common.displayedColumns","Displayed Columns"),children:[s.length>0?s.slice(0,3).map(e=>"string"==typeof e&&e?e.toUpperCase():t("common.na","N/A")).join(", "):t("common.displayedColumns","Displayed Columns"),s.length>3&&"..."]}),e.jsxs(A,{style:{maxHeight:"300px",overflowY:"auto"},children:[e.jsx(D,{component:"div",className:"small text-muted px-3 py-1",children:"CODE is always shown. Select styles to see multiplied prices. Max 6 columns total."}),e.jsx("hr",{className:"dropdown-divider"}),ee.map(i=>{const n=["code"].includes(i);return e.jsx(D,{component:"div",className:"form-check",children:e.jsx(C,{type:"checkbox",id:`checkbox-${l}-${i}`,checked:s.includes(i),onChange:()=>a(i),disabled:n,label:e.jsxs("span",{className:n?"text-muted":"",children:["string"==typeof i&&i?i.toUpperCase():t("common.na","N/A")," ",n?"(always shown)":""]})})},i)})]})]})}),de=(s,a,l)=>e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 small text-muted",children:["Showing ",Math.min(s.length,5)," sample items with code and multiplied prices for selected styles"]}),e.jsxs(I,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(T,{children:e.jsx(F,{children:a.map((s,a)=>e.jsx(P,{style:{backgroundColor:"#e9ecef",fontWeight:"bold"},children:"code"===s?"CODE":"string"==typeof s&&s?`${s.toUpperCase()} PRICE`:t("common.na","N/A")},`header-${a}`))})}),e.jsx(z,{children:d?e.jsx(F,{children:e.jsx(P,{colSpan:a.length,className:"text-center",children:t("common.loading","Loading...")})}):s.length>0?s.map(t=>e.jsx(F,{children:a.map((a,i)=>e.jsx(P,{children:"code"===a?t[a]:(()=>{const e=s.find(e=>e.code===t.code&&e.style?.toLowerCase()===a.toLowerCase());return e?.price?`$${l(e.price)}`:"--"})()},`${t.id}-${i}`))},t.id)):e.jsx(F,{children:e.jsx(P,{colSpan:a.length,className:"text-center",children:t("common.noData","No data found.")})})})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(p,{children:e.jsxs(h,{children:[e.jsx("p",{children:e.jsx("strong",{children:t("settings.manufacturers.settings.costMultiplierTitle","Your cost multiplier")})}),e.jsx("div",{id:"costMultiplierHelp",className:"border rounded p-2 mb-3 small",style:{borderColor:"#0d6efd",backgroundColor:"#f0f8ff"},children:t("settings.manufacturers.settings.costMultiplierHelp","Cost multiplier controls the price you pay to manufacturer. You can see your cost in Quote when you turn off Customer multiplier.")}),e.jsx(v,{type:"number",inputMode:"decimal",min:"0",step:"0.001",value:N,onChange:e=>{const s=e.target.value;w(s),q(""===s.trim()?t("settings.users.form.validation.required"):"")},placeholder:t("settings.manufacturers.placeholders.costMultiplier","1.000"),style:{width:"100px"},className:"mb-2","aria-describedby":"costMultiplierHelp","aria-label":t("settings.manufacturers.settings.costMultiplierTitle","Your cost multiplier")}),B&&e.jsx("div",{className:"text-danger mt-1 mb-2",children:B}),e.jsxs(S,{className:"mb-3",children:[e.jsx(v,{value:u,onChange:e=>g(e.target.value),placeholder:t("common.search")+"...","aria-label":t("common.search","Search")}),e.jsx(k,{children:e.jsx("i",{className:"bi bi-search"})}),oe(H,e=>se(e,E),"1")]}),de(ie,H,e=>(parseFloat(e)*parseFloat(N||1)).toFixed(2)),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx("div",{children:t("common.pageOf",{page:x,total:le,defaultValue:"Page {{page}} of {{total}}"})}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"itemsPerPage1",className:"me-2 mb-0",children:t("common.itemsPerPage","Items per page:")}),e.jsxs(M,{size:"sm",className:"d-inline w-auto ms-2",value:j,onChange:e=>b(Number(e.target.value)),id:"itemsPerPage1","aria-label":t("common.itemsPerPage","Items per page:"),children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"})]})]}),e.jsx(Y,{page:x,totalPages:le,goPrev:()=>y(e=>Math.max(1,e-1)),goNext:()=>y(e=>Math.min(le,e+1))})]})]})}),e.jsx(p,{className:"mt-4",children:e.jsxs(h,{children:[e.jsx("p",{children:e.jsx("strong",{children:t("settings.manufacturers.settings.customerMultiplierTitle","Customer price multiplier")})}),e.jsx("div",{id:"customerMultiplierHelp",className:"border rounded p-2 mb-3 small",style:{borderColor:"#198754",backgroundColor:"#e9fbe5"},children:t("settings.manufacturers.settings.customerMultiplierHelp","Customer price multiplier controls the price at which you sell to your customers. This is what determines your profit.")}),e.jsx(v,{type:"number",inputMode:"decimal",min:"0",step:"0.001",value:G,onChange:e=>{const s=e.target.value;Q(s),Z(""===s.trim()?t("settings.users.form.validation.required"):"")},placeholder:t("settings.manufacturers.placeholders.costMultiplier","1.000"),style:{width:"100px"},className:"mb-2","aria-describedby":"customerMultiplierHelp","aria-label":t("settings.manufacturers.settings.customerMultiplierTitle","Customer price multiplier")}),X&&e.jsx("div",{className:"text-danger mt-1 mb-2",children:X}),e.jsxs(S,{className:"mb-3",children:[e.jsx(v,{value:U,onChange:e=>L(e.target.value),placeholder:t("common.search")+"...","aria-label":t("common.search","Search")}),e.jsx(k,{children:e.jsx("i",{className:"bi bi-search"})}),oe(K,e=>se(e,J),"2")]}),de(ce,K,e=>(parseFloat(e)*parseFloat(N||1)*parseFloat(G||1)).toFixed(2)),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx("div",{children:t("common.pageOf",{page:O,total:re,defaultValue:"Page {{page}} of {{total}}"})}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"itemsPerPage2",className:"me-2 mb-0",children:t("common.itemsPerPage","Items per page:")}),e.jsxs(M,{size:"sm",className:"d-inline w-auto ms-2",value:_,onChange:e=>V(Number(e.target.value)),id:"itemsPerPage2","aria-label":t("common.itemsPerPage","Items per page:"),children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"})]})]}),e.jsx(Y,{page:O,totalPages:re,goPrev:()=>W(e=>Math.max(1,e-1)),goNext:()=>W(e=>Math.min(re,e+1))})]})]})})]})},ne=({manufacturer:s,id:l})=>{const{t:c}=r(),d="https://app.nj.contractors",m=n(e=>e.customization),x=m?.headerBg||"#321fdb",j=m?.headerTextColor||"#ffffff",[b,N]=a.useState([]),[S,k]=a.useState({total:0,page:1,limit:50,totalPages:0}),[$,R]=a.useState({uniqueTypes:[],uniqueStyles:[]}),[A,D]=a.useState(!1),[L,O]=a.useState(null),[W,_]=a.useState("code"),[V,G]=a.useState("ASC"),[Y,K]=a.useState(""),[ae,te]=a.useState(""),[le,ie]=a.useState(""),ne=$.uniqueTypes||[];ne.map(e=>({value:e,label:e}));const[re,ce]=a.useState(!1),[oe,de]=a.useState(!1),[me,pe]=a.useState(1),[ue,ge]=a.useState((()=>{const e=localStorage.getItem("catalogItemsPerPage");return e?parseInt(e,10):50})()),[he,xe]=a.useState(!1),[ye,je]=a.useState(!1),be=b;S.totalPages||Math.ceil(be.length/ue);const fe=be,[ve,Ne]=a.useState(!1),[Ce,we]=a.useState(!1),[Se,ke]=a.useState(!1),[Me,Ie]=a.useState(!1),[Te,Fe]=a.useState(!1),[Pe,ze]=a.useState({id:"",name:"",orderIndex:0,image:""}),[$e,Re]=a.useState(!1),[Ae,De]=a.useState(null),[He,Ee]=a.useState(!1),[Be,qe]=a.useState(null),[Ue,Le]=a.useState(!1),[Oe,We]=a.useState({id:"",categoryId:"",name:"",defaultPrice:"",sampleImage:"",isReady:!1,fieldsConfig:null}),[_e,Ve]=a.useState({sliders:{height:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Height"},width:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Width"},depth:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Depth"}},sideSelector:{enabled:!1,options:["L","R"],label:"Side"},qtyRange:{enabled:!1,min:1,max:10,label:"Quantity"},notes:{enabled:!1,placeholder:"",showInRed:!0,label:"Customer Notes"},customerUpload:{enabled:!1,required:!1,title:"",label:"File Upload"},descriptions:{internal:"",customer:"",installer:"",both:!1},modSampleImage:{enabled:!1,label:"Sample Image"}}),[Ge,Ye]=a.useState("cards"),[Qe,Ke]=a.useState(null),[Je,Xe]=a.useState(1),[Ze,es]=a.useState(null),[ss,as]=a.useState(!1),[ts,ls]=a.useState(!1),[is,ns]=a.useState([]),[rs,cs]=a.useState([]),[os,ds]=a.useState(!1),[ms,ps]=a.useState({templateId:"",scope:"all",targetStyle:"",targetType:"",overridePrice:""}),[us,gs]=a.useState(!1),[hs,xs]=a.useState([]),[ys,js]=a.useState({type:"",price:"",applyTo:"one",selectedTypes:[]}),[bs,fs]=a.useState([]),[vs,Ns]=a.useState({}),[Cs,ws]=a.useState({leftHingePrice:"",rightHingePrice:"",bothHingePrice:"",exposedSidePrice:""}),[Ss,ks]=a.useState({modificationName:"",price:"",notes:"",description:""}),[Ms,Is]=a.useState({categoryId:"",name:"",defaultPrice:"",isReady:!1,sampleImage:"",saveAsBlueprint:!1}),[Ts,Fs]=a.useState({name:"",orderIndex:0}),[Ps,zs]=a.useState({sliders:{height:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Height"},width:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Width"},depth:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Depth"}},sideSelector:{enabled:!1,options:["L","R"],label:"Side"},qtyRange:{enabled:!1,min:1,max:10,label:"Quantity"},notes:{enabled:!1,placeholder:"",showInRed:!0,label:"Customer Notes"},customerUpload:{enabled:!1,required:!1,title:"",label:"File Upload"},descriptions:{internal:"",customer:"",installer:"",both:!1},modSampleImage:{enabled:!1,label:"Sample Image"}}),[$s,Rs]=a.useState({}),[As,Ds]=a.useState(!1),[Hs,Es]=a.useState([]),[Bs,qs]=a.useState([]),[Us,Ls]=a.useState(!1),[Os,Ws]=a.useState(!1),[_s,Vs]=a.useState({name:"",description:"",requires_hinge_side:!1,requires_exposed_side:!1}),[Gs,Ys]=a.useState([]),[Qs,Ks]=a.useState([]),[Js,Xs]=a.useState(null),[Zs,ea]=a.useState(null),[sa,aa]=a.useState({}),[ta,la]=a.useState(null),ia=[...$.uniqueStyles||[]],na=ia.map(e=>({value:e,label:e})),ra={style:"",type:"",code:"",description:"",price:""},[ca,oa]=a.useState(ra),da=async(e=me,s=ue,a=Y,t=ae,i=W,n=V)=>{if(l){D(!0),O(null);try{const r={page:String(e),limit:String(s),sortBy:i,sortOrder:n,...a?{typeFilter:a}:{},...t?{styleFilter:t}:{}},{data:c}=await o.get(`/api/manufacturers/${l}/catalog`,{params:r});N(Array.isArray(c.catalogData)?c.catalogData:[]),k(c.pagination||{total:0,page:e,limit:s,totalPages:0}),1===e&&c.filters&&R(c.filters),c.sorting&&(_(c.sorting.sortBy),G(c.sorting.sortOrder)),pe(e),ge(s)}catch(r){O(r.message),N([])}finally{D(!1)}}},ma=async()=>{if(l)try{const{data:e}=await o.get(`/api/manufacturers/${l}/sub-types`);qs(e.data||[])}catch(e){qs([])}};a.useEffect(()=>{Os&&b.length>0&&(Ys((e=>{const s={};return e.forEach(e=>{const a=e.code;s[a]||(s[a]={code:a,description:e.description,type:e.type,styles:[],itemIds:[]}),s[a].styles.push(e.style),s[a].itemIds.push(e.id)}),Object.values(s).sort((e,s)=>e.code.localeCompare(s.code))})(b)),Zs&&pa())},[Os,b,Zs]);const pa=async()=>{if(Zs)try{const{data:e}=await o.get(`/api/sub-types/${Zs}/assignments`),s=e.data||[],a=s.map(e=>e.id);Es(a);const t=[...new Set(s.map(e=>e.code))];Ks(t)}catch(e){}},ua=async()=>{try{const{data:e}=await o.get("/api/global-mods/gallery");ns(e?.gallery||[])}catch(e){ns([])}},[ga,ha]=a.useState([]),xa=async()=>{if(l)try{const{data:e}=await o.get("/api/global-mods/categories",{params:{scope:"manufacturer",manufacturerId:l,includeTemplates:!0}});ha(e?.categories||[])}catch(e){ha([])}},ya=async()=>{if(l){ds(!0);try{const{data:e}=await o.get("/api/global-mods/assignments",{params:{manufacturerId:l}});cs(e?.assignments||[])}catch(e){cs([])}finally{ds(!1)}}},ja=async e=>{if(!e)return null;const s=new FormData;s.append("logoImage",e);const{data:a}=await o.post("/api/global-mods/upload/image",s,{headers:{"Content-Type":"multipart/form-data"}});return a?.filename||null},ba=async()=>{try{const{data:e}=await o.post("/api/global-mods/categories",{name:Ts.name,scope:"manufacturer",manufacturerId:l,orderIndex:parseInt(Ts.orderIndex)||0});return await xa(),e.category}catch(e){throw e}},fa=()=>{Is({categoryId:"",name:"",defaultPrice:"",isReady:!1,sampleImage:""}),Fs({name:"",orderIndex:0}),zs({sliders:{height:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Height"},width:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Width"},depth:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Depth"}},sideSelector:{enabled:!1,options:["L","R"],label:"Side"},qtyRange:{enabled:!1,min:1,max:10,label:"Quantity"},notes:{enabled:!1,placeholder:"",showInRed:!0,label:"Customer Notes"},customerUpload:{enabled:!1,required:!1,title:"",label:"File Upload"},descriptions:{internal:"",customer:"",installer:"",both:!1},modSampleImage:{enabled:!1,label:"Sample Image"}}),Ke(null),Xe(1),Ye("cards"),es(null)},va=async e=>{try{await o.delete(`/api/global-mods/templates/${e}`),await ua(),J.fire({toast:!0,position:"top",icon:"success",title:"Modification deleted successfully",showConfirmButton:!1,timer:1500,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}catch(s){J.fire({toast:!0,position:"top",icon:"error",title:"Failed to delete modification",showConfirmButton:!1,timer:1500,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}};a.useEffect(()=>{ua()},[]),a.useEffect(()=>{ya(),xa(),ma()},[l]);const Na=t.useMemo(()=>{const e=[];return(ga||[]).forEach(s=>(s.templates||[]).forEach(a=>e.push({...a,categoryName:s.name,isGlobal:!1}))),e.filter(e=>us||e.isReady).sort((e,s)=>(e.categoryName||"").localeCompare(s.categoryName)||e.name.localeCompare(s.name))},[ga,us]),Ca=e=>{const s={sliders:{height:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Height"},width:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Width"},depth:{enabled:!1,min:0,max:0,step:1,useCustomIncrements:!1,customIncrements:["1/8","1/4","3/8","1/2","5/8","3/4","7/8"],label:"Depth"}},sideSelector:{enabled:!1,options:["L","R"],label:"Side"},qtyRange:{enabled:!1,min:1,max:10,label:"Quantity"},notes:{enabled:!1,placeholder:"",showInRed:!0,label:"Customer Notes"},customerUpload:{enabled:!1,required:!1,title:"",label:"File Upload"},descriptions:{internal:"",customer:"",installer:"",both:!1},modSampleImage:{enabled:!1,label:"Sample Image"}};return e?(e.sliders&&["height","width","depth"].forEach(a=>{e.sliders[a]&&(s.sliders[a].enabled=!!e.sliders[a].enabled,s.sliders[a].min=Number(e.sliders[a].min??0),s.sliders[a].max=Number(e.sliders[a].max??0),s.sliders[a].step=Number(e.sliders[a].step??1),Array.isArray(e.sliders[a].customIncrements)&&e.sliders[a].customIncrements.length>0?(s.sliders[a].useCustomIncrements=!0,s.sliders[a].customIncrements=e.sliders[a].customIncrements):s.sliders[a].useCustomIncrements=!1)}),e.sideSelector&&(s.sideSelector.enabled=!!e.sideSelector.enabled,s.sideSelector.options=Array.isArray(e.sideSelector.options)&&e.sideSelector.options.length?e.sideSelector.options:["L","R"]),e.qtyRange&&(s.qtyRange.enabled=!!e.qtyRange.enabled,s.qtyRange.min=Number(e.qtyRange.min??1),s.qtyRange.max=Number(e.qtyRange.max??10)),e.notes&&(s.notes.enabled=!!e.notes.enabled,s.notes.placeholder=e.notes.placeholder||"",s.notes.showInRed=!!e.notes.showInRed),e.customerUpload&&(s.customerUpload.enabled=!!e.customerUpload.enabled,s.customerUpload.required=!!e.customerUpload.required,s.customerUpload.title=e.customerUpload.title||""),e.descriptions&&(s.descriptions.internal=e.descriptions.internal||"",s.descriptions.customer=e.descriptions.customer||"",s.descriptions.installer=e.descriptions.installer||"",s.descriptions.both=!!e.descriptions.both),e.modSampleImage&&(s.modSampleImage.enabled=!!e.modSampleImage.enabled),s):s},wa=async e=>{try{await o.delete(`/api/global-mods/assignments/${e}`),await ya()}catch(s){}},Sa=async(e,s)=>{try{if(!1===s)await o.post("/api/global-mods/assignments",{templateId:e,manufacturerId:l,scope:"item",catalogDataId:Hs.id,isActive:!1});else{const s=hs.find(s=>s.template?.id===e&&"item"===s.scope&&!1===s.isActive);s&&await o.delete(`/api/global-mods/assignments/${s.id}`)}const{data:a}=await o.get(`/api/global-mods/item/${Hs.id}`);xs(Array.isArray(a?.assignments)?a.assignments:[])}catch(a){}};a.useEffect(()=>{da(1,ue,Y,ae,W,V)},[Y,ae,l,W,V]),a.useEffect(()=>{l&&da(1,ue,Y,ae,W,V)},[l]),a.useEffect(()=>{localStorage.setItem("catalogItemsPerPage",String(ue))},[ue]);const[ka,Ma]=a.useState(!1),[Ia,Ta]=a.useState({id:null,style:"",type:"",code:"",description:"",price:""}),[Fa,Pa]=a.useState(!1),[za,$a]=a.useState(""),[Ra,Aa]=a.useState(""),[Da,Ha]=a.useState(!1),[Ea,Ba]=a.useState([]),[qa,Ua]=a.useState(!1),[La,Oa]=a.useState(!1),[Wa,_a]=a.useState(!1),[Va,Ga]=a.useState(!1),[Ya,Qa]=a.useState(null),[Ka,Ja]=a.useState(!1),[Xa,Za]=a.useState(!1),[et,st]=a.useState(!1),[at,tt]=a.useState([]),[lt,it]=a.useState(""),[nt,rt]=a.useState(!1),[ct,ot]=a.useState(!1),[dt,mt]=a.useState(!1),[pt,ut]=a.useState(!1),[gt,ht]=a.useState({style:"",type:"",description:"",price:""}),[xt,yt]=a.useState(!1),[jt,bt]=a.useState(!1),[ft,vt]=a.useState({oldStyleName:"",newStyleName:""}),[Nt,Ct]=a.useState(null);i();const wt=e=>{let s="ASC";W===e&&"ASC"===V&&(s="DESC"),_(e),G(s),da(1,ue,Y,ae,e,s),pe(1)},[St,kt]=a.useState({}),Mt=e=>{oa({...ca,[e.target.name]:e.target.value})},It=e=>{Ta({id:e.id,style:e.style||"",type:e.type||"",code:e.code||"",description:e.description||"",price:e.price||""}),Ma(!0)},Tt=e=>{Ua(e),Ba(e?fe.map(e=>e.id):[])},Ft=(e,s)=>{if(s){const s=[...Ea,e];Ba(s);const a=fe.map(e=>e.id).every(e=>s.includes(e));Ua(a)}else Ba(s=>s.filter(s=>s!==e)),Ua(!1)};t.useEffect(()=>{const e=fe.map(e=>e.id),s=e.length>0&&e.every(e=>Ea.includes(e));Ua(s)},[fe,Ea]);const[Pt,zt]=a.useState(!1),[$t,Rt]=a.useState(""),[At,Dt]=a.useState({name:"",shortName:"",description:"",image:"",catalogId:"",manufacturerId:"",code:""}),Ht=async e=>{const{id:s,manufacturerId:a,style:t,code:l}=e;try{const e=(await o.get(`/api/manufacturers/style/${s}`)).data;e?(Rt(e.name||t||""),Dt({name:e.name||"",shortName:e.shortName||"",description:e.description||"",image:e.image||"",catalogId:s,manufacturerId:a,code:l}),la(null)):(Rt(t||""),Dt({name:t||"",shortName:"",description:"",image:"",catalogId:s,manufacturerId:a,code:l}),la(null)),zt(!0)}catch(i){Rt(t||""),Dt({name:t||"",shortName:"",description:"",image:"",catalogId:s,manufacturerId:a,code:l}),la(null),zt(!0)}},Et=e=>{const{name:s,value:a}=e.target;Dt(e=>({...e,[s]:a}))},[Bt,qt]=a.useState(!1),[Ut,Lt]=a.useState(null),Ot=async()=>{if(l)try{const e=await o.get(`/api/manufacturers/${l}/types`);e.data.success&&fs(e.data.data||[])}catch(e){fs([])}},Wt=async()=>{if(l)try{const e=await o.get(`/api/manufacturers/${l}/assembly-costs-by-types`);e.data.success&&Ns(e.data.data||{})}catch(e){Ns({})}},_t=async e=>{Es(e),ks({modificationName:"",description:"",notes:"",price:""}),ke(!0)};return e.jsxs("div",{children:[e.jsx("style",{children:"\n          .form-check-input:not(:checked) {\n            background-color: white !important;\n            border-color: #6c757d !important;\n            border-width: 2px !important;\n            opacity: 1 !important;\n          }\n          .form-check-input:checked {\n            background-color: #198754 !important;\n            border-color: #198754 !important;\n          }\n          .form-check-input:focus {\n            border-color: #198754 !important;\n            box-shadow: 0 0 0 0.25rem rgba(25, 135, 84, 0.25) !important;\n          }\n\n          /* Mobile responsive styles */\n      @media (max-width: 767px) {\n            .table-responsive {\n              border: none;\n            }\n            .table td {\n              padding: 8px 4px !important;\n              font-size: 12px;\n            }\n            .table th {\n              padding: 8px 4px !important;\n              font-size: 11px;\n              font-weight: 600;\n            }\n            .btn-sm {\n        padding: 6px 10px !important;\n        font-size: 12px !important;\n        min-height: 44px;\n            }\n            .mobile-stack {\n              display: flex;\n              flex-direction: column;\n              gap: 4px;\n            }\n          }\n\n          @media (max-width: 576px) {\n            .table td, .table th {\n              padding: 6px 2px !important;\n            }\n            .actions-column {\n              min-width: 120px;\n            }\n          }\n        "}),e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.title"),mobileLayout:"compact",rightContent:e.jsxs("div",{className:"d-flex flex-wrap gap-2 catalog-actions",children:[e.jsxs(g,{style:{backgroundColor:x,color:j,borderColor:x},size:"sm",className:"flex-shrink-0",onClick:()=>ce(!0),"aria-label":c("settings.manufacturers.catalogMapping.buttons.uploadCsv"),children:[e.jsx("span",{className:"d-none d-sm-inline",children:c("settings.manufacturers.catalogMapping.buttons.uploadCsv")}),e.jsx("span",{className:"d-sm-none",children:"ğŸ“ CSV"})]}),e.jsxs(g,{style:{backgroundColor:x,color:j,borderColor:x},size:"sm",className:"flex-shrink-0",onClick:()=>de(!0),"aria-label":c("settings.manufacturers.catalogMapping.buttons.addItem"),children:[e.jsx("span",{className:"d-none d-sm-inline",children:c("settings.manufacturers.catalogMapping.buttons.addItem")}),e.jsx("span",{className:"d-sm-none",children:c("settings.manufacturers.catalogMapping.buttons.addShort","â• Add")})]}),e.jsxs(g,{color:"primary",size:"sm",className:"flex-shrink-0",onClick:()=>Ie(!0),title:c("settings.manufacturers.catalogMapping.actions.modificationManagementTitle"),"aria-label":c("settings.manufacturers.catalogMapping.actions.modificationManagementTitle"),children:[e.jsx("span",{className:"d-none d-sm-inline",children:c("settings.manufacturers.catalogMapping.actions.modification")}),e.jsx("span",{className:"d-sm-none",children:"ğŸ”§"})]}),e.jsxs(g,{color:"success",size:"sm",className:"flex-shrink-0",onClick:()=>{ps({templateId:"",scope:ae?"style":"all",targetStyle:ae||"",targetType:Y||"",overridePrice:""}),as(!0)},title:c("settings.manufacturers.catalogMapping.actions.assignGlobalModsTitle"),"aria-label":c("settings.manufacturers.catalogMapping.actions.assignGlobalModsTitle"),children:[e.jsx("span",{className:"d-none d-sm-inline",children:c("settings.manufacturers.catalogMapping.actions.assignMods")}),e.jsx("span",{className:"d-sm-none",children:"ğŸ§©"})]}),e.jsx(g,{color:"warning",size:"sm",className:"flex-shrink-0",onClick:async()=>{if(!Xa){Za(!0);try{const{data:e}=await o.post(`/api/manufacturers/${l}/cleanup-duplicates`,null);J.fire({toast:!0,position:"top",icon:e.duplicatesRemoved>0?"success":"info",title:e.message,showConfirmButton:!1,timer:3e3,width:"450px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}}),e.duplicatesRemoved>0&&(da(1,ue,Y,ae,W,V),pe(1))}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:"Failed to cleanup duplicates",showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}finally{Za(!1)}}},disabled:Xa,title:c("settings.manufacturers.catalogMapping.cleanupDuplicates.tooltip"),"aria-label":c("settings.manufacturers.catalogMapping.cleanupDuplicates.tooltip"),children:Xa?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status"}),e.jsx("span",{className:"d-none d-sm-inline",children:c("settings.manufacturers.catalogMapping.cleanupDuplicates.cleaning")}),e.jsx("span",{className:"d-sm-none",children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"d-none d-sm-inline",children:c("settings.manufacturers.catalogMapping.cleanupDuplicates.buttonText")}),e.jsx("span",{className:"d-sm-none",children:"ğŸ§¹"})]})}),e.jsxs(g,{style:{backgroundColor:x,color:j,borderColor:x},size:"sm",className:"flex-shrink-0",onClick:async()=>{rt(!0),st(!0);try{const{data:e}=await o.get(`/api/manufacturers/${l}/catalog/backups`);tt(e.backups||[])}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:"Failed to load backup history",showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}finally{rt(!1)}},disabled:0===(S.total||0),title:"Rollback recent catalog upload","aria-label":c("settings.manufacturers.catalogMapping.rollback.buttonText"),children:[e.jsx("span",{className:"d-none d-sm-inline",children:c("settings.manufacturers.catalogMapping.rollback.buttonText")}),e.jsx("span",{className:"d-sm-none",children:"â†¶"})]})]})}),e.jsx("style",{children:"\n        .catalog-actions {\n          width: 100%;\n        }\n\n        /* Mobile card styles */\n        .mobile-catalog-card {\n          border: 1px solid #dee2e6;\n          box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n          transition: box-shadow 0.2s ease;\n        }\n\n        .mobile-catalog-card:hover {\n          box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n        }\n\n        .mobile-cards-container {\n          max-height: 70vh;\n          overflow-y: auto;\n          -webkit-overflow-scrolling: touch;\n        }\n\n        /* Improved touch targets for mobile */\n          .mobile-catalog-card .btn {\n            min-height: 44px;\n            font-size: 12px;\n            white-space: nowrap;\n          }\n\n        .mobile-catalog-card .form-check-input {\n          width: 18px;\n          height: 18px;\n        }\n\n        @media (max-width: 767px) {\n          .catalog-actions {\n            justify-content: stretch;\n          }\n\n          .catalog-actions .btn {\n            flex: 1;\n            min-width: 0;\n            min-height: 44px;\n            font-size: 0.875rem !important;\n            padding: 0.5rem 0.75rem !important;\n          }\n\n          /* Better mobile table */\n          .table-responsive {\n            -webkit-overflow-scrolling: touch;\n          }\n\n          .table td, .table th {\n            min-width: 100px;\n            white-space: nowrap;\n          }\n\n          /* Mobile-optimized filters */\n          .form-select, .form-control {\n            min-height: 44px;\n            font-size: 0.95rem;\n          }\n\n          /* Mobile card specific improvements */\n          .mobile-catalog-card .card-body {\n            padding: 0.75rem !important;\n          }\n\n          .mobile-catalog-card .btn {\n            padding: 6px 10px;\n            font-size: 11px;\n          }\n\n          .mobile-catalog-card .row.g-2 > .col-6 {\n            margin-bottom: 0.5rem;\n          }\n\n          /* Compact header for mobile */\n          .page-header-dynamic {\n            margin-bottom: 0.75rem !important;\n          }\n        }\n\n        @media (max-width: 575px) {\n          .catalog-actions {\n            flex-direction: row; /* Keep inline on small screens */\n            gap: 0.25rem;\n          }\n\n          .catalog-actions .btn {\n            flex: 1;\n            min-width: 0;\n            font-size: 0.8rem !important;\n            padding: 0.4rem 0.5rem !important;\n            min-height: 44px;\n          }\n\n          /* Stack filters vertically on very small screens */\n          .row.g-2 > .col-12 {\n            margin-bottom: 0.5rem; /* Reduced spacing */\n          }\n\n          .row.g-2 > .col-12:last-child {\n            margin-bottom: 0;\n          }\n\n          /* Mobile card actions more compact */\n          .mobile-catalog-card .d-flex.flex-wrap .btn {\n            padding: 4px 8px;\n            font-size: 10px;\n            margin-bottom: 0.15rem;\n          }\n\n          .mobile-catalog-card .card-body {\n            padding: 0.5rem !important;\n          }\n\n          .mobile-catalog-card .card-title {\n            font-size: 0.9rem;\n            margin-bottom: 0.25rem;\n          }\n\n          .mobile-catalog-card small {\n            font-size: 0.75rem;\n          }\n        }\n\n        /* Better touch scrolling for table */\n        .table-container {\n          -webkit-overflow-scrolling: touch;\n          overflow-x: auto;\n        }\n\n        /* Better mobile pagination */\n        @media (max-width: 767px) {\n          .pagination {\n            flex-wrap: wrap;\n            justify-content: center;\n          }\n\n          .page-item .page-link {\n            min-width: 44px;\n            min-height: 44px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 0.875rem;\n          }\n        }\n\n        /* Hide unnecessary elements on mobile */\n        @media (max-width: 576px) {\n          .mobile-catalog-card .card-title {\n            font-size: 14px;\n          }\n\n          .mobile-catalog-card small {\n            font-size: 11px;\n          }\n        }\n  "}),e.jsxs(p,{className:"mb-3",children:[e.jsxs(u,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h6",{className:"mb-0",children:c("settings.manufacturers.catalogMapping.subTypes.header")}),e.jsxs(g,{color:"primary",size:"sm",onClick:()=>{Vs({name:"",description:"",requires_hinge_side:!1,requires_exposed_side:!1}),Xs(null),Ls(!0)},children:[e.jsx(Z,{size:16,"aria-hidden":"true",className:"me-1"})," ",c("settings.manufacturers.catalogMapping.subTypes.create")]})]}),e.jsx(h,{children:0===Bs.length?e.jsx("p",{className:"text-muted mb-0",children:c("settings.manufacturers.catalogMapping.subTypes.empty")}):e.jsx("div",{className:"row g-3",children:Bs.map(s=>e.jsx("div",{className:"col-md-6 col-lg-4",children:e.jsx(p,{className:"h-100",children:e.jsxs(h,{children:[e.jsx("h6",{className:"card-title",children:s.name}),s.description&&e.jsx("p",{className:"card-text small text-muted",children:s.description}),e.jsxs("div",{className:"mb-2",children:[s.requires_hinge_side&&e.jsx(H,{color:"info",className:"me-1",children:c("settings.manufacturers.catalogMapping.subTypes.requiresHinge")}),s.requires_exposed_side&&e.jsx(H,{color:"warning",className:"me-1",children:c("settings.manufacturers.catalogMapping.subTypes.requiresExposed")})]}),e.jsxs("div",{className:"d-flex gap-1 flex-wrap",children:[e.jsx(g,{color:"primary",size:"sm",onClick:()=>{Vs({name:s.name,description:s.description||"",requires_hinge_side:s.requires_hinge_side,requires_exposed_side:s.requires_exposed_side}),Xs(s),Ls(!0)},"aria-label":c("common.edit"),children:c("common.edit")}),e.jsx(g,{color:"success",size:"sm",onClick:()=>{ea(s.id),Ws(!0)},"aria-label":c("settings.manufacturers.catalogMapping.subTypes.assignItems"),children:c("settings.manufacturers.catalogMapping.subTypes.assignItems")}),e.jsx(g,{color:"danger",size:"sm",onClick:()=>(async e=>{if((await J.fire({title:c("settings.manufacturers.catalogMapping.subTypes.deleteTitle"),text:c("settings.manufacturers.catalogMapping.subTypes.deleteConfirm",{name:e.name}),icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:c("common.delete"),cancelButtonText:c("common.cancel")})).isConfirmed)try{await o.delete(`/api/sub-types/${e.id}`),J.fire(c("common.deleted"),c("settings.manufacturers.catalogMapping.subTypes.deleteSuccess"),"success"),await ma()}catch(s){J.fire(c("common.error"),c("settings.manufacturers.catalogMapping.subTypes.deleteFailed"),"error")}})(s),"aria-label":c("common.delete"),children:c("common.delete")})]})]})})},s.id))})})]}),e.jsxs("div",{className:"row g-2 mb-3",children:[e.jsx("div",{className:"col-12 col-sm-6 col-lg-auto",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("select",{className:"form-select form-select-sm",style:{width:"auto",minWidth:"60px"},value:ue,"aria-label":c("settings.manufacturers.catalogMapping.pagination.itemsPerPage","Items per page"),onChange:e=>{const s=parseInt(e.target.value,10);ge(s),localStorage.setItem("catalogItemsPerPage",s),pe(1),da(1,s,Y,ae,W,V)},children:[10,25,50,100,200].map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("span",{className:"text-muted small d-none d-sm-inline",children:c("settings.manufacturers.catalogMapping.pagination.perPage")}),e.jsx("span",{className:"text-muted small d-sm-none",children:"per page"})]})}),e.jsx("div",{className:"col-12 col-sm-12 col-lg-4 order-first order-lg-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{"aria-label":c("settings.manufacturers.catalogMapping.search","Search styles"),type:"text",className:"form-control form-control-sm",placeholder:"ğŸ” Search styles...",value:le,onChange:e=>ie(e.target.value),style:{paddingRight:le?"35px":"12px"}}),le&&e.jsx("button",{type:"button","aria-label":c("common.clearSearch","Clear search"),className:"btn btn-sm btn-link position-absolute top-0 end-0 p-1",onClick:()=>ie(""),style:{color:"#6c757d",textDecoration:"none",zIndex:5},children:"Ã—"})]})}),e.jsx("div",{className:"col-6 col-sm-6 col-lg-auto",children:e.jsxs("select",{className:"form-select form-select-sm","aria-label":c("settings.manufacturers.catalogMapping.filters.type","Filter by type"),value:Y,onChange:e=>{pe(1),K(e.target.value)},children:[e.jsx("option",{value:"",children:"All Types"}),ne.map((s,a)=>e.jsx("option",{value:s,children:s},a))]})}),e.jsx("div",{className:"col-6 col-sm-6 col-lg-auto",children:e.jsxs("select",{className:"form-select form-select-sm","aria-label":c("settings.manufacturers.catalogMapping.filters.style","Filter by style"),value:ae,onChange:e=>{pe(1),te(e.target.value)},children:[e.jsx("option",{value:"",children:"All Styles"}),ia.map((s,a)=>e.jsx("option",{value:s,children:s},a))]})})]}),e.jsxs(e.Fragment,{children:[!1,ae&&e.jsx("div",{className:"mb-3 p-3 border rounded bg-light",children:e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center gap-2",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:['Managing Style: "',ae,'"']}),e.jsx("br",{}),e.jsxs("small",{className:"text-muted",children:[b.filter(e=>e.style===ae).length," items with this style"]})]}),e.jsxs("div",{className:"d-flex gap-2 flex-shrink-0",children:[e.jsx(g,{color:"info",size:"sm",onClick:()=>(vt({oldStyleName:ae,newStyleName:""}),void yt(!0)),disabled:jt,children:jt?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Saving..."]}):e.jsx(e.Fragment,{children:"âœï¸ Rename Style"})}),e.jsx(g,{color:"warning",size:"sm",onClick:()=>($a(ae),Aa(""),void Pa(!0)),disabled:Da,children:Da?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Processing..."]}):e.jsx(e.Fragment,{children:"ğŸ—‘ï¸ Delete/Merge Style"})})]})]})}),Ea.length>0&&e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center mb-3 p-3 bg-light rounded gap-2",children:[e.jsx("span",{className:"fw-bold",children:c("settings.manufacturers.catalogMapping.pagination.itemsSelected",{count:Ea.length})}),e.jsxs("div",{className:"d-flex gap-2 flex-shrink-0",children:[e.jsx(g,{color:"primary",size:"sm",onClick:()=>{0!==Ea.length&&(ht({style:"",type:"",description:"",price:""}),mt(!0))},disabled:pt,children:pt?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Editing..."]}):e.jsx(e.Fragment,{children:"âœï¸ Edit Selected"})}),e.jsx(g,{color:"danger",size:"sm",onClick:()=>{0!==Ea.length&&Oa(!0)},disabled:Wa,children:Wa?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),c("settings.manufacturers.catalogMapping.bulk.deleting")]}):e.jsx(e.Fragment,{children:c("settings.manufacturers.catalogMapping.buttons.deleteSelected")})})]})]})]}),0===b.length?e.jsx("p",{children:c("settings.manufacturers.catalogMapping.empty")}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"table-responsive table-container d-none d-md-block",children:e.jsxs(I,{hover:!0,responsive:!0,className:"mb-0",children:[e.jsx(T,{children:e.jsxs(F,{children:[e.jsx(E,{style:{width:"35px",minWidth:"35px"},children:e.jsx("input",{type:"checkbox",checked:qa,onChange:e=>Tt(e.target.checked),className:"form-check-input",style:{borderColor:"#6c757d",borderWidth:"2px",transform:"scale(1.1)"}})}),e.jsxs(E,{style:{minWidth:"80px",cursor:"pointer",userSelect:"none"},onClick:()=>wt("code"),className:"d-flex align-items-center",role:"button",tabIndex:0,"aria-sort":"code"===W?"ASC"===V?"ascending":"descending":"none","aria-label":`${c("settings.manufacturers.catalogMapping.table.code")} ${"code"===W?"ASC"===V?c("common.sortAscending","ascending"):c("common.sortDescending","descending"):c("common.sortable","sortable")}`,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),wt("code"))},children:[c("settings.manufacturers.catalogMapping.table.code"),"code"===W&&("ASC"===V?e.jsx(ee,{size:16,"aria-hidden":"true",className:"ms-1"}):e.jsx(se,{size:16,"aria-hidden":"true",className:"ms-1"}))]}),e.jsx(E,{style:{minWidth:"120px",maxWidth:"180px"},children:c("settings.manufacturers.catalogMapping.table.description")}),e.jsx(E,{style:{minWidth:"80px"},children:c("settings.manufacturers.catalogMapping.table.style")}),e.jsx(E,{style:{minWidth:"70px"},children:c("settings.manufacturers.catalogMapping.table.price")}),e.jsx(E,{style:{minWidth:"70px"},children:c("settings.manufacturers.catalogMapping.table.type")}),e.jsx(E,{style:{minWidth:"120px"},className:"actions-column",children:c("settings.manufacturers.catalogMapping.table.actions")})]})}),e.jsx(z,{children:fe.map((s,a)=>e.jsxs(F,{children:[e.jsx(P,{children:e.jsx("input",{type:"checkbox",checked:Ea.includes(s.id),onChange:e=>Ft(s.id,e.target.checked),className:"form-check-input","aria-label":`${c("common.select","Select")} ${s.code||""}`,style:{borderColor:"#6c757d",borderWidth:"2px",transform:"scale(1.1)"}})}),e.jsx(P,{children:s.code}),e.jsx(P,{style:{maxWidth:"200px",wordWrap:"break-word",whiteSpace:"normal"},children:s.description?s.description:c("common.na")}),e.jsx(P,{style:{cursor:"pointer"},children:e.jsx(g,{size:"sm",color:"dark",onClick:()=>(async e=>{try{const{id:s}=e,a=await o.get(`/api/manufacturers/style/${s}`);a.data&&(Lt(a.data),qt(!0))}catch(s){Lt(null)}finally{qt(!0)}})(s),className:"me-2",style:{backgroundColor:"#6c757d",borderColor:"#6c757d",color:"white",fontSize:"12px",padding:"4px 8px"},children:s.style})}),e.jsx(P,{children:s.price}),e.jsx(P,{children:s.type?s.type:"N/A"}),e.jsx(P,{children:e.jsxs("div",{className:"d-flex flex-wrap gap-1",children:[e.jsx(g,{size:"sm",color:"secondary",onClick:()=>It(s),style:{fontSize:"11px",padding:"2px 6px",minWidth:"auto"},children:"âœï¸"}),e.jsx(g,{size:"sm",onClick:()=>Ht(s),style:{fontSize:"11px",padding:"2px 6px",backgroundColor:x,borderColor:x,color:j,minWidth:"auto"},title:c("settings.manufacturers.catalogMapping.actions.manageStyle"),children:"ğŸ¨"}),e.jsx(g,{size:"sm",onClick:()=>(async e=>{try{const{id:s}=e,a=await o.get(`/api/manufacturers/assemblycost/${s}`),{type:t,price:l}=a.data||{};Es(e),await Ot(),await Wt(),js({type:t||"",price:l||"",applyTo:"one",selectedItemType:e.type||"",selectedTypes:[]})}catch(s){await Ot(),await Wt(),Es(e),js({type:"",price:"",applyTo:"one",selectedItemType:e.type||"",selectedTypes:[]})}finally{Ne(!0)}})(s),style:{fontSize:"11px",padding:"2px 6px",backgroundColor:x,borderColor:x,color:j,minWidth:"auto"},title:c("settings.manufacturers.catalogMapping.actions.assemblyCost"),children:"ğŸ”§"}),e.jsx(g,{size:"sm",onClick:()=>_t(s),style:{fontSize:"11px",padding:"2px 6px",backgroundColor:x,borderColor:x,color:j,minWidth:"auto"},title:c("settings.manufacturers.catalogMapping.actions.modification"),children:"âš™ï¸"}),e.jsx(g,{size:"sm",onClick:()=>(async e=>{Es(e);try{const{data:s}=await o.get(`/api/global-mods/item/${e.id}`);xs(Array.isArray(s?.assignments)?s.assignments:[])}catch(s){xs([])}ls(!0)})(s),style:{fontSize:"11px",padding:"2px 6px",backgroundColor:"#20c997",borderColor:"#20c997",color:"#fff",minWidth:"auto"},title:"Global Mods for item",children:"ğŸ§©"}),e.jsx(g,{size:"sm",color:"danger",onClick:()=>(e=>{Qa(e),Ga(!0)})(s),style:{fontSize:"11px",padding:"2px 6px",minWidth:"auto"},title:`Delete item: ${s.code}`,children:"ğŸ—‘ï¸"})]})})]},a))})]})}),e.jsxs("div",{className:"d-block d-md-none",children:[e.jsxs("div",{className:"d-flex align-items-center mb-3 p-3 bg-light rounded",children:[e.jsx("input",{type:"checkbox",checked:qa,onChange:e=>Tt(e.target.checked),className:"form-check-input me-2",id:"mobile-select-all"}),e.jsxs("label",{htmlFor:"mobile-select-all",className:"form-check-label mb-0",children:["Select All (",fe.length," items)"]})]}),e.jsx("div",{className:"mobile-cards-container",children:fe.map((s,a)=>e.jsx("div",{className:"card mb-3 mobile-catalog-card",children:e.jsxs("div",{className:"card-body p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("input",{type:"checkbox",checked:Ea.includes(s.id),onChange:e=>Ft(s.id,e.target.checked),className:"form-check-input me-2"}),e.jsxs("div",{children:[e.jsx("h6",{className:"card-title mb-1 fw-bold",children:s.code}),e.jsx("small",{className:"text-muted",children:s.description})]})]}),e.jsx(g,{size:"sm",style:{backgroundColor:"#6c757d",borderColor:"#6c757d",color:"white",fontSize:"11px",padding:"2px 8px"},children:s.style})]}),e.jsxs("div",{className:"row g-2 mb-3",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Price"}),e.jsxs("span",{className:"fw-bold",children:["$",s.price]})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Type"}),e.jsx("span",{children:s.type||"N/A"})]})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsx(g,{size:"sm",color:"secondary",onClick:()=>It(s),className:"flex-fill",children:"âœï¸ Edit"}),e.jsx(g,{size:"sm",onClick:()=>Ht(s),style:{backgroundColor:x,borderColor:x,color:j},className:"flex-fill",title:c("settings.manufacturers.catalogMapping.actions.manageStyle"),children:"ğŸ¨ Style"}),e.jsx(g,{size:"sm",onClick:()=>_t(s),style:{backgroundColor:x,borderColor:x,color:j},className:"flex-fill",title:c("settings.manufacturers.catalogMapping.actions.modificationDetails"),children:"ğŸ”§ Modify"}),e.jsx(g,{size:"sm",color:"danger",onClick:()=>handleDeleteClick(s.id),style:{fontSize:"11px",padding:"4px 8px"},children:"ğŸ—‘ï¸"})]})]})},a))})]})]}),b.length>0?e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx("div",{children:A?"Loadingâ€¦":c("pagination.pageInfo",{current:S.page||1,total:S.totalPages||1})}),e.jsxs("div",{children:[e.jsx(g,{size:"sm",color:"secondary",disabled:A||1===(S.page||1),onClick:()=>da((S.page||1)-1,ue,Y,ae,W,V),className:"me-2",children:c("pagination.prevPageTitle")}),e.jsx(g,{size:"sm",color:"secondary",disabled:A||(S.page||1)>=(S.totalPages||1),onClick:()=>da((S.page||1)+1,ue,Y,ae,W,V),children:c("pagination.nextPageTitle")})]})]}):"",e.jsxs(B,{visible:re,onClose:()=>ce(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.file.modalTitle")}),e.jsx(q,{children:e.jsx(y,{children:e.jsx(v,{type:"file",name:"catalogFiles",label:c("settings.manufacturers.catalogMapping.file.selectLabel"),onChange:e=>{const s=e.target.files[0];if(s){if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(s.type))return void J.fire("Unsupported file type","Please upload a CSV or Excel file.","error");Ct(s)}}})})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>ce(!1),children:c("common.cancel")}),e.jsx(g,{style:{backgroundColor:x,color:j,borderColor:x},onClick:async()=>{if(!Nt)return;const e=Nt.size/1048576,s=e>10;if(e>50)return void J.fire({title:c("common.error"),text:`File too large (${e.toFixed(2)}MB). Maximum size is 50MB. Please split your file into smaller chunks.`,icon:"error"});if(s){if(!(await J.fire({title:"Large File Detected",text:`This file is ${e.toFixed(2)}MB. Large files may take several minutes to process. Continue?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, upload",cancelButtonText:"Cancel"})).isConfirmed)return}const a=new FormData;let t;a.append("catalogFiles",Nt),s&&(t=J.fire({title:"Processing Large File",html:`\n          <div class="mb-3">\n            <div class="progress">\n              <div class="progress-bar progress-bar-striped progress-bar-animated"\n                   role="progressbar" style="width: 0%" id="upload-progress"></div>\n            </div>\n          </div>\n          <p class="text-muted">Processing ${e.toFixed(2)}MB file in chunks...</p>\n          <p class="text-sm">This may take a few minutes. Please don't close this window.</p>\n        `,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{J.showLoading()}}));try{const s=Date.now(),{data:i}=await o.post(`/api/manufacturers/${l}/catalog/upload`,a),n=((Date.now()-s)/1e3).toFixed(1);t&&J.close();let r=c("settings.manufacturers.catalogMapping.file.uploadSuccess");i.stats&&(r+=`\n\nFile: ${e.toFixed(2)}MB`,r+=`\nProcessing: ${i.stats.processingMethod||"regular"}`,r+=`\nTime: ${n}s`,r+=`\n\nItems processed: ${i.stats.totalProcessed}`,r+=`\nCreated: ${i.stats.created} | Updated: ${i.stats.updated}`,i.stats.backupCreated&&(r+="\n\nâœ… Backup created - you can rollback this upload if needed.")),J.fire({title:c("common.success"),text:r,icon:"success",confirmButtonText:"OK"}),ce(!1),Ct(null),da(1,ue,Y,ae,W,V)}catch(i){t&&J.close();let e=i.message||c("settings.manufacturers.catalogMapping.file.uploadFailed");J.fire({title:c("common.error"),text:e,icon:"error",footer:s?"Tip: For very large files (>10,000 rows), consider splitting them into smaller files.":void 0})}},children:c("settings.manufacturers.catalogMapping.file.uploadBtn")})]})]}),e.jsxs(B,{visible:ss,onClose:()=>as(!1),size:"lg",children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.assign.header","Assign Global Modifications")}),e.jsxs(q,{children:[e.jsx("div",{className:"mb-3 d-flex align-items-center gap-2",children:e.jsx(C,{label:"Include drafts",checked:us,onChange:e=>gs(e.target.checked)})}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:"Template"}),e.jsxs(M,{value:ms.templateId,onChange:e=>ps(s=>({...s,templateId:e.target.value})),children:[e.jsx("option",{value:"",children:"Select templateâ€¦"}),Na.map(s=>e.jsxs("option",{value:s.id,children:[s.categoryName?`[${s.categoryName}] `:"",s.name,null!=s.defaultPrice?` â€” $${Number(s.defaultPrice).toFixed(2)}`:" â€” blueprint"]},s.id))]})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx(f,{children:"Scope"}),e.jsxs(M,{value:ms.scope,onChange:e=>ps(s=>({...s,scope:e.target.value})),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"style",children:"Style"}),e.jsx("option",{value:"type",children:"Type"}),e.jsx("option",{value:"item",children:"Selected items"})]})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx(f,{children:"Override price"}),e.jsx(v,{type:"number",value:ms.overridePrice,onChange:e=>ps(s=>({...s,overridePrice:e.target.value})),placeholder:"optional"})]})]}),"style"===ms.scope&&e.jsxs("div",{className:"mt-3",children:[e.jsx(f,{children:"Target style"}),e.jsxs(M,{value:ms.targetStyle,onChange:e=>ps(s=>({...s,targetStyle:e.target.value})),children:[e.jsx("option",{value:"",children:"Select styleâ€¦"}),ia.map((s,a)=>e.jsx("option",{value:s,children:s},a))]})]}),"type"===ms.scope&&e.jsxs("div",{className:"mt-3",children:[e.jsx(f,{children:"Target type"}),e.jsxs(M,{value:ms.targetType,onChange:e=>ps(s=>({...s,targetType:e.target.value})),children:[e.jsx("option",{value:"",children:"Select typeâ€¦"}),ne.map((s,a)=>e.jsx("option",{value:s,children:s},a))]})]}),"item"===ms.scope&&e.jsxs("div",{className:"mt-2 text-muted small",children:[Ea.length," selected item(s) will receive this assignment."]}),e.jsx("hr",{}),e.jsxs("div",{className:"mt-2",children:[e.jsx("h6",{children:"Existing assignments"}),os?e.jsx("div",{children:"Loadingâ€¦"}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Template"}),e.jsx("th",{children:"Scope"}),e.jsx("th",{children:"Target"}),e.jsx("th",{children:"Price"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[rs.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.template?.name}),e.jsx("td",{children:s.scope}),e.jsx("td",{children:"style"===s.scope?s.targetStyle:"type"===s.scope?s.targetType:"item"===s.scope?`Item ${s.catalogDataId}`:"All"}),e.jsx("td",{children:null!=s.overridePrice?`$${Number(s.overridePrice).toFixed(2)}`:null!=s.template?.defaultPrice?`$${Number(s.template.defaultPrice).toFixed(2)}`:"â€”"}),e.jsx("td",{children:e.jsx(g,{color:"danger",size:"sm",onClick:()=>wa(s.id),children:"Remove"})})]},s.id)),0===rs.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-muted",children:"No assignments"})})]})]})})]})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>as(!1),children:c("common.cancel")}),e.jsx(g,{style:{backgroundColor:x,color:j,borderColor:x},onClick:async()=>{if(ms.templateId)try{"item"===ms.scope&&Ea.length>0?await Promise.all(Ea.map(e=>o.post("/api/global-mods/assignments",{templateId:Number(ms.templateId),manufacturerId:l,scope:"item",catalogDataId:e,overridePrice:""===ms.overridePrice?null:Number(ms.overridePrice)}))):await o.post("/api/global-mods/assignments",{templateId:Number(ms.templateId),manufacturerId:l,scope:ms.scope,targetStyle:"style"===ms.scope&&ms.targetStyle||null,targetType:"type"===ms.scope&&ms.targetType||null,catalogDataId:"item"===ms.scope&&Hs?.id||null,overridePrice:""===ms.overridePrice?null:Number(ms.overridePrice)}),await ya(),as(!1),J.fire({toast:!0,position:"top",icon:"success",title:"Assigned",showConfirmButton:!1,timer:1200})}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:e.message||"Assignment failed",showConfirmButton:!1,timer:1500})}},disabled:!ms.templateId,children:"Assign"})]})]}),e.jsxs(B,{visible:ts,onClose:()=>ls(!1),size:"lg",children:[e.jsx(Q,{title:`Global Mods â€” ${Hs?.code||""}`}),e.jsxs(q,{children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Template"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Scope"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Active"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[hs.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.template?.name}),e.jsx("td",{children:s.template?.category?.name||"-"}),e.jsx("td",{children:s.scope}),e.jsx("td",{children:null!=s.overridePrice?`$${Number(s.overridePrice).toFixed(2)}`:null!=s.template?.defaultPrice?`$${Number(s.template.defaultPrice).toFixed(2)}`:"â€”"}),e.jsx("td",{children:!1===s.isActive?"Suppressed":"Active"}),e.jsx("td",{children:"item"===s.scope?e.jsx(g,{color:"danger",size:"sm",onClick:()=>wa(s.id),children:"Remove"}):!1===s.isActive?e.jsx(g,{color:"success",size:"sm",onClick:()=>Sa(s.template?.id,!0),children:"Unsuppress"}):e.jsx(g,{color:"warning",size:"sm",onClick:()=>Sa(s.template?.id,!1),children:"Suppress"})})]},s.id)),0===hs.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-muted",children:"No global templates apply"})})]})]})}),e.jsx("hr",{}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:"Add template to this item"}),e.jsxs(M,{value:ms.templateId,onChange:e=>ps(s=>({...s,templateId:e.target.value})),children:[e.jsx("option",{value:"",children:"Select templateâ€¦"}),Na.map(s=>e.jsxs("option",{value:s.id,children:[s.categoryName?`[${s.categoryName}] `:"",s.name,null!=s.defaultPrice?` â€” $${Number(s.defaultPrice).toFixed(2)}`:" â€” blueprint"]},s.id))]})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx(f,{children:"Override price"}),e.jsx(v,{type:"number",value:ms.overridePrice,onChange:e=>ps(s=>({...s,overridePrice:e.target.value})),placeholder:"optional"})]}),e.jsx("div",{className:"col-md-3 d-flex align-items-end",children:e.jsx(g,{color:"primary",disabled:!ms.templateId,onClick:async()=>{try{await o.post("/api/global-mods/assignments",{templateId:Number(ms.templateId),manufacturerId:l,scope:"item",catalogDataId:Hs.id,overridePrice:""===ms.overridePrice?null:Number(ms.overridePrice)});const{data:e}=await o.get(`/api/global-mods/item/${Hs.id}`);xs(Array.isArray(e?.assignments)?e.assignments:[]),ps(e=>({...e,templateId:"",overridePrice:""}))}catch(e){}},children:"Add"})})]})]}),e.jsx(U,{children:e.jsx(g,{color:"secondary",onClick:()=>ls(!1),children:c("common.close","Close")})})]}),e.jsxs(B,{visible:oe,onClose:()=>de(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.manual.modalTitle")}),e.jsx(q,{children:e.jsxs(y,{children:[e.jsx(X,{isClearable:!0,className:"mb-2",placeholder:c("settings.manufacturers.catalogMapping.stylePlaceholder"),options:na,value:ca.style?{label:ca.style,value:ca.style}:null,onChange:e=>oa({...ca,style:e?e.value:""})}),e.jsx(v,{className:"mb-2",label:c("settings.manufacturers.catalogMapping.fields.code"),name:"code",value:ca.code,onChange:Mt,invalid:!!St.code,feedback:St.code}),e.jsx(v,{className:"mb-2",label:c("settings.manufacturers.catalogMapping.fields.description"),name:"description",value:ca.description,onChange:Mt,invalid:!!St.description,feedback:St.description}),e.jsx(v,{className:"mb-2",type:"number",label:c("settings.manufacturers.catalogMapping.fields.price"),name:"price",value:ca.price,onChange:Mt,invalid:!!St.price,feedback:St.price}),e.jsx(v,{className:"mb-2",label:c("settings.manufacturers.catalogMapping.fields.type"),name:"type",value:ca.type,onChange:Mt,invalid:!!St.type,feedback:St.type})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>de(!1),children:c("common.cancel")}),e.jsx(g,{style:{backgroundColor:x,color:j,borderColor:x},onClick:async()=>{if(!ye&&(()=>{const e={};return Object.entries(ca).forEach(([s,a])=>{a&&a.toString().trim()||(e[s]=`${s.charAt(0).toUpperCase()+s.slice(1)} is required`)}),kt(e),0===Object.keys(e).length})()){je(!0);try{await o.post(`/api/manufacturers/catalog/${s.id}`,ca),J.fire({toast:!0,position:"top",icon:"success",title:"Catalog added successfully",showConfirmButton:!1,timer:1500,width:"360px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}}),oa({style:"",color:"",code:"",type:"",description:"",price:""}),da(1,ue,Y,ae,W,V),kt({}),oa(ra),kt({}),de(!1)}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:"Failed to save catalog",showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}finally{je(!1)}}},children:c("common.save")})]})]}),e.jsxs(B,{visible:ka,onClose:()=>Ma(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.edit.modalTitle")}),e.jsx(q,{children:e.jsxs(y,{children:[e.jsx(X,{isClearable:!0,placeholder:c("settings.manufacturers.catalogMapping.stylePlaceholder"),options:na,value:Ia.style?{label:Ia.style,value:Ia.style}:null,onChange:e=>Ta({...Ia,style:e?e.value:""}),styles:{control:e=>({...e,borderColor:"#d8dbe0",minHeight:"38px",boxShadow:"none","&:hover":{borderColor:"#a6a9b0"}})}}),["code","description","type"].map(s=>e.jsx(v,{className:"mb-2",label:c("code"===s?"settings.manufacturers.catalogMapping.fields.code":"description"===s?"settings.manufacturers.catalogMapping.fields.description":"settings.manufacturers.catalogMapping.fields.type"),name:s,value:Ia[s],onChange:e=>Ta({...Ia,[s]:e.target.value})},s)),e.jsx(v,{className:"mb-2",type:"number",step:"0.01",min:"0",label:c("settings.manufacturers.catalogMapping.fields.price"),name:"price",value:Ia.price,onChange:e=>{const s=e.target.value;Ta({...Ia,price:s})}})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>Ma(!1),children:c("common.cancel")}),e.jsx(g,{style:{backgroundColor:x,color:j,borderColor:x},onClick:async()=>{xe(!0);try{await o.put(`/api/manufacturers/catalog/edit/${Ia.id}`,Ia),J.fire({toast:!0,position:"top",icon:"success",title:"Catalog updated successfully",showConfirmButton:!1,timer:1500,width:"360px"}),Ma(!1),da(me,ue,Y,ae,W,V)}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:"Failed to update catalog",showConfirmButton:!1,timer:1500})}finally{xe(!1)}},disabled:he,children:c(he?"settings.manufacturers.catalogMapping.edit.updating":"settings.manufacturers.catalogMapping.edit.update")})]})]}),e.jsxs(B,{visible:Pt,onClose:()=>zt(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.style.manageTitle",{style:$t})}),e.jsx(q,{children:e.jsxs(y,{children:[e.jsx(v,{label:c("settings.manufacturers.catalogMapping.style.shortName"),name:"shortName",value:At.shortName,onChange:Et,className:"mb-3"}),e.jsx(w,{label:c("settings.manufacturers.catalogMapping.fields.description"),name:"description",value:At.description,onChange:Et,className:"mb-3",rows:4}),e.jsx(v,{type:"file",label:c("settings.manufacturers.catalogMapping.style.uploadImage"),accept:"image/*",id:"styleImage",onChange:e=>la(e.target.files[0])}),ta?e.jsx("div",{className:"mt-2 text-success",children:c("settings.manufacturers.catalogMapping.style.imageSelected",{name:ta.name})}):At.image?e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"mb-1",children:e.jsx("strong",{children:c("settings.manufacturers.catalogMapping.style.currentImage")})}),e.jsx("img",{src:At.image?`${d}/uploads/images/${At.image}`:"/images/nologo.png",alt:"Style Preview",style:{maxWidth:"100%",maxHeight:"300px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"block",margin:"0 auto"},onError:e=>{At.image&&!e.target.dataset.fallbackTried?(e.target.dataset.fallbackTried="1",e.target.src=`${d}/uploads/manufacturer_catalogs/${At.image}`):e.target.src="/images/nologo.png"}})]}):null]})}),e.jsxs(U,{children:[e.jsx(g,{style:{backgroundColor:x,color:j,borderColor:x},onClick:async e=>{e.preventDefault();try{const e=new FormData;Object.keys(At).forEach(s=>{e.append(s,At[s])}),ta&&e.append("styleImage",ta);200==(await o.post("/api/manufacturers/style/create",e,{headers:{"Content-Type":"multipart/form-data"}})).data.status&&(Dt({name:"",shortName:"",description:"",image:""}),J.fire({toast:!0,position:"top",icon:"success",title:"Catalog Style Updated successfully",showConfirmButton:!1,timer:1500,width:"360px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}}))}catch(s){}finally{la(""),zt(!1)}},children:c("common.save")}),e.jsx(g,{color:"secondary",onClick:()=>zt(!1),children:c("common.cancel")})]})]}),e.jsxs(B,{visible:Bt,onClose:()=>qt(!1),size:"lg",children:[e.jsx(Q,{title:`ğŸ“ ${c("settings.manufacturers.catalogMapping.style.detailsTitle")}`}),e.jsx(q,{children:Ut?e.jsxs("div",{style:{padding:"10px 5px"},children:[e.jsx("div",{style:{marginBottom:"1rem",display:"flex",flexWrap:"wrap"},children:e.jsxs("div",{style:{flex:"1 1 100%",paddingRight:"10px"},children:[e.jsxs("p",{children:[e.jsxs("strong",{children:["ğŸ·ï¸ ",c("settings.manufacturers.catalogMapping.style.shortName"),":"]})," ",Ut.shortName?Ut.shortName:c("common.na")]}),e.jsxs("p",{children:[e.jsxs("strong",{children:["ğŸ“ ",c("settings.manufacturers.catalogMapping.fields.description"),":"]})," ",Ut.description?Ut.description:c("common.na")]})]})}),Ut.image?e.jsx("div",{style:{marginTop:"20px"},children:e.jsx("img",{src:Ut.image?`${d}/uploads/images/${Ut.image}`:"/images/nologo.png",alt:"Style",style:{maxWidth:"100%",maxHeight:"300px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"},onError:e=>{Ut.image&&!e.target.dataset.fallbackTried?(e.target.dataset.fallbackTried="1",e.target.src=`${d}/uploads/manufacturer_catalogs/${Ut.image}`):e.target.src="/images/nologo.png"}})}):e.jsx("p",{style:{textAlign:"center",color:"#888"},children:c("settings.manufacturers.catalogMapping.style.noImage")})]}):e.jsx("p",{children:c("settings.manufacturers.catalogMapping.style.noData")})}),e.jsx(U,{children:e.jsx(g,{color:"secondary",onClick:()=>qt(!1),children:c("common.cancel")})})]}),e.jsxs(B,{visible:ve,onClose:()=>Ne(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.assembly.modalTitle")}),e.jsxs(q,{children:[e.jsx(f,{children:c("settings.manufacturers.catalogMapping.assembly.type")}),e.jsxs(M,{value:ys.type,onChange:e=>js({...ys,type:e.target.value}),children:[e.jsx("option",{value:"",children:c("settings.manufacturers.catalogMapping.assembly.selectType")}),e.jsx("option",{value:"percentage",children:c("settings.manufacturers.catalogMapping.assembly.percentage")}),e.jsx("option",{value:"fixed",children:c("settings.manufacturers.catalogMapping.assembly.fixed")})]}),e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.fields.price")}),e.jsx(v,{type:"number",value:ys.price,onChange:e=>js({...ys,price:e.target.value}),placeholder:c("settings.manufacturers.catalogMapping.placeholders.price")}),e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.assembly.applyTo")}),e.jsxs(M,{value:ys.applyTo,onChange:e=>js({...ys,applyTo:e.target.value}),children:[e.jsx("option",{value:"one",children:c("settings.manufacturers.catalogMapping.assembly.applyOne")}),e.jsx("option",{value:"type",children:c("settings.manufacturers.catalogMapping.assembly.applyType")}),e.jsx("option",{value:"types",children:c("settings.manufacturers.catalogMapping.assembly.applyTypes","Apply by Multiple Types")}),e.jsx("option",{value:"all",children:c("settings.manufacturers.catalogMapping.assembly.applyAll")})]}),"type"===ys.applyTo&&e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.assembly.selectItemType")}),e.jsxs(M,{value:ys.selectedItemType,onChange:e=>js({...ys,selectedItemType:e.target.value}),children:[e.jsx("option",{value:"",children:c("settings.manufacturers.catalogMapping.assembly.chooseType")}),bs.map(s=>e.jsxs("option",{value:s.type,children:[s.type," (",s.count," items)"]},s.type))]})]}),"types"===ys.applyTo&&e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.assembly.selectMultipleTypes","Select Item Types")}),e.jsx("div",{className:"border rounded p-3",style:{maxHeight:"300px",overflowY:"auto"},children:bs.map(s=>{const a=ys.selectedTypes.includes(s.type),t=vs[s.type]?.assemblyCosts||[];return e.jsxs("div",{className:"form-check mb-2",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:`type-${s.type}`,checked:a,onChange:e=>{e.target.checked?js(e=>({...e,selectedTypes:[...e.selectedTypes,s.type]})):js(e=>({...e,selectedTypes:e.selectedTypes.filter(e=>e!==s.type)}))}}),e.jsxs("label",{className:"form-check-label d-flex justify-content-between align-items-center w-100",htmlFor:`type-${s.type}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold",children:s.type}),e.jsxs("small",{className:"text-muted",children:[s.count," items"]})]}),e.jsx("div",{children:t.map((s,a)=>e.jsxs("span",{className:"badge bg-info ms-1",title:`${s.assemblyType}: $${s.price.toFixed(2)} (${s.itemsWithCost} items)`,children:["$",s.price.toFixed(2)]},a))})]})]},s.type)})}),e.jsxs("div",{className:"mt-3 d-flex gap-2",children:[e.jsx("button",{className:"btn btn-outline-secondary btn-sm",type:"button",onClick:()=>{const e=bs.map(e=>e.type);js(s=>({...s,selectedTypes:e}))},children:c("common.selectAll","Select All")}),e.jsx("button",{className:"btn btn-outline-secondary btn-sm",type:"button",onClick:()=>js(e=>({...e,selectedTypes:[]})),children:c("common.selectNone","Select None")})]}),ys.selectedTypes.length>0&&e.jsx("div",{className:"alert alert-info mt-3",children:e.jsx("small",{children:c("settings.manufacturers.catalogMapping.assembly.multipleTypesWarning","This will apply the assembly cost to all items in {{count}} selected types.",{count:ys.selectedTypes.length})})})]})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>Ne(!1),children:c("common.cancel")}),e.jsx(g,{style:{backgroundColor:x,color:j,borderColor:x},onClick:async()=>{try{if("type"===ys.applyTo&&!ys.selectedItemType)return void alert("Please select an item type when applying by type.");if("types"===ys.applyTo&&0===ys.selectedTypes.length)return void alert("Please select at least one item type when applying by types.");const e={catalogDataId:Hs.id,type:ys.type,price:parseFloat(ys.price)||0,applyTo:ys.applyTo||"one",manufacturerId:Hs.manufacturerId};"type"===ys.applyTo&&(e.itemType=ys.selectedItemType),"types"===ys.applyTo&&(e.selectedTypes=ys.selectedTypes),await o.post("/api/manufacturers/items/assembly-cost",e),Ne(!1),da()}catch(e){}},children:c("common.save")})]})]}),e.jsxs(B,{visible:Ce,onClose:()=>we(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.hinges.modalTitle")}),e.jsxs(q,{children:[e.jsx(f,{children:c("settings.manufacturers.catalogMapping.hinges.left")}),e.jsx(v,{type:"number",value:Cs.leftHingePrice,onChange:e=>ws({...Cs,leftHingePrice:e.target.value}),placeholder:c("settings.manufacturers.catalogMapping.hinges.placeholderLeft")}),e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.hinges.right")}),e.jsx(v,{type:"number",value:Cs.rightHingePrice,onChange:e=>ws({...Cs,rightHingePrice:e.target.value}),placeholder:c("settings.manufacturers.catalogMapping.hinges.placeholderRight")}),e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.hinges.both")}),e.jsx(v,{type:"number",value:Cs.bothHingePrice,onChange:e=>ws({...Cs,bothHingePrice:e.target.value}),placeholder:c("settings.manufacturers.catalogMapping.hinges.placeholderBoth")}),e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.hinges.exposedSide")}),e.jsx(v,{type:"number",value:Cs.exposedSidePrice,onChange:e=>ws({...Cs,exposedSidePrice:e.target.value}),placeholder:c("settings.manufacturers.catalogMapping.hinges.placeholderExposed")})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>we(!1),children:c("common.cancel")}),e.jsx(g,{style:{backgroundColor:x,color:j,borderColor:x},onClick:async()=>{try{const e={catalogDataId:Hs.id,leftHingePrice:parseFloat(Cs.leftHingePrice)||0,rightHingePrice:parseFloat(Cs.rightHingePrice)||0,bothHingesPrice:parseFloat(Cs.bothHingePrice)||0,exposedSidePrice:parseFloat(Cs.exposedSidePrice)||0};await o.post("/api/manufacturers/items/hinges",e),we(!1)}catch(e){}},children:c("common.save")})]})]}),e.jsxs(B,{visible:Se,onClose:()=>ke(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.mod.modalTitle")}),e.jsxs(q,{children:[e.jsx(f,{children:c("settings.manufacturers.catalogMapping.mod.name")}),e.jsx(v,{value:Ss.modificationName,onChange:e=>ks({...Ss,modificationName:e.target.value})}),e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.fields.description")}),e.jsx(w,{value:Ss.description,onChange:e=>ks({...Ss,description:e.target.value}),rows:3}),e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.mod.notes")}),e.jsx(w,{value:Ss.notes,onChange:e=>ks({...Ss,notes:e.target.value}),rows:2}),e.jsx(f,{className:"mt-2",children:c("settings.manufacturers.catalogMapping.fields.price")}),e.jsx(v,{type:"number",value:Ss.price,onChange:e=>ks({...Ss,price:e.target.value})})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>ke(!1),children:c("common.cancel")}),e.jsx(g,{style:{backgroundColor:x,color:j,borderColor:x},onClick:async()=>{try{const e={catalogDataId:Hs.id,modificationName:Ss.modificationName,description:Ss.description,notes:Ss.notes,price:parseFloat(Ss.price)||0};await o.post("/api/manufacturers/items/modifications",e),ke(!1)}catch(e){}},children:c("common.save")})]})]}),e.jsxs(B,{visible:Fa,onClose:()=>Pa(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.deleteStyle.modalTitle",{style:za})}),e.jsx(q,{children:e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{children:['You are about to delete the style "',e.jsx("strong",{children:za}),'". This will affect ',e.jsx("strong",{children:b.filter(e=>e.style===za).length})," catalog items."]}),e.jsx("p",{children:"What would you like to do with the items that currently have this style?"}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"form-check mb-2",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"deleteOption",id:"deleteItems",checked:!Ra,onChange:()=>Aa("")}),e.jsxs("label",{className:"form-check-label text-danger",htmlFor:"deleteItems",children:[e.jsx("strong",{children:"Delete all items"})," with this style permanently"]})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"deleteOption",id:"mergeItems",checked:!!Ra,onChange:()=>Aa(ia.find(e=>e!==za)||"")}),e.jsxs("label",{className:"form-check-label text-primary",htmlFor:"mergeItems",children:[e.jsx("strong",{children:"Merge items"})," to another style"]})]})]}),""!==Ra&&e.jsxs("div",{className:"mt-3",children:[e.jsx(f,{children:"Select target style:"}),e.jsxs(M,{value:Ra,onChange:e=>Aa(e.target.value),children:[e.jsx("option",{value:"",children:"Select a style..."}),ia.filter(e=>e!==za).map((s,a)=>e.jsx("option",{value:s,children:s},a))]})]}),e.jsx("div",{className:"mt-3 p-3 bg-light rounded",children:e.jsx("small",{className:"text-muted",children:Ra?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Smart Merge Action:"})," All ",b.filter(e=>e.style===za).length,' items with style "',za,'" will be processed:',e.jsxs("ul",{className:"mt-1 mb-0",children:[e.jsxs("li",{children:['Items with unique codes will be merged to style "',Ra,'"']}),e.jsx("li",{children:"Duplicate items (same code + style) will be automatically removed"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Delete Action:"})," All ",b.filter(e=>e.style===za).length,' items with style "',za,'" will be permanently deleted. This action cannot be undone.']})})})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>Pa(!1),disabled:Da,children:c("common.cancel")}),e.jsx(g,{color:Ra?"primary":"danger",onClick:async()=>{if(za&&!Da){Ha(!0);try{const e=Ra?{mergeToStyle:Ra}:{},{data:s}=await o.delete(`/api/manufacturers/${l}/style/${encodeURIComponent(za)}`,{data:e});J.fire({toast:!0,position:"top",icon:"success",title:s.message||"Style operation completed successfully",showConfirmButton:!1,timer:2500,width:"450px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}}),Pa(!1),$a(""),Aa(""),da(1,ue,Y,ae,W,V),pe(1)}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:"Failed to delete/merge style",showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}finally{Ha(!1)}}},disabled:Da||""!==Ra&&!Ra,children:Da?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Processing..."]}):Ra?`Merge to "${Ra}"`:"Delete Permanently"})]})]}),e.jsxs(B,{visible:Va,onClose:()=>Ga(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.deleteItem.modalTitle")}),e.jsx(q,{children:Ya&&e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this catalog item?"}),e.jsxs("div",{className:"p-3 bg-light rounded",children:[e.jsx("strong",{children:"Code:"})," ",Ya.code,e.jsx("br",{}),e.jsx("strong",{children:"Description:"})," ",Ya.description||"N/A",e.jsx("br",{}),e.jsx("strong",{children:"Style:"})," ",Ya.style||"N/A",e.jsx("br",{}),e.jsx("strong",{children:"Price:"})," $",Ya.price||"0.00"]}),e.jsx("p",{className:"text-danger mt-3",children:e.jsx("small",{children:"âš ï¸ This action cannot be undone."})})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>Ga(!1),disabled:Ka,children:c("common.cancel")}),e.jsx(g,{color:"danger",onClick:async()=>{if(Ya&&!Ka){Ja(!0);try{await o.delete(`/api/manufacturers/catalog/edit/${Ya.id}`),J.fire({toast:!0,position:"top",icon:"success",title:"Item deleted successfully",showConfirmButton:!1,timer:1500,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}}),Ga(!1),Qa(null),da(me,ue,Y,ae,W,V)}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:"Failed to delete item",showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}finally{Ja(!1)}}},disabled:Ka,children:Ka?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Deleting..."]}):"Delete Item"})]})]}),e.jsxs(B,{visible:La,onClose:()=>Oa(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.bulk.deleteModalTitle")}),e.jsx(q,{children:e.jsxs("div",{children:[e.jsxs("p",{children:["Are you sure you want to delete ",e.jsx("strong",{children:Ea.length})," selected catalog items?"]}),e.jsxs("div",{className:"p-3 bg-light rounded",children:[e.jsx("strong",{children:"Items to be deleted:"}),e.jsxs("ul",{className:"mt-2 mb-0",children:[fe.filter(e=>Ea.includes(e.id)).slice(0,10).map(s=>e.jsxs("li",{children:[s.code," - ",s.description||"N/A"]},s.id)),Ea.length>10&&e.jsx("li",{children:e.jsxs("em",{children:["... and ",Ea.length-10," more items"]})})]})]}),e.jsx("p",{className:"text-danger mt-3",children:e.jsx("small",{children:"âš ï¸ This action cannot be undone. All selected items will be permanently deleted."})})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>Oa(!1),disabled:Wa,children:c("common.cancel")}),e.jsx(g,{color:"danger",onClick:async()=>{if(0!==Ea.length&&!Wa){_a(!0);try{const e=Ea.map(e=>o.delete(`/api/manufacturers/catalog/edit/${e}`));await Promise.all(e),J.fire({toast:!0,position:"top",icon:"success",title:`Successfully deleted ${Ea.length} items`,showConfirmButton:!1,timer:2e3,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}}),Oa(!1),Ba([]),Ua(!1),da(me,ue,Y,ae,W,V)}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:"Failed to delete some items",showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}finally{_a(!1)}}},disabled:Wa,children:Wa?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Deleting ",Ea.length," items..."]}):`Delete ${Ea.length} Items`})]})]}),e.jsxs(B,{visible:et,onClose:()=>st(!1),children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.rollback.modalTitle")}),e.jsxs(q,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{children:c("settings.manufacturers.catalogMapping.rollback.selectBackup")}),nt?e.jsxs("div",{className:"text-center py-3",children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Loading backups..."]}):0===at.length?e.jsx("div",{className:"alert alert-info",children:c("settings.manufacturers.catalogMapping.rollback.noBackups")}):e.jsx("div",{children:at.map(s=>e.jsxs("div",{className:"form-check mb-2",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"backupSelection",id:`backup-${s.uploadSessionId}`,value:s.uploadSessionId,checked:lt===s.uploadSessionId,onChange:e=>it(e.target.value)}),e.jsx("label",{className:"form-check-label",htmlFor:`backup-${s.uploadSessionId}`,children:e.jsxs("div",{children:[e.jsx("strong",{children:s.originalName}),e.jsx("br",{}),e.jsxs("small",{className:"text-muted",children:[new Date(s.uploadedAt).toLocaleString()," - ",s.itemsCount," items"]})]})})]},s.uploadSessionId))})]}),lt&&e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("strong",{children:c("settings.manufacturers.catalogMapping.rollback.warning")}),e.jsx("br",{}),c("settings.manufacturers.catalogMapping.rollback.confirmText")]})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>{st(!1),it(""),tt([])},children:c("common.cancel")}),e.jsx(g,{color:"warning",onClick:async()=>{if(lt&&!ct){ot(!0);try{const{data:e}=await o.post(`/api/manufacturers/${l}/catalog/rollback`,{uploadSessionId:lt});J.fire({toast:!0,position:"top",icon:"success",title:e.message||c("settings.manufacturers.catalogMapping.rollback.success"),showConfirmButton:!1,timer:2500,width:"450px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}}),st(!1),it(""),tt([]),da(1,ue,Y,ae,W,V),pe(1)}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:c("settings.manufacturers.catalogMapping.rollback.failed"),showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}finally{ot(!1)}}},disabled:!lt||ct,children:ct?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),c("settings.manufacturers.catalogMapping.rollback.rolling")]}):c("settings.manufacturers.catalogMapping.rollback.rollbackButton")})]})]}),e.jsxs(B,{visible:dt,onClose:()=>mt(!1),size:"lg",children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.bulkEdit.header",{count:Ea.length})}),e.jsx(q,{children:e.jsxs("div",{children:[e.jsxs("p",{children:["Edit the following fields for the selected ",Ea.length," catalog items. Leave fields empty to keep existing values."]}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:"Style"}),e.jsx(v,{type:"text",value:gt.style,onChange:e=>ht({...gt,style:e.target.value}),placeholder:"Leave empty to keep existing"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:"Type"}),e.jsx(v,{type:"text",value:gt.type,onChange:e=>ht({...gt,type:e.target.value}),placeholder:"Leave empty to keep existing"})]}),e.jsxs("div",{className:"col-12",children:[e.jsx(f,{children:"Description"}),e.jsx(w,{value:gt.description,onChange:e=>ht({...gt,description:e.target.value}),placeholder:"Leave empty to keep existing",rows:3})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:"Price"}),e.jsx(v,{type:"number",step:"0.01",value:gt.price,onChange:e=>ht({...gt,price:e.target.value}),placeholder:"Leave empty to keep existing"})]})]}),e.jsx("div",{className:"mt-3 p-3 bg-light rounded",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("strong",{children:"Note:"})," Only the fields you fill will be updated. Empty fields will preserve the existing values for each item."]})})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>mt(!1),disabled:pt,children:"Cancel"}),e.jsx(g,{color:"primary",onClick:async()=>{if(0===Ea.length||pt)return;if(Object.values(gt).some(e=>e&&""!==e.trim())){ut(!0);try{const e={};Object.keys(gt).forEach(s=>{gt[s]&&""!==gt[s].trim()&&(e[s]=gt[s].trim())});const{data:s}=await o.put("/api/manufacturers/catalog/bulk-edit",{itemIds:Ea,updates:e});J.fire({toast:!0,position:"top",icon:"success",title:s.message||`Successfully updated ${Ea.length} items`,showConfirmButton:!1,timer:2e3,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}}),mt(!1),Ba([]),Ua(!1),ht({style:"",type:"",description:"",price:""}),da(me,ue,Y,ae,W,V)}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:"Failed to bulk edit items",showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}finally{ut(!1)}}else J.fire({toast:!0,position:"top",icon:"warning",title:"Please fill at least one field to update",showConfirmButton:!1,timer:2e3,width:"350px"})},disabled:pt,children:pt?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating ",Ea.length," Items..."]}):`Update ${Ea.length} Items`})]})]}),e.jsxs(B,{visible:xt,onClose:()=>yt(!1),children:[e.jsx(Q,{title:"Edit Style Name"}),e.jsx(q,{children:e.jsxs("div",{children:[e.jsx("p",{children:"Rename the style for all items of this manufacturer. This will affect all catalog items currently using this style."}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:"Current Style Name"}),e.jsx(v,{type:"text",value:ft.oldStyleName,disabled:!0,className:"bg-light"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:"New Style Name"}),e.jsx(v,{type:"text",value:ft.newStyleName,onChange:e=>vt({...ft,newStyleName:e.target.value}),placeholder:"Enter new style name",autoFocus:!0})]}),e.jsx("div",{className:"p-3 bg-warning bg-opacity-10 rounded",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("strong",{children:"Warning:"}),' This will rename the style for all items currently using "',ft.oldStyleName,'". The change applies to all ',b.filter(e=>e.style===ft.oldStyleName).length," items with this style."]})})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>yt(!1),disabled:jt,children:"Cancel"}),e.jsx(g,{color:"primary",onClick:async()=>{if(ft.oldStyleName&&ft.newStyleName&&!jt)if(ft.oldStyleName.trim()!==ft.newStyleName.trim()){bt(!0);try{const{data:e}=await o.put(`/api/manufacturers/${l}/style-name`,{oldStyleName:ft.oldStyleName.trim(),newStyleName:ft.newStyleName.trim()});J.fire({toast:!0,position:"top",icon:"success",title:e.message||"Style name updated successfully",showConfirmButton:!1,timer:2500,width:"450px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}}),yt(!1),vt({oldStyleName:"",newStyleName:""}),da(me,ue,Y,ae,W,V)}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:e.message||"Failed to edit style name",showConfirmButton:!1,timer:2e3,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}finally{bt(!1)}}else J.fire({toast:!0,position:"top",icon:"warning",title:"New style name must be different from the old one",showConfirmButton:!1,timer:2e3,width:"350px"})},disabled:jt||!ft.newStyleName.trim(),children:jt?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Renaming Style..."]}):"Rename Style"})]})]}),e.jsxs(B,{visible:Me,onClose:()=>Ie(!1),size:"xl",children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.modManagement.title","Modification Management")}),e.jsxs(q,{children:["cards"===Ge&&e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex gap-3 mb-4 justify-content-center",children:[e.jsx(g,{color:"primary",size:"lg",onClick:()=>{es(null),Ke(""),Is(e=>({categoryId:"",name:"",defaultPrice:"",isReady:!1,sampleImage:"",saveAsBlueprint:!1})),zs(Ca(null)),Ye("addNew"),Xe(1)},children:c("globalMods.ui.buttons.addModification","Add Modification")}),e.jsx(g,{color:"info",size:"lg",onClick:()=>Ye("gallery"),children:c("globalMods.ui.buttons.gallery","Gallery")}),e.jsx(g,{color:"success",size:"lg",onClick:()=>as(!0),children:c("globalMods.ui.buttons.assignModification","Assign Modification")})]}),e.jsxs("div",{className:"row",children:[ga.map(s=>e.jsx("div",{className:"col-md-6 mb-4",children:e.jsxs("div",{className:"card h-100",children:[e.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"mb-0 d-flex align-items-center gap-2",children:[s.image&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`https://app.nj.contractors/uploads/images/${s.image}`,alt:s.name,width:24,height:24,style:{objectFit:"cover",borderRadius:4,border:"1px solid #e9ecef"},onError:e=>{e.currentTarget.src="/images/nologo.png"}}),e.jsx(H,{color:"info",title:c("globalMods.modal.gallery.categoryImageUploaded","Category image uploaded"),children:c("settings.manufacturers.catalogMapping.gallery.badges.img")})]}),s.name]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{className:"badge bg-secondary",children:c("settings.manufacturers.catalogMapping.modManagement.modsCount",{count:s.templates?.length||0})}),e.jsxs(g,{size:"sm",color:"warning",variant:"outline",title:c("globalMods.category.editTooltip"),onClick:()=>{ze({id:s.id,name:s.name||"",orderIndex:s.orderIndex||0,image:s.image||""}),Fe(!0)},children:["âœï¸ ",c("common.edit")]}),e.jsxs(g,{size:"sm",color:"danger",variant:"outline",title:c("globalMods.category.deleteTooltip"),onClick:()=>{De(s),Re(!0)},children:["ğŸ—‘ï¸ ",c("common.delete")]})]})]}),e.jsx("div",{className:"card-body",children:s.templates?.length?s.templates.map(s=>e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 p-2 border rounded",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.sampleImage&&e.jsx("img",{src:`https://app.nj.contractors/uploads/images/${s.sampleImage}`,alt:s.name,width:32,height:32,style:{objectFit:"cover",borderRadius:4,border:"1px solid #e9ecef"},onError:e=>{e.currentTarget.src="/images/nologo.png"}}),e.jsxs("div",{children:[e.jsx("strong",{children:s.name}),s.defaultPrice&&e.jsxs("span",{className:"text-muted",children:[" - $",Number(s.defaultPrice).toFixed(2)]}),e.jsxs("div",{className:"d-flex gap-1 mt-1",children:[e.jsx(H,{color:s.isReady?"success":"warning",children:s.isReady?c("settings.manufacturers.catalogMapping.gallery.badges.ready"):c("settings.manufacturers.catalogMapping.gallery.badges.draft")}),s.sampleImage&&e.jsx(H,{color:"info",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.sampleUploaded"),children:c("settings.manufacturers.catalogMapping.gallery.badges.img")})]})]})]}),e.jsxs("div",{className:"d-flex gap-1",children:[e.jsx(g,{size:"sm",color:"outline-primary",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.edit"),onClick:()=>{We({id:s.id,categoryId:String(s.categoryId||""),name:s.name||"",defaultPrice:null!==s.defaultPrice&&void 0!==s.defaultPrice?String(s.defaultPrice):"",sampleImage:s.sampleImage||"",isReady:!!s.isReady,fieldsConfig:s.fieldsConfig||null}),Ve(Ca(s.fieldsConfig)),Le(!0)},children:"âœï¸"}),e.jsx(g,{size:"sm",color:"outline-danger",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.delete"),onClick:()=>{window.confirm(c("settings.manufacturers.catalogMapping.gallery.confirmDelete",{name:s.name}))&&va(s.id)},children:"ğŸ—‘ï¸"}),e.jsx(g,{size:"sm",color:"outline-warning",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.move"),onClick:()=>{qe(s),Ee(!0)},children:"ğŸ“"}),e.jsx(g,{size:"sm",color:"outline-success",title:c("globalMods.modal.assign.title"),onClick:()=>{ps(e=>({...e,templateId:s.id})),as(!0)},children:"ğŸ¯"})]})]},s.id)):e.jsx("p",{className:"text-muted",children:c("settings.manufacturers.catalogMapping.gallery.emptyCategory")})})]})},s.id)),!ga.length&&e.jsx("div",{className:"col-12 text-center",children:e.jsx("p",{className:"text-muted",children:c("settings.manufacturers.catalogMapping.modManagement.noCategories",{addLabel:c("globalMods.ui.buttons.addModification","Add Modification")})})})]})]}),"addNew"===Ge&&e.jsxs("div",{children:[1===Je&&e.jsxs("div",{children:[e.jsx("h5",{children:c("globalMods.modal.add.step1Title")}),e.jsx("div",{className:"mb-3",children:e.jsxs(M,{value:Qe,onChange:e=>Ke(e.target.value),children:[e.jsx("option",{value:"",children:c("globalMods.modal.add.selectExisting")}),ga.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id)),e.jsx("option",{value:"new",children:c("globalMods.modal.add.createNew")})]})}),"new"===Qe&&e.jsxs("div",{className:"border rounded p-3 mb-3",children:[e.jsx("h6",{children:c("globalMods.modal.add.createNew")}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-8",children:e.jsx(v,{placeholder:c("globalMods.modal.add.newSubmenuName"),value:Ts.name,onChange:e=>Fs(s=>({...s,name:e.target.value}))})}),e.jsx("div",{className:"col-md-4",children:e.jsx(v,{type:"number",placeholder:c("globalMods.modal.add.orderIndex"),value:Ts.orderIndex,onChange:e=>Fs(s=>({...s,orderIndex:e.target.value}))})})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(g,{color:"secondary",onClick:()=>Ye("cards"),children:"Back to Overview"}),e.jsx(g,{color:"primary",onClick:()=>Xe(2),disabled:!Qe||"new"===Qe&&!Ts.name,children:"Next: Template Builder"})]})]}),2===Je&&e.jsxs("div",{children:[e.jsx("h5",{children:"Step 2: Build Modification Template"}),e.jsxs("div",{className:"border rounded p-3 mb-3",children:[e.jsx("h6",{children:"Required Fields"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(v,{placeholder:"Modification name *",value:Ms.name,onChange:e=>Is(s=>({...s,name:e.target.value}))})}),e.jsx("div",{className:"col-md-6",children:e.jsx(v,{type:"number",placeholder:Ms.saveAsBlueprint?"Blueprints don't have prices":"Default price *",value:Ms.saveAsBlueprint?"":Ms.defaultPrice,onChange:e=>Is(s=>({...s,defaultPrice:e.target.value})),disabled:Ms.saveAsBlueprint})})]})]}),e.jsxs("div",{className:"border rounded p-3 mb-3",children:[e.jsx("h6",{children:"Optional Field Builder (Building Blocks)"}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:"Height Slider",checked:Ps.sliders.height.enabled,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,height:{...s.sliders.height,enabled:e.target.checked}}}))})}),Ps.sliders.height.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-2",children:e.jsx(v,{type:"number",placeholder:"Min height",value:Ps.sliders.height.min,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,height:{...s.sliders.height,min:e.target.value}}}))})}),e.jsx("div",{className:"mb-2",children:e.jsx(v,{type:"number",placeholder:"Max height",value:Ps.sliders.height.max,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,height:{...s.sliders.height,max:e.target.value}}}))})}),e.jsxs(M,{value:Ps.sliders.height.useCustomIncrements?"custom":Ps.sliders.height.step,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,height:{...s.sliders.height,step:"custom"===e.target.value?1:e.target.value,useCustomIncrements:"custom"===e.target.value}}})),children:[e.jsx("option",{value:"1",children:"1 inch increments"}),e.jsx("option",{value:"0.5",children:"0.5 inch increments"}),e.jsx("option",{value:"0.25",children:"0.25 inch increments"}),e.jsx("option",{value:"custom",children:"Custom fractions (1/8, 1/4, 3/8, etc.)"})]})]})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:"Width Slider",checked:Ps.sliders.width.enabled,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,width:{...s.sliders.width,enabled:e.target.checked}}}))})}),Ps.sliders.width.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-2",children:e.jsx(v,{type:"number",placeholder:"Min width",value:Ps.sliders.width.min,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,width:{...s.sliders.width,min:e.target.value}}}))})}),e.jsx("div",{className:"mb-2",children:e.jsx(v,{type:"number",placeholder:"Max width",value:Ps.sliders.width.max,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,width:{...s.sliders.width,max:e.target.value}}}))})}),e.jsxs(M,{value:Ps.sliders.width.useCustomIncrements?"custom":Ps.sliders.width.step,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,width:{...s.sliders.width,step:"custom"===e.target.value?1:e.target.value,useCustomIncrements:"custom"===e.target.value}}})),children:[e.jsx("option",{value:"1",children:"1 inch increments"}),e.jsx("option",{value:"0.5",children:"0.5 inch increments"}),e.jsx("option",{value:"0.25",children:"0.25 inch increments"}),e.jsx("option",{value:"custom",children:"Custom fractions (1/8, 1/4, 3/8, etc.)"})]})]})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:"Depth Slider",checked:Ps.sliders.depth.enabled,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,depth:{...s.sliders.depth,enabled:e.target.checked}}}))})}),Ps.sliders.depth.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-2",children:e.jsx(v,{type:"number",placeholder:"Min depth",value:Ps.sliders.depth.min,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,depth:{...s.sliders.depth,min:e.target.value}}}))})}),e.jsx("div",{className:"mb-2",children:e.jsx(v,{type:"number",placeholder:"Max depth",value:Ps.sliders.depth.max,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,depth:{...s.sliders.depth,max:e.target.value}}}))})}),e.jsxs(M,{value:Ps.sliders.depth.useCustomIncrements?"custom":Ps.sliders.depth.step,onChange:e=>zs(s=>({...s,sliders:{...s.sliders,depth:{...s.sliders.depth,step:"custom"===e.target.value?1:e.target.value,useCustomIncrements:"custom"===e.target.value}}})),children:[e.jsx("option",{value:"1",children:"1 inch increments"}),e.jsx("option",{value:"0.5",children:"0.5 inch increments"}),e.jsx("option",{value:"0.25",children:"0.25 inch increments"}),e.jsx("option",{value:"custom",children:"Custom fractions (1/8, 1/4, 3/8, etc.)"})]})]})]})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:"Side Selector",checked:Ps.sideSelector.enabled,onChange:e=>zs(s=>({...s,sideSelector:{...s.sideSelector,enabled:e.target.checked}}))})}),Ps.sideSelector.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsx("small",{className:"text-muted d-block mb-2",children:"Limited to Left/Right options"}),e.jsx(v,{placeholder:"L,R",value:Ps.sideSelector.options?.join(","),onChange:e=>zs(s=>({...s,sideSelector:{...s.sideSelector,options:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}})),disabled:!0})]})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:"Quantity Limits",checked:Ps.qtyRange.enabled,onChange:e=>zs(s=>({...s,qtyRange:{...s.qtyRange,enabled:e.target.checked}}))})}),Ps.qtyRange.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-2",children:e.jsx(v,{type:"number",placeholder:"Min qty",value:Ps.qtyRange.min,onChange:e=>zs(s=>({...s,qtyRange:{...s.qtyRange,min:e.target.value}}))})}),e.jsx(v,{type:"number",placeholder:"Max qty",value:Ps.qtyRange.max,onChange:e=>zs(s=>({...s,qtyRange:{...s.qtyRange,max:e.target.value}}))})]})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:"Customer Notes",checked:Ps.notes.enabled,onChange:e=>zs(s=>({...s,notes:{...s.notes,enabled:e.target.checked}}))})}),Ps.notes.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-2",children:e.jsx(v,{placeholder:"Notes placeholder",value:Ps.notes.placeholder,onChange:e=>zs(s=>({...s,notes:{...s.notes,placeholder:e.target.value}}))})}),e.jsx(C,{label:"Show in red for customer warning",checked:Ps.notes.showInRed,onChange:e=>zs(s=>({...s,notes:{...s.notes,showInRed:e.target.checked}}))})]})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:"Customer Upload",checked:Ps.customerUpload.enabled,onChange:e=>zs(s=>({...s,customerUpload:{...s.customerUpload,enabled:e.target.checked}}))})}),Ps.customerUpload.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-2",children:e.jsx(v,{placeholder:c("settings.manufacturers.catalogMapping.builder.uploadTitlePh"),value:Ps.customerUpload.title,onChange:e=>zs(s=>({...s,customerUpload:{...s.customerUpload,title:e.target.value}}))})}),e.jsx(C,{label:c("settings.manufacturers.catalogMapping.builder.requiredUpload"),checked:Ps.customerUpload.required,onChange:e=>zs(s=>({...s,customerUpload:{...s.customerUpload,required:e.target.checked}}))})]})]})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h6",{className:"mb-0",children:c("settings.manufacturers.catalogMapping.builder.descriptions.header")})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(v,{placeholder:c("settings.manufacturers.catalogMapping.builder.descriptions.internal"),value:Ps.descriptions.internal,onChange:e=>zs(s=>({...s,descriptions:{...s.descriptions,internal:e.target.value}}))})}),e.jsx("div",{className:"col-md-4",children:e.jsx(v,{placeholder:c("settings.manufacturers.catalogMapping.builder.descriptions.customer"),value:Ps.descriptions.customer,onChange:e=>zs(s=>({...s,descriptions:{...s.descriptions,customer:e.target.value}}))})}),e.jsx("div",{className:"col-md-4",children:e.jsx(v,{placeholder:c("settings.manufacturers.catalogMapping.builder.descriptions.installer"),value:Ps.descriptions.installer,onChange:e=>zs(s=>({...s,descriptions:{...s.descriptions,installer:e.target.value}}))})})]}),e.jsx("div",{className:"mt-2",children:e.jsx(C,{label:c("settings.manufacturers.catalogMapping.builder.descriptions.showBoth"),checked:Ps.descriptions.both,onChange:e=>zs(s=>({...s,descriptions:{...s.descriptions,both:e.target.checked}}))})})]})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:c("settings.manufacturers.catalogMapping.builder.sampleImage.label"),checked:Ps.modSampleImage.enabled,onChange:e=>zs(s=>({...s,modSampleImage:{...s.modSampleImage,enabled:e.target.checked}}))})}),Ps.modSampleImage.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx(f,{children:c("settings.manufacturers.catalogMapping.builder.sampleImage.upload")}),e.jsx(v,{type:"file",accept:"image/*",onChange:async e=>{const s=e.target.files?.[0],a=await ja(s);a&&Is(e=>({...e,sampleImage:a}))}})]}),Ms.sampleImage&&e.jsx("div",{className:"p-2 bg-light border rounded",style:{height:200,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("img",{src:`https://app.nj.contractors/uploads/images/${Ms.sampleImage}`,alt:c("settings.manufacturers.catalogMapping.builder.sampleImage.alt"),style:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"},onError:e=>{e.currentTarget.src="/images/nologo.png"}})})]})]})})]}),e.jsxs("div",{className:"border-top pt-3",children:[e.jsx(C,{label:c("settings.manufacturers.catalogMapping.builder.ready.markAsReady"),checked:Ms.isReady,onChange:e=>Is(s=>({...s,isReady:e.target.checked}))}),e.jsx(C,{label:c("settings.manufacturers.catalogMapping.builder.ready.saveAsBlueprint"),checked:Ms.saveAsBlueprint,onChange:e=>Is(s=>({...s,saveAsBlueprint:e.target.checked})),className:"mt-2"}),e.jsx("small",{className:"text-muted d-block mt-1",children:c("settings.manufacturers.catalogMapping.builder.ready.blueprintHint")})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(g,{color:"secondary",onClick:()=>Xe(1),children:c("settings.manufacturers.catalogMapping.builder.buttons.back")}),e.jsx(g,{color:"secondary",onClick:()=>Ye("cards"),children:c("settings.manufacturers.catalogMapping.builder.buttons.cancel")}),Ze?e.jsx(g,{color:"primary",onClick:async()=>{Ds(!0);try{let e=Qe;if("new"===Qe){e=(await ba()).id}await(async(e,s)=>{try{const a={sliders:Ps.sliders,sideSelector:Ps.sideSelector,qtyRange:Ps.qtyRange,notes:Ps.notes,customerUpload:Ps.customerUpload,descriptions:Ps.descriptions,modSampleImage:Ps.modSampleImage};await o.put(`/api/global-mods/templates/${e}`,{categoryId:s||null,name:Ms.name,defaultPrice:Ms.defaultPrice?parseFloat(Ms.defaultPrice):null,isReady:Ms.isReady,fieldsConfig:a,sampleImage:Ms.sampleImage||null}),await ua()}catch(a){throw a}})(Ze,e),fa(),J.fire({toast:!0,position:"top",icon:"success",title:c("settings.manufacturers.catalogMapping.builder.toast.updateSuccess"),showConfirmButton:!1,timer:1500})}catch(e){J.fire({toast:!0,position:"top",icon:"error",title:e.response?.data?.message||c("settings.manufacturers.catalogMapping.builder.toast.updateFailed"),showConfirmButton:!1,timer:1800})}finally{Ds(!1)}},disabled:!Ms.name||As,children:As?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),c("common.saving")]}):c("settings.manufacturers.catalogMapping.builder.buttons.saveChanges")}):e.jsx(g,{color:"primary",onClick:async()=>{if(l){Ds(!0);try{let e=Qe;if("new"===Qe){e=(await ba()).id}await(async e=>{try{if(!l)throw new Error("Manufacturer ID is required to create modifications");const s={sliders:Ps.sliders,sideSelector:Ps.sideSelector,qtyRange:Ps.qtyRange,notes:Ps.notes,customerUpload:Ps.customerUpload,descriptions:Ps.descriptions,modSampleImage:Ps.modSampleImage},a=Ms.saveAsBlueprint||!1,t={categoryId:a?null:e||null,name:Ms.name,isReady:Ms.isReady,fieldsConfig:s,sampleImage:Ms.sampleImage||null,isBlueprint:a};a?(t.manufacturerId=null,t.defaultPrice=null):(t.manufacturerId=l,t.defaultPrice=Ms.defaultPrice?parseFloat(Ms.defaultPrice):null);const{data:i}=await o.post("/api/global-mods/templates",t);return await ua(),await xa(),i.template}catch(s){throw s}})(e),fa(),J.fire({title:c("settings.manufacturers.catalogMapping.builder.toast.createSuccessTitle"),text:c("settings.manufacturers.catalogMapping.builder.toast.createSuccessText"),icon:"success",timer:2e3})}catch(e){J.fire({title:c("settings.manufacturers.catalogMapping.builder.toast.createFailedTitle"),text:e.response?.data?.message||c("settings.manufacturers.catalogMapping.builder.toast.createFailedText"),icon:"error"})}finally{Ds(!1)}}else J.fire({title:c("settings.manufacturers.catalogMapping.builder.toast.manufacturerMissingTitle"),text:c("settings.manufacturers.catalogMapping.builder.toast.manufacturerMissingText"),icon:"error"})},disabled:!Ms.name||!Ms.defaultPrice||As,children:As?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),c("common.creating")]}):c("settings.manufacturers.catalogMapping.builder.buttons.create")})]})]})]}),"gallery"===Ge&&e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h5",{children:c("settings.manufacturers.catalogMapping.gallery.title")}),e.jsx(g,{color:"secondary",onClick:()=>Ye("cards"),children:c("settings.manufacturers.catalogMapping.gallery.back")})]}),e.jsx("div",{className:"row",children:is.map(s=>e.jsx("div",{className:"col-md-6 mb-4",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[e.jsx("h6",{className:"mb-0",children:s.name}),e.jsx("div",{className:"d-flex gap-2",children:e.jsx(g,{size:"sm",color:"danger",variant:"outline",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.deleteCategory"),onClick:()=>{De(s),Re(!0)},children:c("settings.manufacturers.catalogMapping.gallery.actions.delete")})})]}),e.jsx("div",{className:"card-body",children:s.templates?.length?s.templates.map(s=>e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2 p-2 border rounded",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.sampleImage&&e.jsx("img",{src:`https://app.nj.contractors/uploads/images/${s.sampleImage}`,alt:s.name,width:32,height:32,style:{objectFit:"cover",borderRadius:4,border:"1px solid #e9ecef"},onError:e=>{e.currentTarget.src="/images/nologo.png"}}),e.jsxs("div",{children:[e.jsx("strong",{children:s.name}),s.defaultPrice&&e.jsxs("span",{className:"text-muted",children:[" - $",Number(s.defaultPrice).toFixed(2)]}),e.jsxs("div",{className:"d-flex gap-1 mt-1",children:[e.jsx(H,{color:s.isReady?"success":"warning",children:s.isReady?c("settings.manufacturers.catalogMapping.gallery.badges.ready"):c("settings.manufacturers.catalogMapping.gallery.badges.draft")}),s.sampleImage&&e.jsx(H,{color:"info",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.sampleUploaded"),children:c("settings.manufacturers.catalogMapping.gallery.badges.img")})]}),e.jsx("div",{className:"small text-muted",children:s.fieldsConfig?.descriptions?.customer||c("settings.manufacturers.catalogMapping.gallery.noDescription")})]})]}),e.jsxs("div",{className:"d-flex gap-1 flex-wrap",children:[e.jsx(g,{size:"sm",color:"outline-primary",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.edit"),onClick:()=>{We({id:s.id,categoryId:String(s.categoryId||""),name:s.name||"",defaultPrice:null!==s.defaultPrice&&void 0!==s.defaultPrice?String(s.defaultPrice):"",sampleImage:s.sampleImage||"",isReady:!!s.isReady,fieldsConfig:s.fieldsConfig||null}),Ve(Ca(s.fieldsConfig)),Le(!0)},children:"âœï¸"}),e.jsx(g,{size:"sm",color:"outline-danger",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.delete"),onClick:()=>{window.confirm(`Are you sure you want to delete "${s.name}"? This will also remove all assignments of this modification.`)&&va(s.id)},children:"ğŸ—‘ï¸"}),e.jsx(g,{size:"sm",color:"outline-warning",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.move"),onClick:()=>{qe(s),Ee(!0)},children:c("settings.manufacturers.catalogMapping.gallery.actions.move")}),e.jsx(g,{size:"sm",color:"primary",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.useAsBlueprint"),onClick:async()=>{try{await o.post("/api/global-mods/templates",{categoryId:s.categoryId||null,name:`${s.name} (Copy)`,defaultPrice:0,isReady:!1,fieldsConfig:s.fieldsConfig||{},sampleImage:s.sampleImage||null}),await ua()}catch(e){alert(e?.response?.data?.message||e.message)}},children:"ğŸ“‹"}),e.jsx(g,{size:"sm",color:"success",title:c("settings.manufacturers.catalogMapping.gallery.tooltips.assignToManufacturer"),onClick:()=>{ps(e=>({...e,templateId:s.id})),as(!0)},children:"ğŸ¯"})]})]},s.id)):e.jsx("p",{className:"text-muted",children:c("settings.manufacturers.catalogMapping.gallery.emptyCategory")})})]})},s.id))})]})]}),e.jsx(U,{children:e.jsx(g,{color:"secondary",onClick:()=>Ie(!1),children:c("common.close","Close")})})]}),e.jsxs(B,{visible:Te,onClose:()=>Fe(!1),size:"lg",children:[e.jsx(Q,{title:c("globalMods.modal.editCategory.title","Edit Category")}),e.jsxs(q,{children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:c("globalMods.modal.editCategory.nameLabel","Category Name")}),e.jsx(v,{value:Pe.name,onChange:e=>ze(s=>({...s,name:e.target.value}))})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:c("globalMods.modal.editCategory.orderLabel","Order")}),e.jsx(v,{type:"number",value:Pe.orderIndex,onChange:e=>ze(s=>({...s,orderIndex:e.target.value}))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx(f,{children:c("globalMods.modal.editCategory.imageLabel","Category Image")}),e.jsx(v,{type:"file",accept:"image/*",onChange:async e=>{const s=e.target.files?.[0],a=await ja(s);a&&ze(e=>({...e,image:a}))}}),Pe.image&&e.jsx("div",{className:"mt-2 p-2 bg-light border rounded",style:{height:220,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("img",{src:`https://app.nj.contractors/uploads/images/${Pe.image}`,alt:c("globalMods.modal.editCategory.imageLabel","Category Image"),style:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"},onError:e=>{e.currentTarget.src="/images/nologo.png"}})})]})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mt-3",children:[e.jsx(g,{color:"secondary",onClick:()=>Fe(!1),children:c("globalMods.modal.editCategory.cancel","Cancel")}),e.jsx(g,{color:"primary",onClick:async()=>{Pe.id&&Pe.name.trim()&&(await o.put(`/api/global-mods/categories/${Pe.id}`,{name:Pe.name.trim(),orderIndex:Number(Pe.orderIndex||0),image:Pe.image||null}),Fe(!1),await ua())},children:c("globalMods.modal.editCategory.save","Save")})]})]})]}),e.jsxs(B,{visible:$e,onClose:()=>Re(!1),children:[e.jsx(Q,{title:c("globalMods.modal.deleteCategory.title",{name:Ae?.name||""})}),e.jsxs(q,{children:[Ae&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:c("globalMods.modal.deleteCategory.warning","âš ï¸ Warning:")})," ",c("globalMods.modal.deleteCategory.aboutToDelete",{name:Ae.name})]}),Ae.templates?.length>0&&e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("strong",{children:c("globalMods.modal.deleteCategory.warning","âš ï¸ Warning:")})," ",c("globalMods.modal.deleteCategory.contains",{count:Ae.templates.length}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"deleteMode",id:"deleteCancel",value:"cancel",defaultChecked:!0}),e.jsx("label",{className:"form-check-label",htmlFor:"deleteCancel",children:c("globalMods.modal.deleteCategory.cancel")})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"deleteMode",id:"deleteWithMods",value:"withMods"}),e.jsx("label",{className:"form-check-label",htmlFor:"deleteWithMods",children:c("globalMods.modal.deleteCategory.deleteWithMods")})]})]})]})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mt-3",children:[e.jsx(g,{color:"secondary",onClick:()=>Re(!1),children:c("globalMods.modal.deleteCategory.cancel","Cancel")}),e.jsx(g,{color:"danger",onClick:async()=>{if(!Ae)return;let e="only";if(Ae.templates?.length>0){const s=document.querySelector('input[name="deleteMode"]:checked')?.value;if("withMods"!==s)return void Re(!1);e="withMods"}await(async(e,s="only")=>{try{const a=`/api/global-mods/categories/${e}${"only"!==s?`?mode=${s}`:""}`;await o.delete(a),await ua(),await xa(),J.fire({toast:!0,position:"top",icon:"success",title:"Category deleted successfully",showConfirmButton:!1,timer:1500,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}catch(a){J.fire({toast:!0,position:"top",icon:"error",title:a.response?.data?.message||"Failed to delete category",showConfirmButton:!1,timer:3e3,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}})(Ae.id,e),Re(!1),De(null)},children:c("globalMods.modal.deleteCategory.deleteOnly","Delete Category")})]})]})]}),e.jsxs(B,{visible:He,onClose:()=>Ee(!1),children:[e.jsx(Q,{title:c("common.move","Move Modification")}),e.jsxs(q,{children:[Be&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[c("common.move","Move")," ",e.jsxs("strong",{children:['"',Be.name,'"']})," ",c("common.to","to")," ",c("common.whichCategory","which category?")]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:c("globalMods.modal.deleteCategory.move.selectTarget","Select destination category")}),e.jsxs("select",{className:"form-select",id:"moveToCategory",defaultValue:Be.categoryId||"",children:[e.jsx("option",{value:"",children:c("common.uncategorized","-- Uncategorized --")}),e.jsx("optgroup",{label:c("common.galleryCategories","Gallery Categories"),children:is.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",c("common.gallery","Gallery"),")"]},`gallery-${s.id}`))}),e.jsx("optgroup",{label:c("common.manufacturerCategories","Manufacturer Categories"),children:ga.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",c("common.manufacturer","Manufacturer"),")"]},`mfg-${s.id}`))})]})]}),e.jsx("div",{className:"alert alert-info",children:e.jsxs("small",{children:[e.jsxs("strong",{children:[c("common.note","Note"),":"]})," ",c("settings.manufacturers.catalogMapping.gallery.tooltips.move","Move to different category")]})})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mt-3",children:[e.jsx(g,{color:"secondary",onClick:()=>Ee(!1),children:c("common.cancel")}),e.jsx(g,{color:"primary",onClick:async()=>{if(!Be)return;const e=document.getElementById("moveToCategory").value;await(async(e,s)=>{try{await o.put(`/api/global-mods/templates/${e}`,{categoryId:s}),await ua(),await xa(),J.fire({toast:!0,position:"top",icon:"success",title:"Modification moved successfully",showConfirmButton:!1,timer:1500,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}catch(a){J.fire({toast:!0,position:"top",icon:"error",title:a.response?.data?.message||"Failed to move modification",showConfirmButton:!1,timer:3e3,width:"350px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}})(Be.id,e||null),Ee(!1),qe(null)},children:c("common.move","Move")})]})]})]}),e.jsxs(B,{visible:Ue,onClose:()=>Le(!1),size:"xl",children:[e.jsx(Q,{title:c("globalMods.modal.editTemplate.title","Edit Modification")}),e.jsxs(q,{children:[e.jsxs("div",{className:"border rounded p-3 mb-3",children:[e.jsx("h6",{children:c("common.basicInformation","Basic Information")}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:c("globalMods.modal.editTemplate.nameLabel","Name")}),e.jsx(v,{value:Oe.name,onChange:e=>We(s=>({...s,name:e.target.value}))})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs(f,{children:[c("globalMods.modal.editTemplate.priceLabel","Default Price")," ",Oe.saveAsBlueprint&&c("common.disabledForBlueprints","(disabled for blueprints)")]}),e.jsx(v,{type:"number",step:"0.01",value:Oe.saveAsBlueprint?"":Oe.defaultPrice,onChange:e=>We(s=>({...s,defaultPrice:e.target.value})),disabled:Oe.saveAsBlueprint,placeholder:Oe.saveAsBlueprint?c("common.blueprintsNoPrice","Blueprints don't have prices"):c("globalMods.template.defaultPricePlaceholder","Enter default price")})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:c("globalMods.template.statusLabel","Status")}),e.jsxs(M,{value:Oe.isReady?"ready":"draft",onChange:e=>We(s=>({...s,isReady:"ready"===e.target.value})),children:[e.jsx("option",{value:"draft",children:c("globalMods.template.status.draft","Draft")}),e.jsx("option",{value:"ready",children:c("globalMods.template.status.ready","Ready")})]})]}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-check form-switch mt-4",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"showToBoth",checked:Oe.showToBoth||!1,onChange:e=>We(s=>({...s,showToBoth:e.target.checked}))}),e.jsxs("label",{className:"form-check-label",htmlFor:"showToBoth",children:[c("globalMods.builder.descriptions.customer","Customer description")," & ",c("globalMods.builder.descriptions.installer","Installer description")," ",c("common.showToBoth","shown to both")]})]})}),e.jsxs("div",{className:"col-12",children:[e.jsx(f,{children:c("globalMods.modal.editTemplate.sampleUploadLabel","Sample Image")}),e.jsx(v,{type:"file",accept:"image/*",onChange:async e=>{const s=e.target.files?.[0],a=await ja(s);a&&We(e=>({...e,sampleImage:a}))}}),Oe.sampleImage&&e.jsx("div",{className:"mt-2 p-2 bg-light border rounded",style:{height:240,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("img",{src:`https://app.nj.contractors/uploads/images/${Oe.sampleImage}`,alt:c("globalMods.modal.editTemplate.sampleAlt","Sample"),style:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"},onError:e=>{e.currentTarget.src="/images/nologo.png"}})})]})]})]}),e.jsxs("div",{className:"border rounded p-3 mb-3",children:[e.jsx("h6",{children:c("common.advancedFieldConfiguration","Advanced Field Configuration")}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:c("globalMods.builder.heightSlider","Height Slider"),checked:_e.sliders.height.enabled,onChange:e=>Ve(s=>({...s,sliders:{...s.sliders,height:{...s.sliders.height,enabled:e.target.checked}}}))})}),_e.sliders.height.enabled&&e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-6",children:e.jsx(v,{placeholder:c("globalMods.builder.min","Min"),type:"number",value:_e.sliders.height.min,onChange:e=>Ve(s=>({...s,sliders:{...s.sliders,height:{...s.sliders.height,min:Number(e.target.value)||0}}}))})}),e.jsx("div",{className:"col-6",children:e.jsx(v,{placeholder:c("globalMods.builder.max","Max"),type:"number",value:_e.sliders.height.max,onChange:e=>Ve(s=>({...s,sliders:{...s.sliders,height:{...s.sliders.height,max:Number(e.target.value)||0}}}))})})]})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:c("globalMods.builder.widthSlider","Width Slider"),checked:_e.sliders.width.enabled,onChange:e=>Ve(s=>({...s,sliders:{...s.sliders,width:{...s.sliders.width,enabled:e.target.checked}}}))})}),_e.sliders.width.enabled&&e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-6",children:e.jsx(v,{placeholder:c("globalMods.builder.min","Min"),type:"number",value:_e.sliders.width.min,onChange:e=>Ve(s=>({...s,sliders:{...s.sliders,width:{...s.sliders.width,min:Number(e.target.value)||0}}}))})}),e.jsx("div",{className:"col-6",children:e.jsx(v,{placeholder:c("globalMods.builder.max","Max"),type:"number",value:_e.sliders.width.max,onChange:e=>Ve(s=>({...s,sliders:{...s.sliders,width:{...s.sliders.width,max:Number(e.target.value)||0}}}))})})]})})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:c("globalMods.builder.depthSlider","Depth Slider"),checked:_e.sliders.depth.enabled,onChange:e=>Ve(s=>({...s,sliders:{...s.sliders,depth:{...s.sliders.depth,enabled:e.target.checked}}}))})}),_e.sliders.depth.enabled&&e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-6",children:e.jsx(v,{placeholder:c("globalMods.builder.min","Min"),type:"number",value:_e.sliders.depth.min,onChange:e=>Ve(s=>({...s,sliders:{...s.sliders,depth:{...s.sliders.depth,min:Number(e.target.value)||0}}}))})}),e.jsx("div",{className:"col-6",children:e.jsx(v,{placeholder:c("globalMods.builder.max","Max"),type:"number",value:_e.sliders.depth.max,onChange:e=>Ve(s=>({...s,sliders:{...s.sliders,depth:{...s.sliders.depth,max:Number(e.target.value)||0}}}))})})]})})]})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:c("globalMods.builder.sideSelector.label","Side Selector"),checked:_e.sideSelector.enabled,onChange:e=>Ve(s=>({...s,sideSelector:{...s.sideSelector,enabled:e.target.checked}}))})}),_e.sideSelector.enabled&&e.jsx("div",{className:"card-body",children:e.jsx(v,{placeholder:c("globalMods.builder.sideSelector.placeholder","Options (comma-separated: L,R)"),value:Array.isArray(_e.sideSelector.options)?_e.sideSelector.options.join(","):"L,R",onChange:e=>Ve(s=>({...s,sideSelector:{...s.sideSelector,options:e.target.value.split(",").map(e=>e.trim()).filter(Boolean)}}))})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:c("globalMods.builder.quantityLimits.label","Quantity Range"),checked:_e.qtyRange.enabled,onChange:e=>Ve(s=>({...s,qtyRange:{...s.qtyRange,enabled:e.target.checked}}))})}),_e.qtyRange.enabled&&e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-6",children:e.jsx(v,{placeholder:c("globalMods.builder.quantityLimits.minQty","Min qty"),type:"number",value:_e.qtyRange.min,onChange:e=>Ve(s=>({...s,qtyRange:{...s.qtyRange,min:Number(e.target.value)||1}}))})}),e.jsx("div",{className:"col-6",children:e.jsx(v,{placeholder:c("globalMods.builder.quantityLimits.maxQty","Max qty"),type:"number",value:_e.qtyRange.max,onChange:e=>Ve(s=>({...s,qtyRange:{...s.qtyRange,max:Number(e.target.value)||10}}))})})]})})]})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:c("globalMods.builder.customerNotes.label","Customer Notes Field"),checked:_e.notes.enabled,onChange:e=>Ve(s=>({...s,notes:{...s.notes,enabled:e.target.checked}}))})}),_e.notes.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsx(v,{placeholder:c("globalMods.builder.customerNotes.placeholder","Placeholder text"),value:_e.notes.placeholder,onChange:e=>Ve(s=>({...s,notes:{...s.notes,placeholder:e.target.value}}))}),e.jsx(C,{className:"mt-2",label:c("globalMods.builder.customerNotes.showInRed","Show in red"),checked:_e.notes.showInRed,onChange:e=>Ve(s=>({...s,notes:{...s.notes,showInRed:e.target.checked}}))})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx(C,{label:c("globalMods.builder.customerUpload.label","Customer File Upload"),checked:_e.customerUpload.enabled,onChange:e=>Ve(s=>({...s,customerUpload:{...s.customerUpload,enabled:e.target.checked}}))})}),_e.customerUpload.enabled&&e.jsxs("div",{className:"card-body",children:[e.jsx(v,{placeholder:c("globalMods.builder.customerUpload.titlePlaceholder","Upload title"),value:_e.customerUpload.title,onChange:e=>Ve(s=>({...s,customerUpload:{...s.customerUpload,title:e.target.value}}))}),e.jsx(C,{className:"mt-2",label:c("globalMods.builder.customerUpload.required","Required"),checked:_e.customerUpload.required,onChange:e=>Ve(s=>({...s,customerUpload:{...s.customerUpload,required:e.target.checked}}))})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h6",{className:"mb-0",children:c("globalMods.builder.title","Guided Builder")})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(v,{placeholder:c("globalMods.builder.descriptions.internal","Internal description"),value:_e.descriptions.internal,onChange:e=>Ve(s=>({...s,descriptions:{...s.descriptions,internal:e.target.value}}))})}),e.jsx("div",{className:"col-md-4",children:e.jsx(v,{placeholder:c("globalMods.builder.descriptions.customer","Customer description"),value:_e.descriptions.customer,onChange:e=>Ve(s=>({...s,descriptions:{...s.descriptions,customer:e.target.value}}))})}),e.jsx("div",{className:"col-md-4",children:e.jsx(v,{placeholder:c("globalMods.builder.descriptions.installer","Installer description"),value:_e.descriptions.installer,onChange:e=>Ve(s=>({...s,descriptions:{...s.descriptions,installer:e.target.value}}))})})]})})]})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mt-3",children:[e.jsx(g,{color:"secondary",onClick:()=>Le(!1),children:c("globalMods.modal.add.cancel","Cancel")}),e.jsx(g,{color:"primary",onClick:async()=>{if(!Oe.id||!Oe.name.trim())return;const e={sliders:_e.sliders,sideSelector:_e.sideSelector,qtyRange:_e.qtyRange,notes:_e.notes,customerUpload:_e.customerUpload,descriptions:_e.descriptions,modSampleImage:_e.modSampleImage};await o.put(`/api/global-mods/templates/${Oe.id}`,{categoryId:Oe.categoryId?Number(Oe.categoryId):null,name:Oe.name.trim(),defaultPrice:Oe.defaultPrice?Number(Oe.defaultPrice):null,fieldsConfig:e,sampleImage:Oe.sampleImage||null,isReady:!!Oe.isReady}),Le(!1),await ua()},children:c("globalMods.modal.editTemplate.saveChanges","Save Changes")})]})]})]}),e.jsxs(B,{visible:Us,onClose:()=>{Ls(!1),Vs({name:"",description:"",requires_hinge_side:!1,requires_exposed_side:!1}),Xs(null)},size:"lg",children:[e.jsx(Q,{title:c(Js?"settings.manufacturers.catalogMapping.subTypes.editTitle":"settings.manufacturers.catalogMapping.subTypes.create"),className:"rounded-0 border-0",cardClassName:"rounded-0 border-bottom"}),e.jsx(q,{children:e.jsxs(y,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs(f,{children:[c("common.name","Name")," *"]}),e.jsx(v,{value:_s.name,onChange:e=>Vs(s=>({...s,name:e.target.value})),placeholder:c("settings.manufacturers.catalogMapping.subTypes.namePlaceholder","e.g., Single Door Cabinets")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:c("common.description")}),e.jsx(w,{rows:3,value:_s.description,onChange:e=>Vs(s=>({...s,description:e.target.value})),placeholder:c("settings.manufacturers.catalogMapping.subTypes.descriptionPlaceholder","Optional description for this sub-type")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(C,{id:"requiresHingeSide",label:c("settings.manufacturers.catalogMapping.subTypes.requiresHingeSelection"),checked:_s.requires_hinge_side,onChange:e=>Vs(s=>({...s,requires_hinge_side:e.target.checked}))}),e.jsx("small",{className:"text-muted",children:c("settings.manufacturers.catalogMapping.subTypes.requiresHingeHelp")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(C,{id:"requiresExposedSide",label:c("settings.manufacturers.catalogMapping.subTypes.requiresExposedSelection"),checked:_s.requires_exposed_side,onChange:e=>Vs(s=>({...s,requires_exposed_side:e.target.checked}))}),e.jsx("small",{className:"text-muted",children:c("settings.manufacturers.catalogMapping.subTypes.requiresExposedHelp")})]})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>{Ls(!1),Vs({name:"",description:"",requires_hinge_side:!1,requires_exposed_side:!1}),Xs(null)},children:c("common.cancel")}),e.jsxs(g,{color:"primary",onClick:async()=>{try{Js?(await o.put(`/api/sub-types/${Js.id}`,_s),J.fire("Success","Sub-type updated successfully!","success")):(await o.post(`/api/manufacturers/${l}/sub-types`,_s),J.fire("Success","Sub-type created successfully!","success")),Ls(!1),Vs({name:"",description:"",requires_hinge_side:!1,requires_exposed_side:!1}),Xs(null),await ma()}catch(e){J.fire(c("common.error"),e.response?.data?.message||c("settings.manufacturers.catalogMapping.subTypes.saveFailed"),"error")}},disabled:!_s.name.trim(),children:[Js?c("common.update","Update"):c("common.create","Create")," ",c("settings.manufacturers.catalogMapping.subTypes.singular","Sub-Type")]})]})]}),e.jsxs(B,{visible:Os,onClose:()=>{Ws(!1),ea(null),Es([]),Ks([])},size:"xl",children:[e.jsx(Q,{title:c("settings.manufacturers.catalogMapping.subTypes.assignModal.title","Assign Catalog Items to Sub-Type"),className:"rounded-0 border-0",cardClassName:"rounded-0 border-bottom"}),e.jsxs(q,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:c("settings.manufacturers.catalogMapping.subTypes.assignModal.selectLabel","Select catalog items to assign to this sub-type:")}),e.jsx("small",{className:"d-block text-muted mb-3",children:c("settings.manufacturers.catalogMapping.subTypes.assignModal.selectedSummary",{codes:Qs.length,items:Hs.length})})]}),e.jsx("div",{className:"table-responsive",style:{maxHeight:"400px"},children:e.jsxs(I,{hover:!0,children:[e.jsx(T,{children:e.jsxs(F,{children:[e.jsx(E,{children:e.jsx(C,{checked:Qs.length===Gs.length&&Gs.length>0,onChange:e=>{if(e.target.checked){const e=Gs.map(e=>e.code),s=Gs.flatMap(e=>e.itemIds);Ks(e),Es(s)}else Ks([]),Es([])}})}),e.jsx(E,{children:c("settings.manufacturers.catalogMapping.table.code")}),e.jsx(E,{children:c("settings.manufacturers.catalogMapping.table.description")}),e.jsx(E,{children:c("settings.manufacturers.catalogMapping.table.type")}),e.jsx(E,{children:c("settings.manufacturers.catalogMapping.assignModal.stylesHeader","Styles")}),e.jsx(E,{children:c("settings.manufacturers.catalogMapping.subTypes.assignModal.itemsCount","Items Count")})]})}),e.jsx(z,{children:Gs.map(s=>e.jsxs(F,{children:[e.jsx(P,{children:e.jsx(C,{checked:Qs.includes(s.code),onChange:e=>{((e,s)=>{const a=Gs.find(s=>s.code===e);a&&(s?(Es(e=>[...e.filter(e=>!a.itemIds.includes(e)),...a.itemIds]),Ks(s=>[...s.filter(s=>s!==e),e])):(Es(e=>e.filter(e=>!a.itemIds.includes(e))),Ks(s=>s.filter(s=>s!==e))))})(s.code,e.target.checked)}})}),e.jsx(P,{children:s.code}),e.jsx(P,{children:s.description}),e.jsx(P,{children:s.type}),e.jsx(P,{children:e.jsxs("small",{className:"text-muted",children:[s.styles.slice(0,3).join(", "),s.styles.length>3&&` +${s.styles.length-3} ${c("settings.manufacturers.catalogMapping.subTypes.assignModal.more","more")}`]})}),e.jsx(P,{children:e.jsx(H,{color:"info",children:s.itemIds.length})})]},s.code))})]})})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>{Ws(!1),ea(null),Es([]),Ks([])},children:c("common.cancel")}),e.jsx(g,{color:"primary",onClick:()=>{Zs&&Hs.length>0&&((async()=>{if(Zs&&0!==Hs.length)try{await o.post(`/api/sub-types/${Zs}/assign-items`,{catalogItemIds:Hs}),J.fire(c("common.success"),c("settings.manufacturers.catalogMapping.subTypes.assignSuccess",{count:Hs.length}),"success"),Ws(!1),Es([]),ea(null),await da()}catch(e){J.fire(c("common.error"),c("settings.manufacturers.catalogMapping.subTypes.assignFailed"),"error")}})(),Ws(!1),ea(null),Es([]),Ks([]))},disabled:0===Hs.length,children:c("settings.manufacturers.catalogMapping.subTypes.assignModal.assignCTA",{count:Hs.length})})]})]})]})},re=({manufacturer:s})=>{const{t:l}=r(),i="https://app.nj.contractors",[n,c]=a.useState([]),[d,m]=a.useState(!1),[y,j]=a.useState(null),[b,N]=a.useState(""),[C,w]=a.useState(null),[M,I]=a.useState(!1),[T,F]=a.useState(null),[P,z]=a.useState(!1),[$,R]=a.useState(null),[A,D]=a.useState(!1),[E,O]=a.useState({name:"",shortName:"",description:"",code:"",imageFile:null}),[W,_]=a.useState(!1),[V,G]=a.useState({open:!1,styleName:""}),[Y,K]=a.useState(""),J=a.useCallback((e,s)=>{const a=s?.styleVariants?.[0]?.image;a&&!e.target.dataset.fallbackTried&&-1===e.target.src.indexOf("/uploads/manufacturer_catalogs/")?(e.target.dataset.fallbackTried="1",e.target.src=`${i}/uploads/manufacturer_catalogs/${a}`):-1===e.target.src.indexOf("/images/nologo.png")&&(e.target.src="/images/nologo.png")},[i]);t.useEffect(()=>{const e=document.createElement("style");return e.innerHTML="\n      .collection-hover {\n        transition: all 0.3s ease;\n      }\n\n      .collection-hover:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n      }\n\n      @media (max-width: 576px) {\n        .collection-hover {\n          margin-bottom: 1rem;\n        }\n\n        .collection-hover:hover {\n          transform: none;\n        }\n\n        .collection-hover:active {\n          transform: scale(0.98);\n        }\n      }\n\n      @media (hover: none) and (pointer: coarse) {\n        .collection-hover:hover {\n          transform: none;\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n        }\n      }\n    ",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),a.useEffect(()=>{s?.id&&X()},[s?.id]);const X=async()=>{if(s?.id){m(!0),j(null);try{const e=await o.get(`/api/manufacturers/${s.id}/styles-meta`,{});e.data&&e.data.styles&&Array.isArray(e.data.styles)?c(e.data.styles):Array.isArray(e.data)?c(e.data):c([])}catch(e){j("Failed to load style pictures. Please try again."),c([])}finally{m(!1)}}},Z=n.filter(e=>e.style?.toLowerCase().includes(b.toLowerCase())||e.styleVariants?.[0]?.shortName?.toLowerCase().includes(b.toLowerCase()));return d?e.jsx(p,{children:e.jsxs(h,{className:"text-center p-5",children:[e.jsx(L,{color:"primary"}),e.jsx("div",{className:"mt-3",children:l("styles.loading","Loading style pictures...")})]})}):y?e.jsx(p,{children:e.jsx(h,{children:e.jsx(x,{color:"danger",children:l("styles.loadFailed","Failed to load style pictures. Please try again.")})})}):s?.id?0===n.length?e.jsx(p,{children:e.jsx(h,{children:e.jsx(x,{color:"info",children:l("styles.noStylesInfo","No styles with pictures found for this manufacturer. Upload style images in the catalog mapping section to see them here.")})})}):e.jsxs("div",{children:[e.jsx("style",{children:"\n        .overlay-action-btn {\n          min-width: 44px;\n          min-height: 44px;\n          display: inline-flex;\n          align-items: center;\n          justify-content: center;\n        }\n        @media (max-width: 576px) {\n          .overlay-action-btn {\n            padding: 8px 10px !important;\n          }\n        }\n      "}),e.jsxs(p,{children:[e.jsx(u,{children:e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center gap-3",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"mb-1",children:[l("styles.header","Style Pictures for {{name}}",{name:s.name}),e.jsxs(H,{color:"primary",className:"ms-2",children:[l("styles.count","{{count}} Styles",{count:Z.length})," ",b?l("styles.filtered","(filtered from {{total}})",{total:n.length}):""]})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center",style:{minWidth:"250px"},children:[e.jsx(g,{color:"success",size:"sm",onClick:()=>D(!0),children:l("styles.create","Add Style")}),e.jsx("div",{style:{minWidth:"250px"},children:e.jsxs(S,{size:"sm",children:[e.jsx(k,{children:e.jsx("i",{className:"bi bi-search"})}),e.jsx(v,{placeholder:l("styles.searchPlaceholder","Search styles..."),value:b,onChange:e=>N(e.target.value)})]})})]}),e.jsx("small",{className:"text-muted",children:l("styles.helperText","View all styles with their associated pictures. Images are used in quote creation to help customers visualize their selections.")})]}),e.jsx("div",{style:{minWidth:"250px"},children:e.jsxs(S,{size:"sm",children:[e.jsx(k,{children:e.jsx("i",{className:"bi bi-search"})}),e.jsx(v,{placeholder:l("styles.searchPlaceholder","Search styles..."),value:b,onChange:e=>N(e.target.value)})]})})]})}),e.jsx(h,{children:0===Z.length?e.jsx(x,{color:"info",className:"text-center",children:b?e.jsxs(e.Fragment,{children:[l("styles.noneMatch",'No styles found matching "{{term}}".',{term:b}),e.jsx("br",{}),e.jsx("small",{children:l("styles.tryAdjust","Try adjusting your search terms or clear the search to see all styles.")})]}):l("styles.noneAvailable","No styles with pictures found for this manufacturer.")}):e.jsx("div",{className:"d-flex flex-wrap justify-content-start gap-3",children:Z.map((a,t)=>e.jsx("div",{className:"text-center",style:{minWidth:"80px",maxWidth:"120px"},children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onMouseEnter:()=>w(a.id),onMouseLeave:()=>w(null),children:[e.jsxs("div",{className:"collection-hover border rounded shadow-sm position-relative d-inline-block",style:{overflow:"hidden",borderRadius:"8px",transition:"transform 0.3s ease",backgroundColor:"#f8f9fa",maxWidth:"100%"},children:[e.jsx("img",{src:a.styleVariants?.[0]?.image?`${i}/uploads/images/${a.styleVariants[0].image}`:"/images/nologo.png",alt:a.styleVariants?.[0]?.shortName||a.style,style:{maxWidth:"120px",maxHeight:"150px",height:"auto",width:"auto",borderRadius:"8px",transition:"transform 0.3s ease",transform:C===a.id?"scale(1.02)":"scale(1)",display:"block"},className:"img-fluid",onError:e=>J(e,a)}),e.jsxs("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{backgroundColor:"rgba(0, 0, 0, 0.6)",color:"#fff",opacity:C===a.id?1:0,transition:"opacity 0.3s ease",fontSize:"0.85rem",fontWeight:"500",borderRadius:"8px"},children:[e.jsxs(g,{color:"light",size:"sm",className:"overlay-action-btn","aria-label":l("types.ui.uploadImage","Upload Image"),onClick:e=>{e.stopPropagation(),(e=>{F(e),R(null),I(!0)})(a)},style:{fontSize:"0.75rem"},children:[e.jsx(ae,{size:18,"aria-hidden":"true",className:"me-1"})," ",l("types.ui.uploadImage","Upload Image")]}),e.jsx(g,{color:"danger",size:"sm",className:"ms-2 overlay-action-btn","aria-label":l("common.delete","Delete"),onClick:e=>{e.stopPropagation(),G({open:!0,styleName:a.style}),K("")},style:{fontSize:"0.75rem"},children:e.jsx(te,{size:18,"aria-hidden":"true"})})]})]}),e.jsxs(B,{visible:A,onClose:()=>D(!1),className:"no-gradient-modal",children:[e.jsx(Q,{title:l("styles.createHeader","Add Style")}),e.jsx(q,{children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:l("styles.name","Style Name")}),e.jsx(v,{value:E.name,onChange:e=>O(s=>({...s,name:e.target.value}))})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:l("styles.short","Short Name")}),e.jsx(v,{value:E.shortName,onChange:e=>O(s=>({...s,shortName:e.target.value}))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx(f,{children:l("common.description","Description")}),e.jsx(v,{value:E.description,onChange:e=>O(s=>({...s,description:e.target.value}))})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:l("common.code","Code")}),e.jsx(v,{value:E.code,onChange:e=>O(s=>({...s,code:e.target.value}))})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:l("common.image","Image")}),e.jsx("input",{className:"form-control",type:"file",accept:"image/*",onChange:e=>O(s=>({...s,imageFile:e.target.files?.[0]||null}))})]})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>D(!1),disabled:W,children:"Cancel"}),e.jsx(g,{color:"primary",disabled:W||!E.name.trim(),onClick:async()=>{_(!0);try{const e=new FormData;E.imageFile&&e.append("styleImage",E.imageFile),e.append("manufacturerId",s.id),e.append("name",E.name.trim()),e.append("shortName",E.shortName||""),e.append("description",E.description||""),e.append("code",E.code||""),await o.post(`/api/manufacturers/${s.id}/styles`,e,{headers:{"Content-Type":"multipart/form-data"}}),await X(),D(!1)}catch(e){}finally{_(!1)}},children:W?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:"sm",className:"me-2"}),"Saving..."]}):"Save"})]})]}),e.jsxs(B,{visible:V.open,onClose:()=>G({open:!1,styleName:""}),className:"no-gradient-modal",children:[e.jsx(Q,{title:l("styles.deleteHeader","Delete Style")}),e.jsxs(q,{children:[e.jsxs("p",{children:[l("styles.deleteConfirm","Delete style")," ",e.jsx("strong",{children:V.styleName}),"?"]}),e.jsx(f,{children:l("styles.reassign","Reassign items to (leave empty to clear)")}),e.jsx(v,{value:Y,onChange:e=>K(e.target.value),placeholder:l("styles.reassignPh","New style name or blank")})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>G({open:!1,styleName:""}),children:"Cancel"}),e.jsx(g,{color:"danger",onClick:async()=>{try{await o.delete(`/api/manufacturers/${s.id}/styles/${encodeURIComponent(V.styleName)}`,{data:{reassignTo:Y}}),await X()}catch(e){}finally{G({open:!1,styleName:""}),K("")}},children:l("common.delete","Delete")})]})]}),e.jsxs("div",{className:"mt-2",style:{maxWidth:"120px"},children:[e.jsx("div",{className:"text-muted fw-semibold text-truncate",title:a.styleVariants?.[0]?.shortName||a.style,style:{fontSize:"0.8rem",lineHeight:"1.2"},children:a.styleVariants?.[0]?.shortName||a.style}),a.styleVariants?.length>0&&e.jsx("div",{className:"text-center mt-1",children:e.jsxs(H,{color:"secondary",style:{fontSize:"0.6rem"},children:[a.styleVariants.length," ",l("styles.variants","variants")]})})]})]})},a.id||t))})})]}),e.jsx("style",{children:"\n        .no-gradient-modal .modal-header {\n          background: #fff !important;\n          border-bottom: 1px solid #dee2e6 !important;\n          color: #212529 !important;\n        }\n        .no-gradient-modal .modal-title {\n          color: #212529 !important;\n        }\n      "}),e.jsxs(B,{visible:M,onClose:()=>{I(!1),F(null),R(null)},size:"lg",className:"no-gradient-modal",children:[e.jsx(Q,{title:l("styles.editImage","Edit Style Image")}),e.jsx(q,{children:T&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("strong",{children:[l("common.style","Style"),":"]})," ",T.style]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{children:l("types.ui.currentImage","Current Image:")}),e.jsx("div",{className:"d-flex justify-content-center p-3 border rounded",style:{backgroundColor:"#f8f9fa"},children:e.jsx("img",{src:T.styleVariants?.[0]?.image?`${i}/uploads/images/${T.styleVariants[0].image}`:"/default-image.png",alt:T.style,style:{maxWidth:"200px",maxHeight:"200px",objectFit:"contain",border:"1px solid #dee2e6",borderRadius:"4px"},onError:e=>J(e,T)})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"imageUpload",children:l("styles.uploadNewImage","Upload New Image:")}),e.jsx("input",{type:"file",id:"imageUpload",className:"form-control",accept:"image/*",onChange:e=>{const s=e.target.files[0];R(s)}}),e.jsx("div",{className:"mt-2 text-muted",children:$?e.jsxs(e.Fragment,{children:[l("styles.selected","Selected"),": ",$.name]}):T.styleVariants?.[0]?.image?e.jsxs(e.Fragment,{children:[l("types.ui.current","Current"),": ",T.styleVariants[0].image]}):e.jsx(e.Fragment,{children:l("types.ui.noImage","No image uploaded")})})]}),$&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{children:l("styles.previewNewImage","New Image Preview:")}),e.jsx("div",{className:"d-flex justify-content-center p-3 border rounded",style:{backgroundColor:"#f8f9fa"},children:e.jsx("img",{src:URL.createObjectURL($),alt:"Preview",style:{maxWidth:"200px",maxHeight:"200px",objectFit:"contain",border:"1px solid #dee2e6",borderRadius:"4px"}})})]})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>{I(!1),F(null),R(null)},children:l("common.cancel","Cancel")}),e.jsx(g,{color:"primary",onClick:async()=>{if(T&&$){z(!0);try{const e=new FormData;e.append("styleImage",$),e.append("name",T.style),e.append("shortName",T.styleVariants?.[0]?.shortName||""),e.append("description",T.styleVariants?.[0]?.description||""),e.append("manufacturerId",s.id),e.append("catalogId",T.id),e.append("code",T.styleVariants?.[0]?.code||"");(await o.post("/api/manufacturers/style/create",e,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(await X(),I(!1),F(null),R(null))}catch(e){}finally{z(!1)}}},disabled:!$||P,children:P?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:"sm",className:"me-2"}),l("common.uploading","Uploading...")]}):l("types.ui.uploadImage","Upload Image")})]})]})]}):e.jsx(p,{children:e.jsx(h,{children:e.jsx(x,{color:"info",children:l("styles.selectManufacturerInfo","Please select a manufacturer to view style pictures.")})})})},ce=({manufacturer:s})=>{const{t:t}=r(),l="https://app.nj.contractors",[i,n]=a.useState([]),[c,d]=a.useState(!1),[m,y]=a.useState(null),[N,M]=a.useState(""),[O,W]=a.useState(null),[_,V]=a.useState([]),[G,Y]=a.useState("grid"),[K,J]=a.useState(!1),[X,Z]=a.useState(!1),[ee,se]=a.useState(null),[le,ie]=a.useState({typeName:"",longDescription:"",imageFile:null}),[ne,re]=a.useState(""),[ce,oe]=a.useState(""),[de,me]=a.useState([]),[pe,ue]=a.useState(!1),[ge,he]=a.useState(""),[xe,ye]=a.useState(!1),[je,be]=a.useState(!1),[fe,ve]=a.useState(null),[Ne,Ce]=a.useState(!1),[we,Se]=a.useState(null),[ke,Me]=a.useState([]),[Ie,Te]=a.useState(!1),[Fe,Pe]=a.useState(""),[ze,$e]=a.useState([]),[Re,Ae]=a.useState(""),[De,He]=a.useState(null),[Ee,Be]=a.useState(1),[qe,Ue]=a.useState(50),[Le,Oe]=a.useState(!0),[We,_e]=a.useState(!1),[Ve,Ge]=a.useState(!1),[Ye,Qe]=a.useState({type:"",description:""}),[Ke,Je]=a.useState(!1),[Xe,Ze]=a.useState(!1),[es,ss]=a.useState({oldTypeName:"",newTypeName:""}),[as,ts]=a.useState(!1),[ls,is]=a.useState({open:!1,typeName:""}),[ns,rs]=a.useState(""),cs=a.useCallback(e=>{-1===e.target.src.indexOf("/images/nologo.png")&&-1===e.target.src.indexOf("/default-image.png")&&(e.target.src="/images/nologo.png")},[]),os=a.useCallback(e=>e?.image?`${l}/uploads/types/${e.image}`:"/images/nologo.png",[l]),ds=a.useCallback(async()=>{if(s?.id){d(!0),y(null);try{const e=await o.get(`/api/manufacturers/${s.id}/types-meta`,{});e.data&&Array.isArray(e.data)?n(e.data):n([])}catch(e){y("Failed to load types"),n([])}finally{d(!1)}}},[s?.id]),ms=a.useCallback(async()=>{if(s?.id)try{const e=await o.get(`/api/manufacturers/${s.id}/catalog`,{});e.data&&Array.isArray(e.data)?me(e.data):me([])}catch(e){me([])}},[s?.id]);a.useEffect(()=>{ds(),ms()},[ds,ms]);const ps=a.useMemo(()=>i.filter(e=>{const s=e.type?.toLowerCase().includes(N.toLowerCase())||e.description?.toLowerCase().includes(N.toLowerCase()),a=!ne||de.some(s=>s.type===e.type&&s.style?.toLowerCase().includes(ne.toLowerCase())),t=!ce||e.type?.toLowerCase().includes(ce.toLowerCase());return s&&a&&t}),[i,N,ne,ce,de]),us=a.useMemo(()=>ps.reduce((e,s)=>{const a=s.type||"Unnamed";return e[a]||(e[a]=[]),e[a].push(s),e},{}),[ps]),gs=a.useCallback((e,s)=>{V(s?s=>[...s,e]:s=>s.filter(s=>s!==e))},[]),hs=a.useCallback(e=>{V(e?ps.map(e=>e.id):[])},[ps]),xs=a.useCallback(async({reset:e=!1}={})=>{if(!s?.id)return;const a=e?1:Ee;e?Te(!0):_e(!0);try{const t=(await o.get(`/api/manufacturers/${s.id}/catalog`,{params:{page:a,limit:qe,search:Re||void 0,typeFilter:Fe||void 0,excludeType:fe?.type||void 0,sortBy:"code",sortOrder:"ASC"}})).data;if(t&&Array.isArray(t.catalogData)){!e&&ke&&Array.isArray(ke.catalogData)?Me(e=>({...t,catalogData:[...e?.catalogData||[],...t.catalogData]})):Me(t);const s=t.pagination||{};Oe(s.page<s.totalPages),Be(s.page+1)}else Array.isArray(t)?(Me(t),Oe(!1)):t&&Array.isArray(t.data)?(Me({catalogData:t.data}),Oe(!1)):(Me([]),Oe(!1))}catch(t){Me([]),Oe(!1)}finally{e?Te(!1):_e(!1)}},[s?.id,Ee,qe,Re,Fe,fe?.type,ke]),ys=a.useCallback(e=>{ve(e),be(!0),$e([]),Ae(""),Pe(""),Be(1),Oe(!0),setTimeout(()=>{xs({reset:!0})},100)},[xs]);a.useEffect(()=>{if(!je)return;const e=setTimeout(()=>{Be(1),xs({reset:!0})},300);return()=>clearTimeout(e)},[Re,Fe,fe?.type,je]);const js=a.useCallback(()=>{Ie||We||!Le||xs({reset:!1})},[Ie,We,Le,xs]),bs=a.useCallback(e=>{const s=e.target.files[0];Se(s)},[]),fs=a.useCallback(async()=>{if(fe&&we&&s?.id){Ce(!0);try{const e=new FormData;e.append("typeImage",we),e.append("type",fe.type),e.append("description",fe.description||""),e.append("longDescription",zs[fe.type]??fe.longDescription??""),e.append("manufacturerId",s.id),e.append("catalogId",fe.id);(await o.post("/api/manufacturers/type/create",e,{headers:{"Content-Type":"multipart/form-data"}})).data.success?(await ds(),be(!1),ve(null),Se(null)):y("Failed to upload image")}catch(e){y("Failed to upload image")}finally{Ce(!1)}}},[fe,we,s?.id,ds]),vs=a.useCallback(async()=>{if(0!==_.length&&s?.id){Je(!0);try{(await o.post("/api/manufacturers/bulk-edit-types",{manufacturerId:s.id,itemIds:_,updates:Ye},{})).data.success?(await ds(),Ge(!1),V([]),Qe({type:"",description:""})):y("Failed to update types")}catch(e){y("Failed to update types")}finally{Je(!1)}}},[_,s?.id,Ye,ds]),Ns=a.useCallback(async()=>{if(es.oldTypeName&&es.newTypeName&&s?.id){ts(!0);try{(await o.post("/api/manufacturers/edit-type-name",{manufacturerId:s.id,oldTypeName:es.oldTypeName,newTypeName:es.newTypeName},{})).data.success?(await ds(),Ze(!1),ss({oldTypeName:"",newTypeName:""})):y("Failed to rename type")}catch(e){y("Failed to rename type")}finally{ts(!1)}}},[es.oldTypeName,es.newTypeName,s?.id,ds]),Cs=a.useCallback(async()=>{if(0!==_.length&&s?.id&&ge){ye(!0);try{(await o.post("/api/manufacturers/bulk-change-type",{manufacturerId:s.id,itemIds:_,newType:ge},{})).data.success?(await ds(),await ms(),ue(!1),V([]),he("")):y("Failed to change type category")}catch(e){y("Failed to change type category")}finally{ye(!1)}}},[_,s?.id,ge,ds,ms]),ws=a.useCallback((e,s)=>{$e(a=>s?[...a,e]:a.filter(s=>s!==e))},[]);a.useCallback(e=>{$e(e?ks.map(e=>e.id):[])},[]);const Ss=a.useCallback(async()=>{if(fe&&0!==ze.length&&s?.id){Te(!0);try{(await o.post("/api/manufacturers/assign-items-to-type",{manufacturerId:s.id,itemIds:ze,newType:fe.type},{})).data.success?(await ds(),await ms(),await xs(),$e([]),He({count:ze.length,type:fe.type}),setTimeout(()=>He(null),3e3)):y("Failed to assign items to type")}catch(e){y("Failed to assign items to type")}finally{Te(!1)}}},[fe,ze,s?.id,ds,ms,xs]),ks=a.useMemo(()=>{const e=ke&&Array.isArray(ke.catalogData)?ke.catalogData:Array.isArray(ke)?ke:[];if(!Array.isArray(e))return[];if(!Re&&!Fe)return[];return e.filter(e=>{const s=e.type!==fe?.type,a=!Re||e.description?.toLowerCase().includes(Re.toLowerCase())||e.code?.toLowerCase().includes(Re.toLowerCase())||e.style?.toLowerCase().includes(Re.toLowerCase()),t=!Fe||e.type===Fe;return s&&a&&t})},[ke,Re,Fe,fe]),Ms=a.useCallback(e=>{$e(e?ks.map(e=>e.id):[])},[ks]),Is=a.useMemo(()=>[...new Set(de.map(e=>e.style).filter(Boolean))].sort(),[de]),Ts=a.useMemo(()=>[...new Set(de.map(e=>e.type).filter(Boolean))].sort(),[de]),[Fs,Ps]=a.useState(null),[zs,$s]=a.useState({}),Rs=a.useCallback(async e=>{if(!s?.id)return;const a=zs[e]??"";Ps(e);try{const t=await o.post("/api/manufacturers/type/update-meta",{manufacturerId:s.id,type:e,longDescription:a});t.data?.success&&await ds()}catch(l){y(t("types.meta.saveFailed","Failed to save description"))}finally{Ps(null)}},[s?.id,zs,ds,t]);return s?c?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:e.jsx(L,{color:"primary"})}):e.jsxs("div",{children:[e.jsx("style",{children:"\n        .overlay-action-btn { min-width: 44px; min-height: 44px; display: inline-flex; align-items: center; justify-content: center; }\n        @media (max-width: 576px) { .overlay-action-btn { padding: 8px 10px !important; } }\n      "}),e.jsxs(p,{children:[e.jsx(u,{className:"bg-light border-bottom",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0 fw-bold text-primary",children:t("types.ui.header","Type Pictures & Management")}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(g,{color:"success",size:"sm",onClick:()=>{ie({typeName:"",longDescription:"",imageFile:null}),se(null),J(!0)},children:t("types.ui.createType","Create Type")}),e.jsx(g,{color:"primary",size:"sm",onClick:()=>Y("grid"===G?"table":"grid"),children:"grid"===G?t("types.ui.tableView","Table View"):t("types.ui.gridView","Grid View")}),_.length>0&&e.jsxs($,{children:[e.jsxs(R,{color:"secondary",size:"sm",children:[t("types.ui.actions","Actions")," (",_.length,")"]}),e.jsxs(A,{children:[e.jsx(D,{onClick:()=>Ge(!0),children:"Bulk Edit"}),e.jsx(D,{onClick:()=>{const e=i.find(e=>_.includes(e.id));e&&(ss({oldTypeName:e.type,newTypeName:""}),Ze(!0))},children:"Rename Type Globally"})]})]})]})]})}),e.jsxs(h,{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(f,{className:"fw-semibold text-dark mb-2",children:t("types.ui.searchLabel","Search Types")}),e.jsxs(S,{size:"lg",children:[e.jsx(k,{className:"bg-primary text-white",children:e.jsx("i",{className:"bi bi-search"})}),e.jsx(v,{placeholder:t("types.ui.searchPlaceholder","Search types..."),value:N,onChange:e=>M(e.target.value),className:"form-control-lg"})]})]}),e.jsx("div",{className:"mb-4 p-3 bg-light rounded",children:e.jsxs(j,{className:"g-3",children:[e.jsxs(b,{md:5,children:[e.jsx(f,{className:"fw-semibold text-primary",children:t("types.ui.filterByStyle","Filter by Style")}),e.jsx(v,{placeholder:"Filter by style...",value:ne,onChange:e=>re(e.target.value),list:"stylesList",size:"sm",className:"border-primary"}),e.jsx("datalist",{id:"stylesList",children:Is.map(s=>e.jsx("option",{value:s},s))})]}),e.jsxs(b,{md:5,children:[e.jsx(f,{className:"fw-semibold text-primary",children:t("types.ui.filterByType","Filter by Type")}),e.jsx(v,{placeholder:"Filter by type...",value:ce,onChange:e=>oe(e.target.value),list:"typesList",size:"sm",className:"border-primary"}),e.jsx("datalist",{id:"typesList",children:Ts.map(s=>e.jsx("option",{value:s},s))})]}),e.jsx(b,{md:2,className:"d-flex align-items-end justify-content-center",children:e.jsx(g,{color:"outline-primary",size:"sm",onClick:()=>{re(""),oe(""),M("")},className:"w-100 fw-semibold",children:t("types.ui.clearFilters","Clear Filters")})})]})}),_.length>0&&e.jsx(j,{className:"mb-3",children:e.jsx(b,{children:e.jsxs(x,{color:"info",children:[_.length," item(s) selected",e.jsxs("div",{className:"mt-2",children:[e.jsx(g,{color:"primary",size:"sm",onClick:()=>ue(!0),className:"me-2",children:"Change Type Category"}),e.jsx(g,{color:"warning",size:"sm",onClick:()=>Ge(!0),className:"me-2",children:"Bulk Edit"}),e.jsx(g,{color:"secondary",size:"sm",onClick:()=>V([]),children:"Clear Selection"})]})]})})}),m&&e.jsx(x,{color:"danger",dismissible:!0,onClose:()=>y(null),children:m}),"grid"===G?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 p-3 bg-primary bg-opacity-10 rounded border border-primary border-opacity-25",children:e.jsx(C,{id:"selectAll",label:`Select All (${ps.length} types)`,checked:_.length===ps.length&&ps.length>0,onChange:e=>hs(e.target.checked),className:"fw-semibold text-primary",style:{fontSize:"1.1rem"}})}),0===Object.keys(us).length?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("i",{className:"bi bi-images",style:{fontSize:"3rem",color:"#6c757d"}}),e.jsx("h5",{className:"mt-3 text-muted",children:t("types.ui.noTypesFound","No types found")}),e.jsx("p",{className:"text-muted",children:N?t("types.ui.tryAdjust","Try adjusting your search criteria"):t("types.ui.typesWillAppear","Types will appear here when available")})]}):e.jsx("div",{className:"row g-2",children:Object.entries(us).map(([s,a])=>e.jsxs("div",{className:"col-12 col-md-6 col-lg-4 col-xl-3 mb-3",children:[e.jsx("div",{className:"mb-2",children:e.jsx("h6",{className:"fw-bold text-primary mb-2",style:{fontSize:"0.95rem"},children:s})}),e.jsx("div",{className:"row g-2",children:a.map(s=>e.jsx("div",{className:"col-4 col-md-3 col-lg-2 col-xl-2",children:e.jsxs("div",{className:"card h-100 border-0",style:{backgroundColor:"#f8f9fa",aspectRatio:"1",minHeight:"220px"},children:[e.jsxs("div",{className:"position-relative flex-grow-1 d-flex align-items-center justify-content-center p-2",style:{cursor:"pointer"},onMouseEnter:()=>W(s.id),onMouseLeave:()=>W(null),children:[e.jsx("img",{src:os(s),alt:s.type,style:{width:"100%",height:"120px",objectFit:"contain",backgroundColor:"#ffffff",borderRadius:"4px"},onError:cs}),e.jsxs("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{backgroundColor:"rgba(0, 0, 0, 0.6)",color:"#fff",opacity:O===s.id?1:0,transition:"opacity 0.3s ease",fontSize:"0.75rem",fontWeight:"500",borderRadius:"8px"},children:[e.jsxs(g,{color:"light",size:"sm",className:"overlay-action-btn","aria-label":t("types.meta.editType","Edit Type"),onClick:e=>{e.stopPropagation(),ys(s)},style:{fontSize:"0.75rem"},children:[e.jsx(ae,{size:18,"aria-hidden":"true",className:"me-1"})," ",t("types.meta.editType","Edit Type")]}),e.jsx(g,{color:"danger",size:"sm",className:"ms-2 overlay-action-btn","aria-label":t("common.delete","Delete"),onClick:e=>{e.stopPropagation(),is({open:!0,typeName:s.type}),rs("")},style:{fontSize:"0.75rem"},children:e.jsx(te,{size:18,"aria-hidden":"true"})})]})]}),e.jsxs("div",{className:"px-2 pt-2",children:[e.jsx("div",{className:"small text-muted",style:{minHeight:"2.5em"},children:s.longDescription||t("types.meta.descriptionPlaceholder","Add a description for this type")}),e.jsx("div",{className:"d-flex justify-content-end align-items-center mt-2",children:e.jsx(C,{id:`type-${s.id}`,checked:_.includes(s.id),onChange:e=>gs(s.id,e.target.checked),style:{transform:"scale(1.2)"}})})]})]})},s.id))})]},s))})]}):e.jsxs(I,{hover:!0,responsive:!0,children:[e.jsx(T,{children:e.jsxs(F,{children:[e.jsx(E,{children:e.jsx(C,{id:"selectAllTable",checked:_.length===ps.length&&ps.length>0,onChange:e=>hs(e.target.checked)})}),e.jsx(E,{children:"Image"}),e.jsx(E,{children:"Type"}),e.jsx(E,{children:"Description"}),e.jsx(E,{children:"Actions"})]})}),e.jsx(z,{children:ps.map(s=>e.jsxs(F,{children:[e.jsx(P,{children:e.jsx(C,{id:`table-type-${s.id}`,checked:_.includes(s.id),onChange:e=>gs(s.id,e.target.checked)})}),e.jsx(P,{children:e.jsx("img",{src:os(s),alt:s.type,style:{width:"40px",height:"40px",objectFit:"contain",backgroundColor:"#f8f9fa",borderRadius:"4px"},onError:cs})}),e.jsx(P,{children:e.jsx(H,{color:"secondary",children:s.type})}),e.jsx(P,{children:s.description||"No description"}),e.jsx(P,{children:e.jsx(g,{color:"primary",size:"sm","aria-label":t("types.meta.editType","Edit Type"),onClick:()=>ys(s),children:e.jsx(ae,{size:18,"aria-hidden":"true"})})})]},s.id))})]})]})]}),e.jsx("style",{children:"\n        .no-gradient-modal .modal-header {\n          background: #fff !important;\n          border-bottom: 1px solid #dee2e6 !important;\n          color: #212529 !important;\n        }\n        .no-gradient-modal .modal-title {\n          color: #212529 !important;\n        }\n      "}),e.jsxs(B,{visible:je,onClose:()=>{be(!1),ve(null),Se(null)},size:"xl",className:"no-gradient-modal",children:[e.jsx(Q,{title:"Edit Type"}),e.jsx(q,{children:fe&&e.jsxs(j,{children:[e.jsxs(b,{md:6,children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("strong",{children:[t("types.meta.type","Type"),":"]})," ",fe.type]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h6",{children:[t("types.meta.currentImage","Current Image"),":"]}),e.jsx("div",{className:"d-flex justify-content-center p-3 border rounded",style:{backgroundColor:"#f8f9fa"},children:e.jsx("img",{src:os(fe),alt:fe.type,style:{maxWidth:"200px",maxHeight:"200px",objectFit:"contain",border:"1px solid #dee2e6",borderRadius:"4px"},onError:cs})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(f,{htmlFor:"imageUpload",children:[t("types.meta.uploadNewImage","Upload New Image"),":"]}),e.jsx("input",{type:"file",id:"imageUpload",className:"form-control",accept:"image/*",onChange:bs}),e.jsx("div",{className:"mt-2 text-muted",children:we?e.jsxs(e.Fragment,{children:[t("types.ui.selected","Selected"),": ",we.name]}):fe.image?e.jsxs(e.Fragment,{children:["Current: ",fe.image]}):e.jsx(e.Fragment,{children:t("types.ui.noImage","No image uploaded")})})]}),we&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{children:[t("types.meta.newImagePreview","New Image Preview"),":"]}),e.jsx("div",{className:"d-flex justify-content-center p-3 border rounded",style:{backgroundColor:"#f8f9fa"},children:e.jsx("img",{src:URL.createObjectURL(we),alt:"Preview",style:{maxWidth:"200px",maxHeight:"200px",objectFit:"contain",border:"1px solid #dee2e6",borderRadius:"4px"}})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(f,{children:t("types.meta.descriptionLabel","Type Description")}),e.jsx(w,{rows:3,placeholder:t("types.meta.descriptionPlaceholder","Add a description for this type"),value:zs[fe.type]??fe.longDescription??"",onChange:e=>$s(s=>({...s,[fe.type]:e.target.value}))}),e.jsx("div",{className:"mt-2 d-flex gap-2",children:e.jsx(g,{size:"sm",color:"primary",disabled:Fs===fe.type,onClick:()=>Rs(fe.type),children:Fs===fe.type?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:"sm",className:"me-2"}),t("common.saving","Saving...")]}):t("common.save","Save")})})]})]}),e.jsx(b,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"fw-bold text-primary",children:t("types.assign.header","Assign Catalog Items to This Type")}),e.jsx("p",{className:"text-muted small mb-3",children:t("types.assign.help",'Select catalog items from this manufacturer to assign them to the "{{type}}" type.',{type:fe.type})}),e.jsxs(S,{className:"mb-3",size:"sm",children:[e.jsx(k,{children:e.jsx("i",{className:"bi bi-search"})}),e.jsx(v,{placeholder:t("common.searchItems","Search items..."),value:Re,onChange:e=>Ae(e.target.value)})]}),e.jsx(v,{placeholder:t("types.assign.filterByCurrentType","Filter by current type..."),value:Fe,onChange:e=>Pe(e.target.value),size:"sm",className:"mb-3"}),ke?.filters?.uniqueTypes?.length&&e.jsxs("div",{className:"mb-3",children:[e.jsx("small",{className:"text-muted",children:t("types.assign.filterByType","Filter by type:")}),e.jsx("div",{className:"d-flex flex-wrap gap-1 mt-1",children:ke.filters.uniqueTypes.filter(e=>e&&e!==fe?.type).slice(0,40).map((s,a)=>e.jsx("span",{className:"badge bg-secondary",style:{cursor:"pointer"},onClick:()=>Pe(s),children:s},a))})]}),e.jsx("div",{className:"mb-3 p-2 bg-light rounded",children:e.jsx(C,{id:"selectAllModal",label:`${t("common.selectAll","Select All")} (${ks.length} ${t("common.items","items")})`,checked:ze.length===ks.length&&ks.length>0,onChange:e=>Ms(e.target.checked),className:"fw-semibold"})}),e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:Ie?e.jsxs("div",{className:"text-center py-3",children:[e.jsx(L,{size:"sm",className:"me-2"}),t("types.assign.loading","Loading catalog items...")]}):Re||Fe?0===ks.length?e.jsx("div",{className:"text-center py-3 text-muted",children:ke?.catalogData?.length>0?Re||Fe?t("types.assign.noMatch","No items match your search criteria"):t("types.assign.noneAvailable",'No items available to assign (all items already belong to "{{type}}" or other types)',{type:fe?.type}):t("types.assign.noCatalog","No catalog items found for this manufacturer")}):e.jsxs(e.Fragment,{children:[ks.map(s=>e.jsx("div",{className:"border rounded p-2 mb-2 bg-white",role:"button",tabIndex:0,style:{cursor:"pointer"},onClick:()=>ws(s.id,!ze.includes(s.id)),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),ws(s.id,!ze.includes(s.id)))},children:e.jsx(C,{id:`modal-item-${s.id}`,checked:ze.includes(s.id),onChange:e=>ws(s.id,e.target.checked),onClick:e=>e.stopPropagation(),label:e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:s.description}),e.jsxs("div",{className:"text-muted small",children:[t("types.assign.currentType","Current Type"),": ",s.type||t("common.none","None")," | ",t("common.style","Style"),": ",s.style||t("common.none","None")]})]})})},s.id)),Le&&(Re||Fe)&&e.jsx("div",{className:"text-center py-2",children:e.jsx(g,{size:"sm",color:"light",disabled:We,onClick:js,children:We?t("common.loading","Loadingâ€¦"):t("common.loadMore","Load more")})})]}):e.jsx("div",{className:"text-center py-3 text-muted",children:t("types.assign.startHint","Type a search term or click a type badge to load items.")})}),ze.length>0&&e.jsx("div",{className:"mt-3",children:e.jsx(g,{color:"success",size:"sm",onClick:Ss,disabled:Ie,className:"w-100",children:t("types.assign.assignCTA",'Assign {{count}} item(s) to "{{type}}"',{count:ze.length,type:fe.type})})})]})})]})}),De&&e.jsx(x,{color:"success",className:"mb-3",children:t("types.assign.assignedSuccess","Successfully assigned {{count}} items to {{type}}",{count:De.count,type:De.type})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>{be(!1),ve(null),Se(null),$e([]),Ae(""),Pe("")},children:t("common.cancel","Cancel")}),e.jsx(g,{color:"primary",onClick:fs,disabled:!we||Ne,children:Ne?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:"sm",className:"me-2"}),t("common.uploading","Uploading...")]}):t("types.assign.uploadImage","Upload Image")})]})]}),e.jsxs(B,{visible:ls.open,onClose:()=>is({open:!1,typeName:""}),className:"no-gradient-modal",children:[e.jsx(Q,{title:t("types.delete.header","Delete Type")}),e.jsxs(q,{children:[e.jsxs("p",{children:[t("types.delete.confirm","Delete type")," ",e.jsx("strong",{children:ls.typeName}),"?"]}),e.jsx(f,{children:t("types.delete.reassign","Reassign items to (leave empty to clear)")}),e.jsx(v,{value:ns,onChange:e=>rs(e.target.value),placeholder:t("types.delete.reassignPh","New type name or blank")})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>is({open:!1,typeName:""}),children:t("common.cancel","Cancel")}),e.jsx(g,{color:"danger",onClick:async()=>{try{await o.delete(`/api/manufacturers/${s.id}/type/${encodeURIComponent(ls.typeName)}`,{data:{reassignTo:ns}}),await ds(),await ms()}catch(e){}finally{is({open:!1,typeName:""}),rs("")}},children:t("common.delete","Delete")})]})]}),e.jsxs(B,{visible:K,onClose:()=>J(!1),className:"no-gradient-modal",children:[e.jsx(Q,{title:t("types.create.header","Create New Type")}),e.jsxs(q,{children:[ee&&e.jsx(x,{color:"danger",dismissible:!0,onClose:()=>se(null),children:ee}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:t("types.create.typeName","Type Name")}),e.jsx(v,{value:le.typeName,onChange:e=>ie(s=>({...s,typeName:e.target.value})),placeholder:t("types.create.typeNamePh","e.g., Base Drawer Cabinet")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:t("types.create.description","Description")}),e.jsx(w,{rows:3,value:le.longDescription,onChange:e=>ie(s=>({...s,longDescription:e.target.value})),placeholder:t("types.meta.descriptionPlaceholder","Add a description for this type")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:t("types.create.image","Image (optional)")}),e.jsx("input",{type:"file",accept:"image/*",className:"form-control",onChange:e=>ie(s=>({...s,imageFile:e.target.files?.[0]||null}))}),le.imageFile&&e.jsxs("div",{className:"small text-muted mt-1",children:[t("types.ui.selected","Selected"),": ",le.imageFile.name]})]}),e.jsx("div",{className:"alert alert-info small",children:t("types.create.note","Note: If this manufacturer has no catalog items yet, you will need to upload a catalog before creating type metadata.")})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>J(!1),disabled:X,children:t("common.cancel","Cancel")}),e.jsx(g,{color:"primary",disabled:X||!le.typeName.trim(),onClick:async()=>{if(s?.id){Z(!0),se(null);try{const e=await o.post("/api/manufacturers/type/update-meta",{manufacturerId:s.id,type:le.typeName.trim(),longDescription:le.longDescription||""});if(!e.data?.success)throw new Error(e.data?.message||"Failed to save type metadata");if(le.imageFile){const e=new FormData;e.append("typeImage",le.imageFile),e.append("type",le.typeName.trim()),e.append("manufacturerId",s.id),e.append("longDescription",le.longDescription||""),await o.post("/api/manufacturers/type/create",e,{headers:{"Content-Type":"multipart/form-data"}})}await ds(),J(!1)}catch(e){se(e?.response?.data?.message||e?.message||"Failed to create type")}finally{Z(!1)}}},children:X?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:"sm",className:"me-2"}),t("common.saving","Saving...")]}):t("types.create.createCta","Create Type")})]})]}),e.jsxs(B,{visible:Ve,onClose:()=>Ge(!1),size:"lg",className:"no-gradient-modal",children:[e.jsx(Q,{title:`Bulk Edit ${_.length} Types`}),e.jsx(q,{children:e.jsxs("div",{children:[e.jsxs("p",{children:["Edit the following fields for the selected ",_.length," types. Leave fields empty to keep existing values."]}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx(f,{children:"Type"}),e.jsx(v,{type:"text",value:Ye.type,onChange:e=>Qe({...Ye,type:e.target.value}),placeholder:"Leave empty to keep existing"})]}),e.jsxs("div",{className:"col-12",children:[e.jsx(f,{children:"Description"}),e.jsx(w,{value:Ye.description,onChange:e=>Qe({...Ye,description:e.target.value}),placeholder:"Leave empty to keep existing",rows:3})]})]}),e.jsx("div",{className:"mt-3 p-3 bg-light rounded",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("strong",{children:"Note:"})," Only the fields you fill will be updated. Empty fields will preserve the existing values for each item."]})})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>Ge(!1),disabled:Ke,children:"Cancel"}),e.jsx(g,{color:"primary",onClick:vs,disabled:Ke,children:Ke?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:"sm",className:"me-2"}),"Updating ",_.length," Types..."]}):`Update ${_.length} Types`})]})]}),e.jsxs(B,{visible:Xe,onClose:()=>Ze(!1),className:"no-gradient-modal",children:[e.jsx(Q,{title:"Rename Type Globally"}),e.jsx(q,{children:e.jsxs("div",{children:[e.jsx("p",{children:"Rename the type for all items of this manufacturer. This will affect all catalog items currently using this type."}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:"Current Type Name"}),e.jsx(v,{type:"text",value:es.oldTypeName,disabled:!0,className:"bg-light"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{children:"New Type Name"}),e.jsx(v,{type:"text",value:es.newTypeName,onChange:e=>ss({...es,newTypeName:e.target.value}),placeholder:"Enter new type name"})]}),e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("strong",{children:"Warning:"})," This will rename the type globally for all items in this manufacturer's catalog."]})]})}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>Ze(!1),disabled:as,children:"Cancel"}),e.jsx(g,{color:"primary",onClick:Ns,disabled:as||!es.newTypeName.trim(),children:as?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:"sm",className:"me-2"}),"Renaming..."]}):"Rename Type"})]})]}),e.jsxs(B,{visible:pe,onClose:()=>{ue(!1),he("")},className:"no-gradient-modal",children:[e.jsx(Q,{title:"Change Type Category"}),e.jsxs(q,{children:[e.jsxs("p",{children:["Change the type category for ",_.length," selected item(s)."]}),e.jsx(f,{children:"New Type Category"}),e.jsx(v,{placeholder:"Enter new type category...",value:ge,onChange:e=>he(e.target.value),list:"existingTypesList"}),e.jsx("datalist",{id:"existingTypesList",children:Ts.map(s=>e.jsx("option",{value:s},s))}),e.jsx("small",{className:"text-muted",children:"You can enter a new type category or select from existing ones."})]}),e.jsxs(U,{children:[e.jsx(g,{color:"secondary",onClick:()=>{ue(!1),he("")},disabled:xe,children:"Cancel"}),e.jsx(g,{color:"primary",onClick:Cs,disabled:xe||!ge.trim(),children:xe?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:"sm",className:"me-2"}),"Changing..."]}):"Change Type Category"})]})]})]}):e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:e.jsx(x,{color:"warning",children:"Please select a manufacturer to view types."})})},oe=({manufacturer:s})=>{const{t:a}=r(),t=s?.catalogFiles||[];return e.jsxs("div",{children:[e.jsx("h5",{className:"mb-3",children:a("settings.manufacturers.filesHistory.title")}),0===t.length?e.jsx("p",{className:"text-muted",children:a("settings.manufacturers.filesHistory.empty")}):e.jsx("div",{className:"table-wrap",children:e.jsxs(I,{hover:!0,responsive:!0,className:"table-modern",children:[e.jsx(T,{children:e.jsxs(F,{children:[e.jsx(E,{scope:"col",children:a("settings.manufacturers.filesHistory.table.index")}),e.jsx(E,{scope:"col",children:a("settings.manufacturers.filesHistory.table.originalName")}),e.jsx(E,{scope:"col",children:a("settings.manufacturers.filesHistory.table.filename")}),e.jsx(E,{scope:"col",children:a("settings.manufacturers.filesHistory.table.sizeKb")}),e.jsx(E,{scope:"col",children:a("settings.manufacturers.filesHistory.table.uploadedOn")}),e.jsx(E,{scope:"col",children:a("settings.manufacturers.filesHistory.table.download")})]})}),e.jsx(z,{children:t.map((s,t)=>e.jsxs(F,{children:[e.jsx(P,{children:t+1}),e.jsx(P,{className:"text-break",children:s.original_name}),e.jsx(P,{className:"text-break",children:s.filename}),e.jsx(P,{children:(s.file_size/1024).toFixed(2)}),e.jsx(P,{children:new Date(s.createdAt).toLocaleString()}),e.jsx(P,{children:e.jsx("a",{href:`https://app.nj.contractors/uploads/manufacturer_catalogs/${s.filename}`,target:"_blank",rel:"noopener noreferrer","aria-label":`${a("settings.manufacturers.filesHistory.table.download")} ${s.original_name}`,children:a("settings.manufacturers.filesHistory.table.download")})})]},s.id))})]})})]})},de=()=>{const{id:s}=l(),t=K(s),c=i(),[o,m]=a.useState(0),p=n(e=>e.manufacturers.selected),{t:u}=r();return a.useEffect(()=>{t&&c(d({id:t,includeCatalog:!1}))},[t,c]),e.jsxs("div",{className:"edit-manufacturer-page",children:[e.jsx("style",{children:"\n        .edit-manufacturer-page .manufacturer-tabs .nav-link { min-height: 44px; }\n        .edit-manufacturer-page .manufacturer-tabs .nav-link { border-radius: 8px; }\n        @media (max-width: 576px) {\n          .edit-manufacturer-page .manufacturer-tabs.nav {\n            display: grid;\n            grid-template-columns: repeat(2, 1fr);\n            gap: 8px;\n          }\n          .edit-manufacturer-page .manufacturer-tabs.nav .nav-item { width: 100%; }\n          .edit-manufacturer-page .manufacturer-tabs.nav .nav-link { width: 100%; text-align: center; padding: 10px 12px !important; }\n        }\n      "}),e.jsxs(O,{variant:"tabs",role:"tablist",className:"manufacturer-tabs border-bottom-0 mb-0",children:[e.jsx(W,{children:e.jsx(_,{style:{cursor:"pointer",padding:"12px 20px",fontSize:"0.95rem",fontWeight:"500"},active:0===o,onClick:()=>m(0),className:0===o?"bg-primary text-white border-primary":"text-primary border-light",children:u("settings.manufacturers.tabs.editDetails","Edit Manufacturer Details")})}),e.jsx(W,{children:e.jsx(_,{style:{cursor:"pointer",padding:"12px 20px",fontSize:"0.95rem",fontWeight:"500"},active:1===o,onClick:()=>m(1),className:1===o?"bg-primary text-white border-primary":"text-primary border-light",children:u("settings.manufacturers.tabs.settings","Settings")})}),e.jsx(W,{children:e.jsx(_,{style:{cursor:"pointer",padding:"12px 20px",fontSize:"0.95rem",fontWeight:"500"},active:2===o,onClick:()=>m(2),className:2===o?"bg-primary text-white border-primary":"text-primary border-light",children:u("settings.manufacturers.tabs.catalogMapping","Catalog Mapping")})}),e.jsx(W,{children:e.jsx(_,{style:{cursor:"pointer",padding:"12px 20px",fontSize:"0.95rem",fontWeight:"500"},active:3===o,onClick:()=>m(3),className:3===o?"bg-primary text-white border-primary":"text-primary border-light",children:u("settings.manufacturers.tabs.stylePictures","Style Pictures")})}),e.jsx(W,{children:e.jsx(_,{style:{cursor:"pointer",padding:"12px 20px",fontSize:"0.95rem",fontWeight:"500"},active:4===o,onClick:()=>m(4),className:4===o?"bg-primary text-white border-primary":"text-primary border-light",children:u("settings.manufacturers.tabs.typePictures","Type Pictures")})}),e.jsx(W,{children:e.jsx(_,{style:{cursor:"pointer",padding:"12px 20px",fontSize:"0.95rem",fontWeight:"500"},active:5===o,onClick:()=>m(5),className:5===o?"bg-primary text-white border-primary":"text-primary border-light",children:u("settings.manufacturers.tabs.filesHistory","Files & History")})})]}),e.jsxs(V,{className:"mt-4",children:[e.jsx(G,{visible:0===o,children:e.jsx(le,{manufacturer:p,id:t})}),e.jsx(G,{visible:1===o,children:e.jsx(ie,{manufacturer:p})}),e.jsx(G,{visible:2===o,children:e.jsx(ne,{manufacturer:p,id:t})}),e.jsx(G,{visible:3===o,children:e.jsx(re,{manufacturer:p})}),e.jsx(G,{visible:4===o,children:e.jsx(ce,{manufacturer:p})}),e.jsx(G,{visible:5===o,children:e.jsx(oe,{manufacturer:p})})]})]})};export{de as default};
