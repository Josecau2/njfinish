import{j as s}from"./date-vendor-D9pAgX5F.js";import{u as e,r}from"./react-vendor-DF7UJAlN.js";import{u as t,a}from"./redux-vendor-BzdbewH4.js";import{u as n,H as o,P as i}from"./index-DW-yAxzW.js";import{g as d,b as c}from"./DefaultLayout-BUcG_pV2.js";import{h as l,C as m,a as u,U as p,V as x,b as h,c as j,e as g,d as b,$ as f,a0 as y,a1 as N,a2 as v,a3 as G,a4 as w,v as $,a8 as z}from"./ui-vendor-DjmSPU99.js";import{j as A,P as k,a as S}from"./icons-vendor-D82TZqJV.js";import"./form-vendor-CKNVq0c_.js";import"./utils-vendor-Nl-sF5xe.js";const C=()=>{const{t:C}=n(),_=t(),U=e(),{allGroups:D=[],loading:E,error:H}=a(s=>s.usersGroup||{}),I=D,[J,L]=r.useState(null);r.useEffect(()=>{_(o())},[_]);const O=s=>{const e=`/${d(6)}/${d(8)}`+c("/settings/users/group/edit/:id",{id:s});U(e)},P=(e,r)=>{let t;if("string"==typeof e.modules)try{t=JSON.parse(e.modules)}catch(o){t={dashboard:!1,proposals:!1,customers:!1,resources:!1}}else t=e.modules||{dashboard:!1,proposals:!1,customers:!1,resources:!1};const a=!0===t[r],n=J===`${e.id}-${r}`;return s.jsx(z,{id:`${e.id}-${r}`,checked:a,disabled:"contractor"!==e.group_type||n,onChange:()=>(async(s,e,r)=>{L(`${s}-${e}`);try{let t;if("string"==typeof r)try{t=JSON.parse(r)}catch(o){t={dashboard:!1,proposals:!1,customers:!1,resources:!1}}else t=r||{dashboard:!1,proposals:!1,customers:!1,resources:!1};const a={...t,[e]:!t[e]};await _(i({id:s,data:{modules:a}})).unwrap()}catch(t){}finally{L(null)}})(e.id,r,t),label:n?s.jsx(m,{size:"sm"}):"",size:"sm"})};return E?s.jsx(l,{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(m,{}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading user groups..."})]})}):H?s.jsx(l,{children:s.jsxs(u,{color:"danger",children:[s.jsx("strong",{children:"Error loading user groups:"})," ",H.message||H.toString()||"Unknown error"]})}):s.jsx(p,{children:s.jsx(x,{xs:12,children:s.jsxs(h,{className:"mb-4",children:[s.jsxs(j,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("strong",{className:"d-flex align-items-center gap-2",children:[s.jsx(A,{size:18,"aria-hidden":"true"}),C("settings.userGroups.header")]}),s.jsxs(g,{color:"primary",onClick:()=>{U("/settings/users/group/create")},className:"d-flex align-items-center gap-2",children:[s.jsx(k,{size:16,"aria-hidden":"true"}),C("settings.userGroups.actions.create")]})]}),s.jsxs(b,{children:[H&&s.jsxs(u,{color:"danger",className:"mb-3",children:[C("settings.userGroups.loadFailed"),": ",H.message||H.toString()||C("common.error")]}),s.jsx("div",{className:"d-none d-md-block table-wrap",children:s.jsxs(f,{hover:!0,responsive:!0,className:"table-modern",children:[s.jsx(y,{children:s.jsxs(N,{children:[s.jsx(v,{children:C("settings.userGroups.table.name")}),s.jsx(v,{children:C("settings.userGroups.table.type")}),s.jsx(v,{children:C("contractorsAdmin.modules.dashboard")}),s.jsx(v,{children:C("contractorsAdmin.modules.proposals")}),s.jsx(v,{children:C("contractorsAdmin.modules.customers")}),s.jsx(v,{children:C("contractorsAdmin.modules.resources")}),s.jsx(v,{children:C("settings.userGroups.table.actions")})]})}),s.jsx(G,{children:0===I.length?s.jsx(N,{children:s.jsx(w,{colSpan:"7",className:"text-center py-4",children:C("settings.userGroups.empty")})},"empty-state"):I.map(e=>s.jsxs(N,{children:[s.jsxs(w,{children:[s.jsx("strong",{children:e.name||"Unnamed Group"}),!e.name&&s.jsxs("small",{className:"text-muted d-block",children:["ID: ",e.id]})]}),s.jsx(w,{children:s.jsx($,{color:"contractor"===e.group_type?"info":"secondary",shape:"rounded-pill",children:"contractor"===e.group_type?C("settings.userGroups.types.contractor"):C("settings.userGroups.types.standard")})}),s.jsx(w,{children:P(e,"dashboard")}),s.jsx(w,{children:P(e,"proposals")}),s.jsx(w,{children:P(e,"customers")}),s.jsx(w,{children:P(e,"resources")}),s.jsx(w,{children:s.jsx(g,{color:"light",variant:"outline",size:"sm",onClick:()=>O(e.id),className:"icon-btn",title:C("settings.userGroups.actions.edit"),"aria-label":C("settings.userGroups.actions.edit"),style:{border:"1px solid #e3e6f0",borderRadius:"8px"},children:s.jsx(S,{size:16,"aria-hidden":"true"})})})]},e.id))})]})}),s.jsx("div",{className:"d-md-none user-groups-mobile",children:0===I.length?s.jsx("div",{className:"text-center text-muted py-4",children:C("settings.userGroups.empty")}):I.map(e=>s.jsxs("div",{className:"mobile-card mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:e.name||"Unnamed Group"}),!e.name&&s.jsxs("small",{className:"text-muted",children:["ID: ",e.id]})]}),s.jsx($,{color:"contractor"===e.group_type?"info":"secondary",shape:"rounded-pill",children:"contractor"===e.group_type?C("settings.userGroups.types.contractor"):C("settings.userGroups.types.standard")})]}),s.jsxs("div",{className:"row g-2 small",children:[s.jsxs("div",{className:"col-6 d-flex align-items-center justify-content-between",children:[s.jsx("span",{className:"text-muted me-2",children:C("contractorsAdmin.modules.dashboard")}),P(e,"dashboard")]}),s.jsxs("div",{className:"col-6 d-flex align-items-center justify-content-between",children:[s.jsx("span",{className:"text-muted me-2",children:C("contractorsAdmin.modules.proposals")}),P(e,"proposals")]}),s.jsxs("div",{className:"col-6 d-flex align-items-center justify-content-between",children:[s.jsx("span",{className:"text-muted me-2",children:C("contractorsAdmin.modules.customers")}),P(e,"customers")]}),s.jsxs("div",{className:"col-6 d-flex align-items-center justify-content-between",children:[s.jsx("span",{className:"text-muted me-2",children:C("contractorsAdmin.modules.resources")}),P(e,"resources")]})]}),s.jsx("div",{className:"d-flex justify-content-end mt-2",children:s.jsxs(g,{color:"light",variant:"outline",size:"sm",onClick:()=>O(e.id),title:C("settings.userGroups.actions.edit"),"aria-label":C("settings.userGroups.actions.edit"),className:"icon-btn",style:{border:"1px solid #e3e6f0",borderRadius:"8px"},children:[s.jsx(S,{size:16,className:"me-1","aria-hidden":"true"}),C("common.edit")||"Edit"]})})]},`m-${e.id}`))})]})]})})})};export{C as default};
