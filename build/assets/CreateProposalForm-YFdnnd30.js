import{j as e,D as t}from"./date-vendor-DfW9khhA.js";import{r as s,R as n,k as i,u as a}from"./react-vendor-Dhx0OYb2.js";import{c as r,a as o,b as l,P as c,E as d,d as u}from"./EmailContractModal-CRIkYvMY.js";import{h as m,j as h,F as p}from"./form-vendor-C_vzjFiG.js";import{C as f}from"./react-select-creatable.esm-UYqWrhwU.js";import{u as g,w as y,x,a as v,y as b,b as j,z as N,A as w,B as S,C,D as T}from"./index-BxG4qwLs.js";import{h as D,i as P,b as k,d as M}from"./DefaultLayout-CDydDzk1.js";import{u as E,a as A}from"./redux-vendor-B0DAdCYB.js";import{b as V,c as I,d as F,e as R,f as B,g as L}from"./index-DK1ZdOBj.js";import{b as $,d as O,e as U,a3 as z,R as W,S as q,a4 as H,V as Y,a6 as X,a7 as K,N as G,B as _,E as Z,i as Q,l as J,w as ee,m as te,T as se,r as ne,Z as ie,_ as ae,$ as re,a0 as oe,a1 as le,a2 as ce,a8 as de,c as ue,C as me,v as he,o as pe,p as fe,s as ge,u as ye,a as xe,j as ve,k as be,a9 as je,h as Ne}from"./ui-vendor-pFEG3kEv.js";import{S as we}from"./utils-vendor-Nl-sF5xe.js";import{P as Se}from"./PageHeader-UABCfWk-.js";import{c as Ce}from"./cil-trash-CBbKHhHb.js";import{c as Te}from"./cil-home-DjIzczOB.js";import{c as De,a as Pe}from"./cil-chevron-right-DSvcss7_.js";import{c as ke}from"./cil-cloud-upload-Ca9_6_ej.js";import{c as Me}from"./cil-image-CaFvPawJ.js";import{c as Ee}from"./cil-pencil-m516yCOw.js";import{w as Ae}from"./withContractorScope-bbtugTgT.js";import"./editor-vendor-RxX6MBW0.js";import"./ckeditor-BRc8bNm1.js";import"./icons-vendor-CVrEPnlB.js";var Ve=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M334.627,16H48V496H472V153.373ZM440,166.627V168H320V48h1.373ZM80,464V48H288V200H440V464Z' class='ci-primary'/>"],Ie=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M461,132,360,171.277V72H16V440H360V332.723L461,372h35V132Zm3,206.833-136-52.89V408H48V104H328V218.057l136-52.89Z' class='ci-primary'/>"];const Fe=s.createContext({});function Re(e){const t=s.useRef(null);return null===t.current&&(t.current=e()),t.current}const Be="undefined"!=typeof window,Le=Be?s.useLayoutEffect:s.useEffect,$e=s.createContext(null);function Oe(e,t){-1===e.indexOf(t)&&e.push(t)}function Ue(e,t){const s=e.indexOf(t);s>-1&&e.splice(s,1)}const ze=(e,t,s)=>s>t?t:s<e?e:s;const We={},qe=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function He(e){return"object"==typeof e&&null!==e}const Ye=e=>/^0[^.\s]+$/u.test(e);function Xe(e){let t;return()=>(void 0===t&&(t=e()),t)}const Ke=e=>e,Ge=(e,t)=>s=>t(e(s)),_e=(...e)=>e.reduce(Ge),Ze=(e,t,s)=>{const n=t-e;return 0===n?1:(s-e)/n};class Qe{constructor(){this.subscriptions=[]}add(e){return Oe(this.subscriptions,e),()=>Ue(this.subscriptions,e)}notify(e,t,s){const n=this.subscriptions.length;if(n)if(1===n)this.subscriptions[0](e,t,s);else for(let i=0;i<n;i++){const n=this.subscriptions[i];n&&n(e,t,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Je=e=>1e3*e,et=e=>e/1e3;function tt(e,t){return t?e*(1e3/t):0}const st=(e,t,s)=>(((1-3*s+3*t)*e+(3*s-6*t))*e+3*t)*e;function nt(e,t,s,n){if(e===t&&s===n)return Ke;const i=t=>function(e,t,s,n,i){let a,r,o=0;do{r=t+(s-t)/2,a=st(r,n,i)-e,a>0?s=r:t=r}while(Math.abs(a)>1e-7&&++o<12);return r}(t,0,1,e,s);return e=>0===e||1===e?e:st(i(e),t,n)}const it=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,at=e=>t=>1-e(1-t),rt=nt(.33,1.53,.69,.99),ot=at(rt),lt=it(ot),ct=e=>(e*=2)<1?.5*ot(e):.5*(2-Math.pow(2,-10*(e-1))),dt=e=>1-Math.sin(Math.acos(e)),ut=at(dt),mt=it(dt),ht=nt(.42,0,1,1),pt=nt(0,0,.58,1),ft=nt(.42,0,.58,1),gt=e=>Array.isArray(e)&&"number"==typeof e[0],yt={linear:Ke,easeIn:ht,easeInOut:ft,easeOut:pt,circIn:dt,circInOut:mt,circOut:ut,backIn:ot,backInOut:lt,backOut:rt,anticipate:ct},xt=e=>{if(gt(e)){e.length;const[t,s,n,i]=e;return nt(t,s,n,i)}return"string"==typeof e?yt[e]:e},vt=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function bt(e,t){let s=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>s=!0,r=vt.reduce((e,t)=>(e[t]=function(e){let t=new Set,s=new Set,n=!1,i=!1;const a=new WeakSet;let r={delta:0,timestamp:0,isProcessing:!1};function o(t){a.has(t)&&(l.schedule(t),e()),t(r)}const l={schedule:(e,i=!1,r=!1)=>{const o=r&&n?t:s;return i&&a.add(e),o.has(e)||o.add(e),e},cancel:e=>{s.delete(e),a.delete(e)},process:e=>{r=e,n?i=!0:(n=!0,[t,s]=[s,t],t.forEach(o),t.clear(),n=!1,i&&(i=!1,l.process(e)))}};return l}(a),e),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:d,update:u,preRender:m,render:h,postRender:p}=r,f=()=>{const a=We.useManualTiming?i.timestamp:performance.now();s=!1,We.useManualTiming||(i.delta=n?1e3/60:Math.max(Math.min(a-i.timestamp,40),1)),i.timestamp=a,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),d.process(i),u.process(i),m.process(i),h.process(i),p.process(i),i.isProcessing=!1,s&&t&&(n=!1,e(f))};return{schedule:vt.reduce((t,a)=>{const o=r[a];return t[a]=(t,a=!1,r=!1)=>(s||(s=!0,n=!0,i.isProcessing||e(f)),o.schedule(t,a,r)),t},{}),cancel:e=>{for(let t=0;t<vt.length;t++)r[vt[t]].cancel(e)},state:i,steps:r}}const{schedule:jt,cancel:Nt,state:wt,steps:St}=bt("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:Ke,!0);let Ct;function Tt(){Ct=void 0}const Dt={now:()=>(void 0===Ct&&Dt.set(wt.isProcessing||We.useManualTiming?wt.timestamp:performance.now()),Ct),set:e=>{Ct=e,queueMicrotask(Tt)}},Pt=e=>t=>"string"==typeof t&&t.startsWith(e),kt=Pt("--"),Mt=Pt("var(--"),Et=e=>!!Mt(e)&&At.test(e.split("/*")[0].trim()),At=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Vt={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},It={...Vt,transform:e=>ze(0,1,e)},Ft={...Vt,default:1},Rt=e=>Math.round(1e5*e)/1e5,Bt=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;const Lt=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,$t=(e,t)=>s=>Boolean("string"==typeof s&&Lt.test(s)&&s.startsWith(e)||t&&!function(e){return null==e}(s)&&Object.prototype.hasOwnProperty.call(s,t)),Ot=(e,t,s)=>n=>{if("string"!=typeof n)return n;const[i,a,r,o]=n.match(Bt);return{[e]:parseFloat(i),[t]:parseFloat(a),[s]:parseFloat(r),alpha:void 0!==o?parseFloat(o):1}},Ut={...Vt,transform:e=>Math.round((e=>ze(0,255,e))(e))},zt={test:$t("rgb","red"),parse:Ot("red","green","blue"),transform:({red:e,green:t,blue:s,alpha:n=1})=>"rgba("+Ut.transform(e)+", "+Ut.transform(t)+", "+Ut.transform(s)+", "+Rt(It.transform(n))+")"};const Wt={test:$t("#"),parse:function(e){let t="",s="",n="",i="";return e.length>5?(t=e.substring(1,3),s=e.substring(3,5),n=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),s=e.substring(2,3),n=e.substring(3,4),i=e.substring(4,5),t+=t,s+=s,n+=n,i+=i),{red:parseInt(t,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}},transform:zt.transform},qt=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),Ht=qt("deg"),Yt=qt("%"),Xt=qt("px"),Kt=qt("vh"),Gt=qt("vw"),_t=(()=>({...Yt,parse:e=>Yt.parse(e)/100,transform:e=>Yt.transform(100*e)}))(),Zt={test:$t("hsl","hue"),parse:Ot("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:s,alpha:n=1})=>"hsla("+Math.round(e)+", "+Yt.transform(Rt(t))+", "+Yt.transform(Rt(s))+", "+Rt(It.transform(n))+")"},Qt={test:e=>zt.test(e)||Wt.test(e)||Zt.test(e),parse:e=>zt.test(e)?zt.parse(e):Zt.test(e)?Zt.parse(e):Wt.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?zt.transform(e):Zt.transform(e),getAnimatableNone:e=>{const t=Qt.parse(e);return t.alpha=0,Qt.transform(t)}},Jt=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;const es="number",ts="color",ss=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ns(e){const t=e.toString(),s=[],n={color:[],number:[],var:[]},i=[];let a=0;const r=t.replace(ss,e=>(Qt.test(e)?(n.color.push(a),i.push(ts),s.push(Qt.parse(e))):e.startsWith("var(")?(n.var.push(a),i.push("var"),s.push(e)):(n.number.push(a),i.push(es),s.push(parseFloat(e))),++a,"${}")).split("${}");return{values:s,split:r,indexes:n,types:i}}function is(e){return ns(e).values}function as(e){const{split:t,types:s}=ns(e),n=t.length;return e=>{let i="";for(let a=0;a<n;a++)if(i+=t[a],void 0!==e[a]){const t=s[a];i+=t===es?Rt(e[a]):t===ts?Qt.transform(e[a]):e[a]}return i}}const rs=e=>"number"==typeof e?0:Qt.test(e)?Qt.getAnimatableNone(e):e;const os={test:function(e){return isNaN(e)&&"string"==typeof e&&(e.match(Bt)?.length||0)+(e.match(Jt)?.length||0)>0},parse:is,createTransformer:as,getAnimatableNone:function(e){const t=is(e);return as(e)(t.map(rs))}};function ls(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e}function cs(e,t){return s=>s>0?t:e}const ds=(e,t,s)=>e+(t-e)*s,us=(e,t,s)=>{const n=e*e,i=s*(t*t-n)+n;return i<0?0:Math.sqrt(i)},ms=[Wt,zt,Zt];function hs(e){const t=(s=e,ms.find(e=>e.test(s)));var s;if(!Boolean(t))return!1;let n=t.parse(e);return t===Zt&&(n=function({hue:e,saturation:t,lightness:s,alpha:n}){e/=360,s/=100;let i=0,a=0,r=0;if(t/=100){const n=s<.5?s*(1+t):s+t-s*t,o=2*s-n;i=ls(o,n,e+1/3),a=ls(o,n,e),r=ls(o,n,e-1/3)}else i=a=r=s;return{red:Math.round(255*i),green:Math.round(255*a),blue:Math.round(255*r),alpha:n}}(n)),n}const ps=(e,t)=>{const s=hs(e),n=hs(t);if(!s||!n)return cs(e,t);const i={...s};return e=>(i.red=us(s.red,n.red,e),i.green=us(s.green,n.green,e),i.blue=us(s.blue,n.blue,e),i.alpha=ds(s.alpha,n.alpha,e),zt.transform(i))},fs=new Set(["none","hidden"]);function gs(e,t){return s=>ds(e,t,s)}function ys(e){return"number"==typeof e?gs:"string"==typeof e?Et(e)?cs:Qt.test(e)?ps:bs:Array.isArray(e)?xs:"object"==typeof e?Qt.test(e)?ps:vs:cs}function xs(e,t){const s=[...e],n=s.length,i=e.map((e,s)=>ys(e)(e,t[s]));return e=>{for(let t=0;t<n;t++)s[t]=i[t](e);return s}}function vs(e,t){const s={...e,...t},n={};for(const i in s)void 0!==e[i]&&void 0!==t[i]&&(n[i]=ys(e[i])(e[i],t[i]));return e=>{for(const t in n)s[t]=n[t](e);return s}}const bs=(e,t)=>{const s=os.createTransformer(t),n=ns(e),i=ns(t);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?fs.has(e)&&!i.values.length||fs.has(t)&&!n.values.length?function(e,t){return fs.has(e)?s=>s<=0?e:t:s=>s>=1?t:e}(e,t):_e(xs(function(e,t){const s=[],n={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const a=t.types[i],r=e.indexes[a][n[a]],o=e.values[r]??0;s[i]=o,n[a]++}return s}(n,i),i.values),s):cs(e,t)};function js(e,t,s){if("number"==typeof e&&"number"==typeof t&&"number"==typeof s)return ds(e,t,s);return ys(e)(e,t)}const Ns=e=>{const t=({timestamp:t})=>e(t);return{start:(e=!0)=>jt.update(t,e),stop:()=>Nt(t),now:()=>wt.isProcessing?wt.timestamp:Dt.now()}},ws=(e,t,s=10)=>{let n="";const i=Math.max(Math.round(t/s),2);for(let a=0;a<i;a++)n+=Math.round(1e4*e(a/(i-1)))/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},Ss=2e4;function Cs(e){let t=0;let s=e.next(t);for(;!s.done&&t<Ss;)t+=50,s=e.next(t);return t>=Ss?1/0:t}function Ts(e,t,s){const n=Math.max(t-5,0);return tt(s-e(n),t-n)}const Ds=100,Ps=10,ks=1,Ms=0,Es=800,As=.3,Vs=.3,Is={granular:.01,default:2},Fs={granular:.005,default:.5},Rs=.01,Bs=10,Ls=.05,$s=1,Os=.001;function Us({duration:e=Es,bounce:t=As,velocity:s=Ms,mass:n=ks}){let i,a,r=1-t;r=ze(Ls,$s,r),e=ze(Rs,Bs,et(e)),r<1?(i=t=>{const n=t*r,i=n*e,a=n-s,o=Ws(t,r),l=Math.exp(-i);return Os-a/o*l},a=t=>{const n=t*r*e,a=n*s+s,o=Math.pow(r,2)*Math.pow(t,2)*e,l=Math.exp(-n),c=Ws(Math.pow(t,2),r);return(-i(t)+Os>0?-1:1)*((a-o)*l)/c}):(i=t=>Math.exp(-t*e)*((t-s)*e+1)-.001,a=t=>Math.exp(-t*e)*(e*e*(s-t)));const o=function(e,t,s){let n=s;for(let i=1;i<zs;i++)n-=e(n)/t(n);return n}(i,a,5/e);if(e=Je(e),isNaN(o))return{stiffness:Ds,damping:Ps,duration:e};{const t=Math.pow(o,2)*n;return{stiffness:t,damping:2*r*Math.sqrt(n*t),duration:e}}}const zs=12;function Ws(e,t){return e*Math.sqrt(1-t*t)}const qs=["duration","bounce"],Hs=["stiffness","damping","mass"];function Ys(e,t){return t.some(t=>void 0!==e[t])}function Xs(e=Vs,t=As){const s="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:i}=s;const a=s.keyframes[0],r=s.keyframes[s.keyframes.length-1],o={done:!1,value:a},{stiffness:l,damping:c,mass:d,duration:u,velocity:m,isResolvedFromDuration:h}=function(e){let t={velocity:Ms,stiffness:Ds,damping:Ps,mass:ks,isResolvedFromDuration:!1,...e};if(!Ys(e,Hs)&&Ys(e,qs))if(e.visualDuration){const s=e.visualDuration,n=2*Math.PI/(1.2*s),i=n*n,a=2*ze(.05,1,1-(e.bounce||0))*Math.sqrt(i);t={...t,mass:ks,stiffness:i,damping:a}}else{const s=Us(e);t={...t,...s,mass:ks},t.isResolvedFromDuration=!0}return t}({...s,velocity:-et(s.velocity||0)}),p=m||0,f=c/(2*Math.sqrt(l*d)),g=r-a,y=et(Math.sqrt(l/d)),x=Math.abs(g)<5;let v;if(n||(n=x?Is.granular:Is.default),i||(i=x?Fs.granular:Fs.default),f<1){const e=Ws(y,f);v=t=>{const s=Math.exp(-f*y*t);return r-s*((p+f*y*g)/e*Math.sin(e*t)+g*Math.cos(e*t))}}else if(1===f)v=e=>r-Math.exp(-y*e)*(g+(p+y*g)*e);else{const e=y*Math.sqrt(f*f-1);v=t=>{const s=Math.exp(-f*y*t),n=Math.min(e*t,300);return r-s*((p+f*y*g)*Math.sinh(n)+e*g*Math.cosh(n))/e}}const b={calculatedDuration:h&&u||null,next:e=>{const t=v(e);if(h)o.done=e>=u;else{let s=0===e?p:0;f<1&&(s=0===e?Je(p):Ts(v,e,t));const a=Math.abs(s)<=n,l=Math.abs(r-t)<=i;o.done=a&&l}return o.value=o.done?r:t,o},toString:()=>{const e=Math.min(Cs(b),Ss),t=ws(t=>b.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return b}function Ks({keyframes:e,velocity:t=0,power:s=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:r,min:o,max:l,restDelta:c=.5,restSpeed:d}){const u=e[0],m={done:!1,value:u},h=e=>void 0===o?l:void 0===l||Math.abs(o-e)<Math.abs(l-e)?o:l;let p=s*t;const f=u+p,g=void 0===r?f:r(f);g!==f&&(p=g-u);const y=e=>-p*Math.exp(-e/n),x=e=>g+y(e),v=e=>{const t=y(e),s=x(e);m.done=Math.abs(t)<=c,m.value=m.done?g:s};let b,j;const N=e=>{var t;(t=m.value,void 0!==o&&t<o||void 0!==l&&t>l)&&(b=e,j=Xs({keyframes:[m.value,h(m.value)],velocity:Ts(x,e,m.value),damping:i,stiffness:a,restDelta:c,restSpeed:d}))};return N(0),{calculatedDuration:null,next:e=>{let t=!1;return j||void 0!==b||(t=!0,v(e),N(e)),void 0!==b&&e>=b?j.next(e-b):(!t&&v(e),m)}}}function Gs(e,t,{clamp:s=!0,ease:n,mixer:i}={}){const a=e.length;if(t.length,1===a)return()=>t[0];if(2===a&&t[0]===t[1])return()=>t[1];const r=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=function(e,t,s){const n=[],i=s||We.mix||js,a=e.length-1;for(let r=0;r<a;r++){let s=i(e[r],e[r+1]);if(t){const e=Array.isArray(t)?t[r]||Ke:t;s=_e(e,s)}n.push(s)}return n}(t,n,i),l=o.length,c=s=>{if(r&&s<e[0])return t[0];let n=0;if(l>1)for(;n<e.length-2&&!(s<e[n+1]);n++);const i=Ze(e[n],e[n+1],s);return o[n](i)};return s?t=>c(ze(e[0],e[a-1],t)):c}function _s(e){const t=[0];return function(e,t){const s=e[e.length-1];for(let n=1;n<=t;n++){const i=Ze(0,t,n);e.push(ds(s,1,i))}}(t,e.length-1),t}function Zs({duration:e=300,keyframes:t,times:s,ease:n="easeInOut"}){const i=(e=>Array.isArray(e)&&"number"!=typeof e[0])(n)?n.map(xt):xt(n),a={done:!1,value:t[0]},r=function(e,t){return e.map(e=>e*t)}(s&&s.length===t.length?s:_s(t),e),o=Gs(r,t,{ease:Array.isArray(i)?i:(l=t,c=i,l.map(()=>c||ft).splice(0,l.length-1))});var l,c;return{calculatedDuration:e,next:t=>(a.value=o(t),a.done=t>=e,a)}}Xs.applyToOptions=e=>{const t=function(e,t=100,s){const n=s({...e,keyframes:[0,t]}),i=Math.min(Cs(n),Ss);return{type:"keyframes",ease:e=>n.next(i*e).value/t,duration:et(i)}}(e,100,Xs);return e.ease=t.ease,e.duration=Je(t.duration),e.type="keyframes",e};const Qs=e=>null!==e;function Js(e,{repeat:t,repeatType:s="loop"},n,i=1){const a=e.filter(Qs),r=i<0||t&&"loop"!==s&&t%2==1?0:a.length-1;return r&&void 0!==n?n:a[r]}const en={decay:Ks,inertia:Ks,tween:Zs,keyframes:Zs,spring:Xs};function tn(e){"string"==typeof e.type&&(e.type=en[e.type])}class sn{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const nn=e=>e/100;class an extends sn{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:e}=this.options;e&&e.updatedAt!==Dt.now()&&this.tick(Dt.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;tn(e);const{type:t=Zs,repeat:s=0,repeatDelay:n=0,repeatType:i,velocity:a=0}=e;let{keyframes:r}=e;const o=t||Zs;o!==Zs&&"number"!=typeof r[0]&&(this.mixKeyframes=_e(nn,js(r[0],r[1])),r=[0,100]);const l=o({...e,keyframes:r});"mirror"===i&&(this.mirroredGenerator=o({...e,keyframes:[...r].reverse(),velocity:-a})),null===l.calculatedDuration&&(l.calculatedDuration=Cs(l));const{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+n,this.totalDuration=this.resolvedDuration*(s+1)-n,this.generator=l}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:s,totalDuration:n,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:r,calculatedDuration:o}=this;if(null===this.startTime)return s.next(0);const{delay:l=0,keyframes:c,repeat:d,repeatType:u,repeatDelay:m,type:h,onUpdate:p,finalKeyframe:f}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-n/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?g<0:g>n;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=n);let x=this.currentTime,v=s;if(d){const e=Math.min(this.currentTime,n)/r;let t=Math.floor(e),s=e%1;!s&&e>=1&&(s=1),1===s&&t--,t=Math.min(t,d+1);Boolean(t%2)&&("reverse"===u?(s=1-s,m&&(s-=m/r)):"mirror"===u&&(v=a)),x=ze(0,1,s)*r}const b=y?{done:!1,value:c[0]}:v.next(x);i&&(b.value=i(b.value));let{done:j}=b;y||null===o||(j=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const N=null===this.holdTime&&("finished"===this.state||"running"===this.state&&j);return N&&h!==Ks&&(b.value=Js(c,this.options,f,this.speed)),p&&p(b.value),N&&this.finish(),b}then(e,t){return this.finished.then(e,t)}get duration(){return et(this.calculatedDuration)}get time(){return et(this.currentTime)}set time(e){e=Je(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Dt.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=et(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=Ns,startTime:t}=this.options;this.driver||(this.driver=e(e=>this.tick(e))),this.options.onPlay?.();const s=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=s):null!==this.holdTime?this.startTime=s-this.holdTime:this.startTime||(this.startTime=t??s),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Dt.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}const rn=e=>180*e/Math.PI,on=e=>{const t=rn(Math.atan2(e[1],e[0]));return cn(t)},ln={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:on,rotateZ:on,skewX:e=>rn(Math.atan(e[1])),skewY:e=>rn(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},cn=e=>((e%=360)<0&&(e+=360),e),dn=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),un=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),mn={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:dn,scaleY:un,scale:e=>(dn(e)+un(e))/2,rotateX:e=>cn(rn(Math.atan2(e[6],e[5]))),rotateY:e=>cn(rn(Math.atan2(-e[2],e[0]))),rotateZ:on,rotate:on,skewX:e=>rn(Math.atan(e[4])),skewY:e=>rn(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function hn(e){return e.includes("scale")?1:0}function pn(e,t){if(!e||"none"===e)return hn(t);const s=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,i;if(s)n=mn,i=s;else{const t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=ln,i=t}if(!i)return hn(t);const a=n[t],r=i[1].split(",").map(fn);return"function"==typeof a?a(r):r[a]}function fn(e){return parseFloat(e.trim())}const gn=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yn=(()=>new Set(gn))(),xn=e=>e===Vt||e===Xt,vn=new Set(["x","y","z"]),bn=gn.filter(e=>!vn.has(e));const jn={width:({x:e},{paddingLeft:t="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),height:({y:e},{paddingTop:t="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>pn(t,"x"),y:(e,{transform:t})=>pn(t,"y")};jn.translateX=jn.x,jn.translateY=jn.y;const Nn=new Set;let wn=!1,Sn=!1,Cn=!1;function Tn(){if(Sn){const e=Array.from(Nn).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),s=new Map;t.forEach(e=>{const t=function(e){const t=[];return bn.forEach(s=>{const n=e.getValue(s);void 0!==n&&(t.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),t}(e);t.length&&(s.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=s.get(e);t&&t.forEach(([t,s])=>{e.getValue(t)?.set(s)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}Sn=!1,wn=!1,Nn.forEach(e=>e.complete(Cn)),Nn.clear()}function Dn(){Nn.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Sn=!0)})}class Pn{constructor(e,t,s,n,i,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=s,this.motionValue=n,this.element=i,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(Nn.add(this),wn||(wn=!0,jt.read(Dn),jt.resolveKeyframes(Tn))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:s,motionValue:n}=this;if(null===e[0]){const i=n?.get(),a=e[e.length-1];if(void 0!==i)e[0]=i;else if(s&&t){const n=s.readValue(t,a);null!=n&&(e[0]=n)}void 0===e[0]&&(e[0]=a),n&&void 0===i&&n.set(e[0])}!function(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Nn.delete(this)}cancel(){"scheduled"===this.state&&(Nn.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const kn=Xe(()=>void 0!==window.ScrollTimeline),Mn={};function En(e,t){const s=Xe(e);return()=>Mn[t]??s()}const An=En(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0},"linearEasing"),Vn=([e,t,s,n])=>`cubic-bezier(${e}, ${t}, ${s}, ${n})`,In={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Vn([0,.65,.55,1]),circOut:Vn([.55,0,1,.45]),backIn:Vn([.31,.01,.66,-.59]),backOut:Vn([.33,1.53,.69,.99])};function Fn(e,t){return e?"function"==typeof e?An()?ws(e,t):"ease-out":gt(e)?Vn(e):Array.isArray(e)?e.map(e=>Fn(e,t)||In.easeOut):In[e]:void 0}function Rn(e,t,s,{delay:n=0,duration:i=300,repeat:a=0,repeatType:r="loop",ease:o="easeOut",times:l}={},c=void 0){const d={[t]:s};l&&(d.offset=l);const u=Fn(o,i);Array.isArray(u)&&(d.easing=u);const m={delay:n,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:a+1,direction:"reverse"===r?"alternate":"normal"};c&&(m.pseudoElement=c);return e.animate(d,m)}function Bn(e){return"function"==typeof e&&"applyToOptions"in e}class Ln extends sn{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:s,keyframes:n,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:r,onComplete:o}=e;this.isPseudoElement=Boolean(i),this.allowFlatten=a,this.options=e,e.type;const l=function({type:e,...t}){return Bn(e)&&An()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}(e);this.animation=Rn(t,s,n,l,i),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const e=Js(n,this.options,r,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,s){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,s):e.style[t]=s}(t,s,e),this.animation.cancel()}o?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return et(Number(e))}get time(){return et(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Je(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&kn()?(this.animation.timeline=e,Ke):t(this)}}const $n={anticipate:ct,backInOut:lt,circInOut:mt};function On(e){"string"==typeof e.ease&&e.ease in $n&&(e.ease=$n[e.ease])}class Un extends Ln{constructor(e){On(e),tn(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:s,onComplete:n,element:i,...a}=this.options;if(!t)return;if(void 0!==e)return void t.set(e);const r=new an({...a,autoplay:!1}),o=Je(this.finishedTime??this.time);t.setWithVelocity(r.sample(o-10).value,r.sample(o).value,10),r.stop()}}const zn=(e,t)=>"zIndex"!==t&&(!("number"!=typeof e&&!Array.isArray(e))||!("string"!=typeof e||!os.test(e)&&"0"!==e||e.startsWith("url(")));function Wn(e){e.duration=0,e.type}const qn=new Set(["opacity","clipPath","filter","transform"]),Hn=Xe(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class Yn extends sn{constructor({autoplay:e=!0,delay:t=0,type:s="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:a="loop",keyframes:r,name:o,motionValue:l,element:c,...d}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Dt.now();const u={autoplay:e,delay:t,type:s,repeat:n,repeatDelay:i,repeatType:a,name:o,motionValue:l,element:c,...d},m=c?.KeyframeResolver||Pn;this.keyframeResolver=new m(r,(e,t,s)=>this.onKeyframesResolved(e,t,u,!s),o,l,c),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,s,n){this.keyframeResolver=void 0;const{name:i,type:a,velocity:r,delay:o,isHandoff:l,onUpdate:c}=s;this.resolvedAt=Dt.now(),function(e,t,s,n){const i=e[0];if(null===i)return!1;if("display"===t||"visibility"===t)return!0;const a=e[e.length-1],r=zn(i,t),o=zn(a,t);return!(!r||!o)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let s=0;s<e.length;s++)if(e[s]!==t)return!0}(e)||("spring"===s||Bn(s))&&n)}(e,i,a,r)||(!We.instantAnimations&&o||c?.(Js(e,s,t)),e[0]=e[e.length-1],Wn(s),s.repeat=0);const d={startTime:n?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t,...s,keyframes:e},u=!l&&function(e){const{motionValue:t,name:s,repeatDelay:n,repeatType:i,damping:a,type:r}=e,o=t?.owner?.current;if(!(o instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return Hn()&&s&&qn.has(s)&&("transform"!==s||!c)&&!l&&!n&&"mirror"!==i&&0!==a&&"inertia"!==r}(d)?new Un({...d,element:d.motionValue.owner.current}):new an(d);u.finished.then(()=>this.notifyFinished()).catch(Ke),this.pendingTimeline&&(this.stopTimeline=u.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=u}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),Cn=!0,Dn(),Tn(),Cn=!1),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const Xn=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Kn(e,t,s=1){const[n,i]=function(e){const t=Xn.exec(e);if(!t)return[,];const[,s,n,i]=t;return[`--${s??n}`,i]}(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const e=a.trim();return qe(e)?parseFloat(e):e}return Et(i)?Kn(i,t,s+1):i}function Gn(e,t){return e?.[t]??e?.default??e}const _n=new Set(["width","height","top","left","right","bottom",...gn]),Zn=e=>t=>t.test(e),Qn=[Vt,Xt,Yt,Ht,Gt,Kt,{test:e=>"auto"===e,parse:e=>e}],Jn=e=>Qn.find(Zn(e));function ei(e){return"number"==typeof e?0===e:null===e||("none"===e||"0"===e||Ye(e))}const ti=new Set(["brightness","contrast","saturate","opacity"]);function si(e){const[t,s]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[n]=s.match(Bt)||[];if(!n)return e;const i=s.replace(n,"");let a=ti.has(t)?1:0;return n!==s&&(a*=100),t+"("+a+i+")"}const ni=/\b([a-z-]*)\(.*?\)/gu,ii={...os,getAnimatableNone:e=>{const t=e.match(ni);return t?t.map(si).join(" "):e}},ai={...Vt,transform:Math.round},ri={borderWidth:Xt,borderTopWidth:Xt,borderRightWidth:Xt,borderBottomWidth:Xt,borderLeftWidth:Xt,borderRadius:Xt,radius:Xt,borderTopLeftRadius:Xt,borderTopRightRadius:Xt,borderBottomRightRadius:Xt,borderBottomLeftRadius:Xt,width:Xt,maxWidth:Xt,height:Xt,maxHeight:Xt,top:Xt,right:Xt,bottom:Xt,left:Xt,padding:Xt,paddingTop:Xt,paddingRight:Xt,paddingBottom:Xt,paddingLeft:Xt,margin:Xt,marginTop:Xt,marginRight:Xt,marginBottom:Xt,marginLeft:Xt,backgroundPositionX:Xt,backgroundPositionY:Xt,...{rotate:Ht,rotateX:Ht,rotateY:Ht,rotateZ:Ht,scale:Ft,scaleX:Ft,scaleY:Ft,scaleZ:Ft,skew:Ht,skewX:Ht,skewY:Ht,distance:Xt,translateX:Xt,translateY:Xt,translateZ:Xt,x:Xt,y:Xt,z:Xt,perspective:Xt,transformPerspective:Xt,opacity:It,originX:_t,originY:_t,originZ:Xt},zIndex:ai,fillOpacity:It,strokeOpacity:It,numOctaves:ai},oi={...ri,color:Qt,backgroundColor:Qt,outlineColor:Qt,fill:Qt,stroke:Qt,borderColor:Qt,borderTopColor:Qt,borderRightColor:Qt,borderBottomColor:Qt,borderLeftColor:Qt,filter:ii,WebkitFilter:ii},li=e=>oi[e];function ci(e,t){let s=li(e);return s!==ii&&(s=os),s.getAnimatableNone?s.getAnimatableNone(t):void 0}const di=new Set(["auto","none","0"]);class ui extends Pn{constructor(e,t,s,n,i){super(e,t,s,n,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:s}=this;if(!t||!t.current)return;super.readKeyframes();for(let o=0;o<e.length;o++){let s=e[o];if("string"==typeof s&&(s=s.trim(),Et(s))){const n=Kn(s,t.current);void 0!==n&&(e[o]=n),o===e.length-1&&(this.finalKeyframe=s)}}if(this.resolveNoneKeyframes(),!_n.has(s)||2!==e.length)return;const[n,i]=e,a=Jn(n),r=Jn(i);if(a!==r)if(xn(a)&&xn(r))for(let o=0;o<e.length;o++){const t=e[o];"string"==typeof t&&(e[o]=parseFloat(t))}else jn[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,s=[];for(let n=0;n<e.length;n++)(null===e[n]||ei(e[n]))&&s.push(n);s.length&&function(e,t,s){let n,i=0;for(;i<e.length&&!n;){const t=e[i];"string"==typeof t&&!di.has(t)&&ns(t).values.length&&(n=e[i]),i++}if(n&&s)for(const a of t)e[a]=ci(s,n)}(e,s,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:s}=this;if(!e||!e.current)return;"height"===s&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=jn[s](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const n=t[t.length-1];void 0!==n&&e.getValue(s,n).jump(n,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:s}=this;if(!e||!e.current)return;const n=e.getValue(t);n&&n.jump(this.measuredOrigin,!1);const i=s.length-1,a=s[i];s[i]=jn[t](e.measureViewportBox(),window.getComputedStyle(e.current)),null!==a&&void 0===this.finalKeyframe&&(this.finalKeyframe=a),this.removedTransforms?.length&&this.removedTransforms.forEach(([t,s])=>{e.getValue(t).set(s)}),this.resolveNoneKeyframes()}}const mi=(e,t)=>t&&"number"==typeof e?t.transform(e):e;function hi(e){return He(e)&&"offsetHeight"in e}class pi{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{const t=Dt.now();if(this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const s of this.dependents)s.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){var t;this.current=e,this.updatedAt=Dt.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(t=this.current,!isNaN(parseFloat(t))))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Qe);const s=this.events[e].add(t);return"change"===e?()=>{s(),jt.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,s){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Dt.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return tt(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function fi(e,t){return new pi(e,t)}const{schedule:gi}=bt(queueMicrotask,!1),yi={x:!1,y:!1};function xi(){return yi.x||yi.y}function vi(e,t){const s=function(e,t,s){if(e instanceof EventTarget)return[e];if("string"==typeof e){let t=document;const n=s?.[e]??t.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}(e),n=new AbortController;return[s,{passive:!0,...t,signal:n.signal},()=>n.abort()]}function bi(e){return!("touch"===e.pointerType||xi())}const ji=(e,t)=>!!t&&(e===t||ji(e,t.parentElement)),Ni=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary,wi=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const Si=new WeakSet;function Ci(e){return t=>{"Enter"===t.key&&e(t)}}function Ti(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function Di(e){return Ni(e)&&!xi()}function Pi(e,t,s={}){const[n,i,a]=vi(e,s),r=e=>{const n=e.currentTarget;if(!Di(e))return;Si.add(n);const a=t(n,e),r=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),Si.has(n)&&Si.delete(n),Di(e)&&"function"==typeof a&&a(e,{success:t})},o=e=>{r(e,n===window||n===document||s.useGlobalTarget||ji(n,e.target))},l=e=>{r(e,!1)};window.addEventListener("pointerup",o,i),window.addEventListener("pointercancel",l,i)};return n.forEach(e=>{var t;(s.useGlobalTarget?window:e).addEventListener("pointerdown",r,i),hi(e)&&(e.addEventListener("focus",e=>((e,t)=>{const s=e.currentTarget;if(!s)return;const n=Ci(()=>{if(Si.has(s))return;Ti(s,"down");const e=Ci(()=>{Ti(s,"up")});s.addEventListener("keyup",e,t),s.addEventListener("blur",()=>Ti(s,"cancel"),t)});s.addEventListener("keydown",n,t),s.addEventListener("blur",()=>s.removeEventListener("keydown",n),t)})(e,i)),t=e,wi.has(t.tagName)||-1!==t.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),a}function ki(e){return He(e)&&"ownerSVGElement"in e}const Mi=e=>Boolean(e&&e.getVelocity),Ei=[...Qn,Qt,os],Ai=s.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class Vi extends s.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,s=hi(e)&&e.offsetWidth||0,n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft,n.right=s-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Ii({children:t,isPresent:n,anchorX:i,root:a}){const r=s.useId(),o=s.useRef(null),l=s.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=s.useContext(Ai);return s.useInsertionEffect(()=>{const{width:e,height:t,top:s,left:d,right:u}=l.current;if(n||!o.current||!e||!t)return;const m="left"===i?`left: ${d}`:`right: ${u}`;o.current.dataset.motionPopId=r;const h=document.createElement("style");c&&(h.nonce=c);const p=a??document.head;return p.appendChild(h),h.sheet&&h.sheet.insertRule(`\n          [data-motion-pop-id="${r}"] {\n            position: absolute !important;\n            width: ${e}px !important;\n            height: ${t}px !important;\n            ${m}px !important;\n            top: ${s}px !important;\n          }\n        `),()=>{p.contains(h)&&p.removeChild(h)}},[n]),e.jsx(Vi,{isPresent:n,childRef:o,sizeRef:l,children:s.cloneElement(t,{ref:o})})}const Fi=({children:t,initial:n,isPresent:i,onExitComplete:a,custom:r,presenceAffectsLayout:o,mode:l,anchorX:c,root:d})=>{const u=Re(Ri),m=s.useId();let h=!0,p=s.useMemo(()=>(h=!1,{id:m,initial:n,isPresent:i,custom:r,onExitComplete:e=>{u.set(e,!0);for(const t of u.values())if(!t)return;a&&a()},register:e=>(u.set(e,!1),()=>u.delete(e))}),[i,u,a]);return o&&h&&(p={...p}),s.useMemo(()=>{u.forEach((e,t)=>u.set(t,!1))},[i]),s.useEffect(()=>{!i&&!u.size&&a&&a()},[i]),"popLayout"===l&&(t=e.jsx(Ii,{isPresent:i,anchorX:c,root:d,children:t})),e.jsx($e.Provider,{value:p,children:t})};function Ri(){return new Map}function Bi(e=!0){const t=s.useContext($e);if(null===t)return[!0,null];const{isPresent:n,onExitComplete:i,register:a}=t,r=s.useId();s.useEffect(()=>{if(e)return a(r)},[e]);const o=s.useCallback(()=>e&&i&&i(r),[r,i,e]);return!n&&i?[!1,o]:[!0]}const Li=e=>e.key||"";function $i(e){const t=[];return s.Children.forEach(e,e=>{s.isValidElement(e)&&t.push(e)}),t}const Oi=({children:t,custom:n,initial:i=!0,onExitComplete:a,presenceAffectsLayout:r=!0,mode:o="sync",propagate:l=!1,anchorX:c="left",root:d})=>{const[u,m]=Bi(l),h=s.useMemo(()=>$i(t),[t]),p=l&&!u?[]:h.map(Li),f=s.useRef(!0),g=s.useRef(h),y=Re(()=>new Map),[x,v]=s.useState(h),[b,j]=s.useState(h);Le(()=>{f.current=!1,g.current=h;for(let e=0;e<b.length;e++){const t=Li(b[e]);p.includes(t)?y.delete(t):!0!==y.get(t)&&y.set(t,!1)}},[b,p.length,p.join("-")]);const N=[];if(h!==x){let e=[...h];for(let t=0;t<b.length;t++){const s=b[t],n=Li(s);p.includes(n)||(e.splice(t,0,s),N.push(s))}return"wait"===o&&N.length&&(e=N),j($i(e)),v(h),null}const{forceRender:w}=s.useContext(Fe);return e.jsx(e.Fragment,{children:b.map(t=>{const s=Li(t),x=!(l&&!u)&&(h===b||p.includes(s));return e.jsx(Fi,{isPresent:x,initial:!(f.current&&!i)&&void 0,custom:n,presenceAffectsLayout:r,mode:o,root:d,onExitComplete:x?void 0:()=>{if(!y.has(s))return;y.set(s,!0);let e=!0;y.forEach(t=>{t||(e=!1)}),e&&(w?.(),j(g.current),l&&m?.(),a&&a())},anchorX:c,children:t},s)})})},Ui=s.createContext({strict:!1}),zi={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Wi={};for(const Jl in zi)Wi[Jl]={isEnabled:e=>zi[Jl].some(t=>!!e[t])};const qi=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Hi(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||qi.has(e)}let Yi=e=>!Hi(e);try{"function"==typeof(Xi=require("@emotion/is-prop-valid").default)&&(Yi=e=>e.startsWith("on")?!Hi(e):Xi(e))}catch{}var Xi;const Ki=s.createContext({});function Gi(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function _i(e){return"string"==typeof e||Array.isArray(e)}const Zi=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Qi=["initial",...Zi];function Ji(e){return Gi(e.animate)||Qi.some(t=>_i(e[t]))}function ea(e){return Boolean(Ji(e)||e.variants)}function ta(e){const{initial:t,animate:n}=function(e,t){if(Ji(e)){const{initial:t,animate:s}=e;return{initial:!1===t||_i(t)?t:void 0,animate:_i(s)?s:void 0}}return!1!==e.inherit?t:{}}(e,s.useContext(Ki));return s.useMemo(()=>({initial:t,animate:n}),[sa(t),sa(n)])}function sa(e){return Array.isArray(e)?e.join(" "):e}const na={};function ia(e,{layout:t,layoutId:s}){return yn.has(e)||e.startsWith("origin")||(t||void 0!==s)&&(!!na[e]||"opacity"===e)}const aa={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ra=gn.length;function oa(e,t,s){const{style:n,vars:i,transformOrigin:a}=e;let r=!1,o=!1;for(const l in t){const e=t[l];if(yn.has(l))r=!0;else if(kt(l))i[l]=e;else{const t=mi(e,ri[l]);l.startsWith("origin")?(o=!0,a[l]=t):n[l]=t}}if(t.transform||(r||s?n.transform=function(e,t,s){let n="",i=!0;for(let a=0;a<ra;a++){const r=gn[a],o=e[r];if(void 0===o)continue;let l=!0;if(l="number"==typeof o?o===(r.startsWith("scale")?1:0):0===parseFloat(o),!l||s){const e=mi(o,ri[r]);l||(i=!1,n+=`${aa[r]||r}(${e}) `),s&&(t[r]=e)}}return n=n.trim(),s?n=s(t,i?"":n):i&&(n="none"),n}(t,e.transform,s):n.transform&&(n.transform="none")),o){const{originX:e="50%",originY:t="50%",originZ:s=0}=a;n.transformOrigin=`${e} ${t} ${s}`}}const la=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function ca(e,t,s){for(const n in t)Mi(t[n])||ia(n,s)||(e[n]=t[n])}function da(e,t){const n={};return ca(n,e.style||{},e),Object.assign(n,function({transformTemplate:e},t){return s.useMemo(()=>{const s={style:{},transform:{},transformOrigin:{},vars:{}};return oa(s,t,e),Object.assign({},s.vars,s.style)},[t])}(e,t)),n}function ua(e,t){const s={},n=da(e,t);return e.drag&&!1!==e.dragListener&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=!0===e.drag?"none":"pan-"+("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(s.tabIndex=0),s.style=n,s}const ma={offset:"stroke-dashoffset",array:"stroke-dasharray"},ha={offset:"strokeDashoffset",array:"strokeDasharray"};function pa(e,{attrX:t,attrY:s,attrScale:n,pathLength:i,pathSpacing:a=1,pathOffset:r=0,...o},l,c,d){if(oa(e,o,c),l)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:u,style:m}=e;u.transform&&(m.transform=u.transform,delete u.transform),(m.transform||u.transformOrigin)&&(m.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),m.transform&&(m.transformBox=d?.transformBox??"fill-box",delete u.transformBox),void 0!==t&&(u.x=t),void 0!==s&&(u.y=s),void 0!==n&&(u.scale=n),void 0!==i&&function(e,t,s=1,n=0,i=!0){e.pathLength=1;const a=i?ma:ha;e[a.offset]=Xt.transform(-n);const r=Xt.transform(t),o=Xt.transform(s);e[a.array]=`${r} ${o}`}(u,i,a,r,!1)}const fa=()=>({style:{},transform:{},transformOrigin:{},vars:{},attrs:{}}),ga=e=>"string"==typeof e&&"svg"===e.toLowerCase();function ya(e,t,n,i){const a=s.useMemo(()=>{const s={style:{},transform:{},transformOrigin:{},vars:{},attrs:{}};return pa(s,t,ga(i),e.transformTemplate,e.style),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const t={};ca(t,e.style,e),a.style={...t,...a.style}}return a}const xa=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function va(e){return"string"==typeof e&&!e.includes("-")&&!!(xa.indexOf(e)>-1||/[A-Z]/u.test(e))}function ba(e,t,n,{latestValues:i},a,r=!1){const o=(va(e)?ya:ua)(t,i,a,e),l=function(e,t,s){const n={};for(const i in e)"values"===i&&"object"==typeof e.values||(Yi(i)||!0===s&&Hi(i)||!t&&!Hi(i)||e.draggable&&i.startsWith("onDrag"))&&(n[i]=e[i]);return n}(t,"string"==typeof e,r),c=e!==s.Fragment?{...l,...o,ref:n}:{},{children:d}=t,u=s.useMemo(()=>Mi(d)?d.get():d,[d]);return s.createElement(e,{...c,children:u})}function ja(e){const t=[{},{}];return e?.values.forEach((e,s)=>{t[0][s]=e.get(),t[1][s]=e.getVelocity()}),t}function Na(e,t,s,n){if("function"==typeof t){const[i,a]=ja(n);t=t(void 0!==s?s:e.custom,i,a)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){const[i,a]=ja(n);t=t(void 0!==s?s:e.custom,i,a)}return t}function wa(e){return Mi(e)?e.get():e}function Sa(e,t,s,n){const i={},a=n(e,{});for(const m in a)i[m]=wa(a[m]);let{initial:r,animate:o}=e;const l=Ji(e),c=ea(e);t&&c&&!l&&!1!==e.inherit&&(void 0===r&&(r=t.initial),void 0===o&&(o=t.animate));let d=!!s&&!1===s.initial;d=d||!1===r;const u=d?o:r;if(u&&"boolean"!=typeof u&&!Gi(u)){const t=Array.isArray(u)?u:[u];for(let s=0;s<t.length;s++){const n=Na(e,t[s]);if(n){const{transitionEnd:e,transition:t,...s}=n;for(const n in s){let e=s[n];if(Array.isArray(e)){e=e[d?e.length-1:0]}null!==e&&(i[n]=e)}for(const n in e)i[n]=e[n]}}}return i}const Ca=e=>(t,n)=>{const i=s.useContext(Ki),a=s.useContext($e),r=()=>function({scrapeMotionValuesFromProps:e,createRenderState:t},s,n,i){return{latestValues:Sa(s,n,i,e),renderState:t()}}(e,t,i,a);return n?r():Re(r)};function Ta(e,t,s){const{style:n}=e,i={};for(const a in n)(Mi(n[a])||t.style&&Mi(t.style[a])||ia(a,e)||void 0!==s?.getValue(a)?.liveStyle)&&(i[a]=n[a]);return i}const Da=Ca({scrapeMotionValuesFromProps:Ta,createRenderState:la});function Pa(e,t,s){const n=Ta(e,t,s);for(const i in e)if(Mi(e[i])||Mi(t[i])){n[-1!==gn.indexOf(i)?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i]=e[i]}return n}const ka=Ca({scrapeMotionValuesFromProps:Pa,createRenderState:fa}),Ma=Symbol.for("motionComponentSymbol");function Ea(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function Aa(e,t,n){return s.useCallback(s=>{s&&e.onMount&&e.onMount(s),t&&(s?t.mount(s):t.unmount()),n&&("function"==typeof n?n(s):Ea(n)&&(n.current=s))},[t])}const Va=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Ia="data-"+Va("framerAppearId"),Fa=s.createContext({});function Ra(e,t,n,i,a){const{visualElement:r}=s.useContext(Ki),o=s.useContext(Ui),l=s.useContext($e),c=s.useContext(Ai).reducedMotion,d=s.useRef(null);i=i||o.renderer,!d.current&&i&&(d.current=i(e,{visualState:t,parent:r,props:n,presenceContext:l,blockInitialAnimation:!!l&&!1===l.initial,reducedMotionConfig:c}));const u=d.current,m=s.useContext(Fa);!u||u.projection||!a||"html"!==u.type&&"svg"!==u.type||function(e,t,s,n){const{layoutId:i,layout:a,drag:r,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=t;e.projection=new s(e.latestValues,t["data-framer-portal-id"]?void 0:Ba(e.parent)),e.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:Boolean(r)||o&&Ea(o),visualElement:e,animationType:"string"==typeof a?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:l,layoutRoot:c})}(d.current,n,a,m);const h=s.useRef(!1);s.useInsertionEffect(()=>{u&&h.current&&u.update(n,l)});const p=n[Ia],f=s.useRef(Boolean(p)&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return Le(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),f.current&&u.animationState&&u.animationState.animateChanges())}),s.useEffect(()=>{u&&(!f.current&&u.animationState&&u.animationState.animateChanges(),f.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),f.current=!1),u.enteringChildren=void 0)}),u}function Ba(e){if(e)return!1!==e.options.allowProjection?e.projection:Ba(e.parent)}function La(t,{forwardMotionProps:n=!1}={},i,a){i&&function(e){for(const t in e)Wi[t]={...Wi[t],...e[t]}}(i);const r=va(t)?ka:Da;function o(i,o){let l;const c={...s.useContext(Ai),...i,layoutId:$a(i)},{isStatic:d}=c,u=ta(i),m=r(i,d);if(!d&&Be){s.useContext(Ui).strict;const e=function(e){const{drag:t,layout:s}=Wi;if(!t&&!s)return{};const n={...t,...s};return{MeasureLayout:t?.isEnabled(e)||s?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}(c);l=e.MeasureLayout,u.visualElement=Ra(t,m,c,a,e.ProjectionNode)}return e.jsxs(Ki.Provider,{value:u,children:[l&&u.visualElement?e.jsx(l,{visualElement:u.visualElement,...c}):null,ba(t,i,Aa(m,u.visualElement,o),m,d,n)]})}o.displayName=`motion.${"string"==typeof t?t:`create(${t.displayName??t.name??""})`}`;const l=s.forwardRef(o);return l[Ma]=t,l}function $a({layoutId:e}){const t=s.useContext(Fe).id;return t&&void 0!==e?t+"-"+e:e}function Oa(e,t){if("undefined"==typeof Proxy)return La;const s=new Map,n=(s,n)=>La(s,n,e,t);return new Proxy((e,t)=>n(e,t),{get:(i,a)=>"create"===a?n:(s.has(a)||s.set(a,La(a,void 0,e,t)),s.get(a))})}function Ua({top:e,left:t,right:s,bottom:n}){return{x:{min:t,max:s},y:{min:e,max:n}}}function za(e){return void 0===e||1===e}function Wa({scale:e,scaleX:t,scaleY:s}){return!za(e)||!za(t)||!za(s)}function qa(e){return Wa(e)||Ha(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Ha(e){return Ya(e.x)||Ya(e.y)}function Ya(e){return e&&"0%"!==e}function Xa(e,t,s){return s+t*(e-s)}function Ka(e,t,s,n,i){return void 0!==i&&(e=Xa(e,i,n)),Xa(e,s,n)+t}function Ga(e,t=0,s=1,n,i){e.min=Ka(e.min,t,s,n,i),e.max=Ka(e.max,t,s,n,i)}function _a(e,{x:t,y:s}){Ga(e.x,t.translate,t.scale,t.originPoint),Ga(e.y,s.translate,s.scale,s.originPoint)}const Za=.999999999999,Qa=1.0000000000001;function Ja(e,t){e.min=e.min+t,e.max=e.max+t}function er(e,t,s,n,i=.5){Ga(e,t,s,ds(e.min,e.max,i),n)}function tr(e,t){er(e.x,t.x,t.scaleX,t.scale,t.originX),er(e.y,t.y,t.scaleY,t.scale,t.originY)}function sr(e,t){return Ua(function(e,t){if(!t)return e;const s=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}(e.getBoundingClientRect(),t))}const nr=()=>({x:{min:0,max:0},y:{min:0,max:0}}),ir={current:null},ar={current:!1};const rr=new WeakMap;const or=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class lr{scrapeMotionValuesFromProps(e,t,s){return{}}constructor({parent:e,props:t,presenceContext:s,reducedMotionConfig:n,blockInitialAnimation:i,visualState:a},r={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Pn,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=Dt.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,jt.render(this.render,!1,!0))};const{latestValues:o,renderState:l}=a;this.latestValues=o,this.baseTarget={...o},this.initialValues=t.initial?{...o}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=n,this.options=r,this.blockInitialAnimation=Boolean(i),this.isControllingVariants=Ji(t),this.isVariantNode=ea(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(e&&e.current);const{willChange:c,...d}=this.scrapeMotionValuesFromProps(t,{},this);for(const u in d){const e=d[u];void 0!==o[u]&&Mi(e)&&e.set(o[u])}}mount(e){this.current=e,rr.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),ar.current||function(){if(ar.current=!0,Be)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>ir.current=e.matches;e.addEventListener("change",t),t()}else ir.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||ir.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Nt(this.notifyUpdate),Nt(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=yn.has(e);s&&this.onBindTransform&&this.onBindTransform();const n=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&jt.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{n(),i&&i(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in Wi){const t=Wi[e];if(!t)continue;const{isEnabled:s,Feature:n}=t;if(!this.features[e]&&n&&s(this.props)&&(this.features[e]=new n(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let s=0;s<or.length;s++){const t=or[s];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const n=e["on"+t];n&&(this.propEventSubscriptions[t]=this.on(t,n))}this.prevMotionValues=function(e,t,s){for(const n in t){const i=t[n],a=s[n];if(Mi(i))e.addValue(n,i);else if(Mi(a))e.addValue(n,fi(i,{owner:e}));else if(a!==i)if(e.hasValue(n)){const t=e.getValue(n);!0===t.liveStyle?t.jump(i):t.hasAnimated||t.set(i)}else{const t=e.getStaticValue(n);e.addValue(n,fi(void 0!==t?t:i,{owner:e}))}}for(const n in s)void 0===t[n]&&e.removeValue(n);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const s=this.values.get(e);t!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return void 0===s&&void 0!==t&&(s=fi(null===t?void 0:t,{owner:this}),this.addValue(e,s)),s}readValue(e,t){let s=void 0===this.latestValues[e]&&this.current?this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var n;return null!=s&&("string"==typeof s&&(qe(s)||Ye(s))?s=parseFloat(s):(n=s,!Ei.find(Zn(n))&&os.test(t)&&(s=ci(e,t))),this.setBaseTarget(e,Mi(s)?s.get():s)),Mi(s)?s.get():s}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let s;if("string"==typeof t||"object"==typeof t){const n=Na(this.props,t,this.presenceContext?.custom);n&&(s=n[e])}if(t&&void 0!==s)return s;const n=this.getBaseTargetFromProps(this.props,e);return void 0===n||Mi(n)?void 0!==this.initialValues[e]&&void 0===s?void 0:this.baseTarget[e]:n}on(e,t){return this.events[e]||(this.events[e]=new Qe),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){gi.render(this.render)}}class cr extends lr{constructor(){super(...arguments),this.KeyframeResolver=ui}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:s}){delete t[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Mi(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}function dr(e,{style:t,vars:s},n,i){const a=e.style;let r;for(r in t)a[r]=t[r];for(r in i?.applyProjectionStyles(a,n),s)a.setProperty(r,s[r])}class ur extends cr{constructor(){super(...arguments),this.type="html",this.renderInstance=dr}readValueFromInstance(e,t){if(yn.has(t))return this.projection?.isProjecting?hn(t):((e,t)=>{const{transform:s="none"}=getComputedStyle(e);return pn(s,t)})(e,t);{const n=(s=e,window.getComputedStyle(s)),i=(kt(t)?n.getPropertyValue(t):n[t])||0;return"string"==typeof i?i.trim():i}var s}measureInstanceViewportBox(e,{transformPagePoint:t}){return sr(e,t)}build(e,t,s){oa(e,t,s.transformTemplate)}scrapeMotionValuesFromProps(e,t,s){return Ta(e,t,s)}}const mr=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);class hr extends cr{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=nr}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(yn.has(t)){const e=li(t);return e&&e.default||0}return t=mr.has(t)?t:Va(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,s){return Pa(e,t,s)}build(e,t,s){pa(e,t,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(e,t,s,n){!function(e,t,s,n){dr(e,t,void 0,n);for(const i in t.attrs)e.setAttribute(mr.has(i)?i:Va(i),t.attrs[i])}(e,t,0,n)}mount(e){this.isSVGTag=ga(e.tagName),super.mount(e)}}const pr=(e,t)=>va(e)?new hr(t):new ur(t,{allowProjection:e!==s.Fragment});function fr(e,t,s){const n=e.getProps();return Na(n,t,void 0!==s?s:n.custom,e)}const gr=e=>Array.isArray(e);function yr(e,t,s){e.hasValue(t)?e.getValue(t).set(s):e.addValue(t,fi(s))}function xr(e){return gr(e)?e[e.length-1]||0:e}function vr(e,t){const s=e.getValue("willChange");if(n=s,Boolean(Mi(n)&&n.add))return s.add(t);if(!s&&We.WillChange){const s=new We.WillChange("auto");e.addValue("willChange",s),s.add(t)}var n}function br(e){return e.props[Ia]}const jr=e=>null!==e;const Nr={type:"spring",stiffness:500,damping:25,restSpeed:10},wr={type:"keyframes",duration:.8},Sr={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Cr=(e,{keyframes:t})=>t.length>2?wr:yn.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===t[1]?2*Math.sqrt(550):30,restSpeed:10}:Nr:Sr;const Tr=(e,t,s,n={},i,a)=>r=>{const o=Gn(n,e)||{},l=o.delay||n.delay||0;let{elapsed:c=0}=n;c-=Je(l);const d={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:e=>{t.set(e),o.onUpdate&&o.onUpdate(e)},onComplete:()=>{r(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:i};(function({when:e,delay:t,delayChildren:s,staggerChildren:n,staggerDirection:i,repeat:a,repeatType:r,repeatDelay:o,from:l,elapsed:c,...d}){return!!Object.keys(d).length})(o)||Object.assign(d,Cr(e,d)),d.duration&&(d.duration=Je(d.duration)),d.repeatDelay&&(d.repeatDelay=Je(d.repeatDelay)),void 0!==d.from&&(d.keyframes[0]=d.from);let u=!1;if((!1===d.type||0===d.duration&&!d.repeatDelay)&&(Wn(d),0===d.delay&&(u=!0)),(We.instantAnimations||We.skipAnimations)&&(u=!0,Wn(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,u&&!a&&void 0!==t.get()){const e=function(e,{repeat:t,repeatType:s="loop"}){const n=e.filter(jr);return n[t&&"loop"!==s&&t%2==1?0:n.length-1]}(d.keyframes,o);if(void 0!==e)return void jt.update(()=>{d.onUpdate(e),d.onComplete()})}return o.isSync?new an(d):new Yn(d)};function Dr({protectedKeys:e,needsAnimating:t},s){const n=e.hasOwnProperty(s)&&!0!==t[s];return t[s]=!1,n}function Pr(e,t,{delay:s=0,transitionOverride:n,type:i}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:r,...o}=t;n&&(a=n);const l=[],c=i&&e.animationState&&e.animationState.getState()[i];for(const d in o){const t=e.getValue(d,e.latestValues[d]??null),n=o[d];if(void 0===n||c&&Dr(c,d))continue;const i={delay:s,...Gn(a||{},d)},r=t.get();if(void 0!==r&&!t.isAnimating&&!Array.isArray(n)&&n===r&&!i.velocity)continue;let u=!1;if(window.MotionHandoffAnimation){const t=br(e);if(t){const e=window.MotionHandoffAnimation(t,d,jt);null!==e&&(i.startTime=e,u=!0)}}vr(e,d),t.start(Tr(d,t,n,e.shouldReduceMotion&&_n.has(d)?{type:!1}:i,e,u));const m=t.animation;m&&l.push(m)}return r&&Promise.all(l).then(()=>{jt.update(()=>{r&&function(e,t){const s=fr(e,t);let{transitionEnd:n={},transition:i={},...a}=s||{};a={...a,...n};for(const r in a)yr(e,r,xr(a[r]))}(e,r)})}),l}function kr(e,t,s,n=0,i=1){const a=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),r=e.size,o=(r-1)*n;return"function"==typeof s?s(a,r):1===i?a*n:o-a*n}function Mr(e,t,s={}){const n=fr(e,t,"exit"===s.type?e.presenceContext?.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=n||{};s.transitionOverride&&(i=s.transitionOverride);const a=n?()=>Promise.all(Pr(e,n,s)):()=>Promise.resolve(),r=e.variantChildren&&e.variantChildren.size?(n=0)=>{const{delayChildren:a=0,staggerChildren:r,staggerDirection:o}=i;return function(e,t,s=0,n=0,i=0,a=1,r){const o=[];for(const l of e.variantChildren)l.notify("AnimationStart",t),o.push(Mr(l,t,{...r,delay:s+("function"==typeof n?0:n)+kr(e.variantChildren,l,n,i,a)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(o)}(e,t,n,a,r,o,s)}:()=>Promise.resolve(),{when:o}=i;if(o){const[e,t]="beforeChildren"===o?[a,r]:[r,a];return e().then(()=>t())}return Promise.all([a(),r(s.delay)])}function Er(e,t){if(!Array.isArray(t))return!1;const s=t.length;if(s!==e.length)return!1;for(let n=0;n<s;n++)if(t[n]!==e[n])return!1;return!0}const Ar=Qi.length;function Vr(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&Vr(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let s=0;s<Ar;s++){const n=Qi[s],i=e.props[n];(_i(i)||!1===i)&&(t[n]=i)}return t}const Ir=[...Zi].reverse(),Fr=Zi.length;function Rr(e){return t=>Promise.all(t.map(({animation:t,options:s})=>function(e,t,s={}){let n;if(e.notify("AnimationStart",t),Array.isArray(t)){const i=t.map(t=>Mr(e,t,s));n=Promise.all(i)}else if("string"==typeof t)n=Mr(e,t,s);else{const i="function"==typeof t?fr(e,t,s.custom):t;n=Promise.all(Pr(e,i,s))}return n.then(()=>{e.notify("AnimationComplete",t)})}(e,t,s)))}function Br(e){let t=Rr(e),s=Or(),n=!0;const i=t=>(s,n)=>{const i=fr(e,n,"exit"===t?e.presenceContext?.custom:void 0);if(i){const{transition:e,transitionEnd:t,...n}=i;s={...s,...n,...t}}return s};function a(a){const{props:r}=e,o=Vr(e.parent)||{},l=[],c=new Set;let d={},u=1/0;for(let t=0;t<Fr;t++){const m=Ir[t],h=s[m],p=void 0!==r[m]?r[m]:o[m],f=_i(p),g=m===a?h.isActive:null;!1===g&&(u=t);let y=p===o[m]&&p!==r[m]&&f;if(y&&n&&e.manuallyAnimateOnMount&&(y=!1),h.protectedKeys={...d},!h.isActive&&null===g||!p&&!h.prevProp||Gi(p)||"boolean"==typeof p)continue;const x=Lr(h.prevProp,p);let v=x||m===a&&h.isActive&&!y&&f||t>u&&f,b=!1;const j=Array.isArray(p)?p:[p];let N=j.reduce(i(m),{});!1===g&&(N={});const{prevResolvedValues:w={}}=h,S={...w,...N},C=t=>{v=!0,c.has(t)&&(b=!0,c.delete(t)),h.needsAnimating[t]=!0;const s=e.getValue(t);s&&(s.liveStyle=!1)};for(const e in S){const t=N[e],s=w[e];if(d.hasOwnProperty(e))continue;let n=!1;n=gr(t)&&gr(s)?!Er(t,s):t!==s,n?null!=t?C(e):c.add(e):void 0!==t&&c.has(e)?C(e):h.protectedKeys[e]=!0}h.prevProp=p,h.prevResolvedValues=N,h.isActive&&(d={...d,...N}),n&&e.blockInitialAnimation&&(v=!1);const T=y&&x;v&&(!T||b)&&l.push(...j.map(t=>{const s={type:m};if("string"==typeof t&&n&&!T&&e.manuallyAnimateOnMount&&e.parent){const{parent:n}=e,i=fr(n,t);if(n.enteringChildren&&i){const{delayChildren:t}=i.transition||{};s.delay=kr(n.enteringChildren,e,t)}}return{animation:t,options:s}}))}if(c.size){const t={};if("boolean"!=typeof r.initial){const s=fr(e,Array.isArray(r.initial)?r.initial[0]:r.initial);s&&s.transition&&(t.transition=s.transition)}c.forEach(s=>{const n=e.getBaseTarget(s),i=e.getValue(s);i&&(i.liveStyle=!0),t[s]=n??null}),l.push({animation:t})}let m=Boolean(l.length);return!n||!1!==r.initial&&r.initial!==r.animate||e.manuallyAnimateOnMount||(m=!1),n=!1,m?t(l):Promise.resolve()}return{animateChanges:a,setActive:function(t,n){if(s[t].isActive===n)return Promise.resolve();e.variantChildren?.forEach(e=>e.animationState?.setActive(t,n)),s[t].isActive=n;const i=a(t);for(const e in s)s[e].protectedKeys={};return i},setAnimateFunction:function(s){t=s(e)},getState:()=>s,reset:()=>{s=Or(),n=!0}}}function Lr(e,t){return"string"==typeof t?t!==e:!!Array.isArray(t)&&!Er(t,e)}function $r(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Or(){return{animate:$r(!0),whileInView:$r(),whileHover:$r(),whileTap:$r(),whileDrag:$r(),whileFocus:$r(),exit:$r()}}class Ur{constructor(e){this.isMounted=!1,this.node=e}update(){}}let zr=0;const Wr={animation:{Feature:class extends Ur{constructor(e){super(e),e.animationState||(e.animationState=Br(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Gi(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}},exit:{Feature:class extends Ur{constructor(){super(...arguments),this.id=zr++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const n=this.node.animationState.setActive("exit",!e);t&&!e&&n.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}};function qr(e,t,s,n={passive:!0}){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s)}function Hr(e){return{point:{x:e.pageX,y:e.pageY}}}function Yr(e,t,s,n){return qr(e,t,(e=>t=>Ni(t)&&e(t,Hr(t)))(s),n)}function Xr(e){return e.max-e.min}function Kr(e,t,s,n=.5){e.origin=n,e.originPoint=ds(t.min,t.max,e.origin),e.scale=Xr(s)/Xr(t),e.translate=ds(s.min,s.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function Gr(e,t,s,n){Kr(e.x,t.x,s.x,n?n.originX:void 0),Kr(e.y,t.y,s.y,n?n.originY:void 0)}function _r(e,t,s){e.min=s.min+t.min,e.max=e.min+Xr(t)}function Zr(e,t,s){e.min=t.min-s.min,e.max=e.min+Xr(t)}function Qr(e,t,s){Zr(e.x,t.x,s.x),Zr(e.y,t.y,s.y)}function Jr(e){return[e("x"),e("y")]}const eo=({current:e})=>e?e.ownerDocument.defaultView:null,to=(e,t)=>Math.abs(e-t);class so{constructor(e,t,{transformPagePoint:s,contextWindow:n=window,dragSnapToOrigin:i=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=ao(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,s=function(e,t){const s=to(e.x,t.x),n=to(e.y,t.y);return Math.sqrt(s**2+n**2)}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!t&&!s)return;const{point:n}=e,{timestamp:i}=wt;this.history.push({...n,timestamp:i});const{onStart:a,onMove:r}=this.handlers;t||(a&&a(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),r&&r(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=no(t,this.transformPagePoint),jt.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:s,onSessionEnd:n,resumeAnimation:i}=this.handlers;if(this.dragSnapToOrigin&&i&&i(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const a=ao("pointercancel"===e.type?this.lastMoveEventInfo:no(t,this.transformPagePoint),this.history);this.startEvent&&s&&s(e,a),n&&n(e,a)},!Ni(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=s,this.distanceThreshold=a,this.contextWindow=n||window;const r=no(Hr(e),this.transformPagePoint),{point:o}=r,{timestamp:l}=wt;this.history=[{...o,timestamp:l}];const{onSessionStart:c}=t;c&&c(e,ao(r,this.history)),this.removeListeners=_e(Yr(this.contextWindow,"pointermove",this.handlePointerMove),Yr(this.contextWindow,"pointerup",this.handlePointerUp),Yr(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Nt(this.updatePoint)}}function no(e,t){return t?{point:t(e.point)}:e}function io(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ao({point:e},t){return{point:e,delta:io(e,oo(t)),offset:io(e,ro(t)),velocity:lo(t,.1)}}function ro(e){return e[0]}function oo(e){return e[e.length-1]}function lo(e,t){if(e.length<2)return{x:0,y:0};let s=e.length-1,n=null;const i=oo(e);for(;s>=0&&(n=e[s],!(i.timestamp-n.timestamp>Je(t)));)s--;if(!n)return{x:0,y:0};const a=et(i.timestamp-n.timestamp);if(0===a)return{x:0,y:0};const r={x:(i.x-n.x)/a,y:(i.y-n.y)/a};return r.x===1/0&&(r.x=0),r.y===1/0&&(r.y=0),r}function co(e,t,s){return{min:void 0!==t?e.min+t:void 0,max:void 0!==s?e.max+s-(e.max-e.min):void 0}}function uo(e,t){let s=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([s,n]=[n,s]),{min:s,max:n}}const mo=.35;function ho(e,t,s){return{min:po(e,t),max:po(e,s)}}function po(e,t){return"number"==typeof e?e:e[t]||0}const fo=new WeakMap;class go{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:s}={}){const{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;const{dragSnapToOrigin:i}=this.getProps();this.panSession=new so(e,{onSessionStart:e=>{const{dragSnapToOrigin:s}=this.getProps();s?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Hr(e).point)},onStart:(e,t)=>{const{drag:s,dragPropagation:n,onDragStart:i}=this.getProps();if(s&&!n&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(a=s)||"y"===a?yi[a]?null:(yi[a]=!0,()=>{yi[a]=!1}):yi.x||yi.y?null:(yi.x=yi.y=!0,()=>{yi.x=yi.y=!1}),!this.openDragLock))return;var a;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Jr(e=>{let t=this.getAxisMotionValue(e).get()||0;if(Yt.test(t)){const{projection:s}=this.visualElement;if(s&&s.layout){const n=s.layout.layoutBox[e];if(n){t=Xr(n)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),i&&jt.postRender(()=>i(e,t)),vr(this.visualElement,"transform");const{animationState:r}=this.visualElement;r&&r.setActive("whileDrag",!0)},onMove:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;const{dragPropagation:s,dragDirectionLock:n,onDirectionLock:i,onDrag:a}=this.getProps();if(!s&&!this.openDragLock)return;const{offset:r}=t;if(n&&null===this.currentDirection)return this.currentDirection=function(e,t=10){let s=null;Math.abs(e.y)>t?s="y":Math.abs(e.x)>t&&(s="x");return s}(r),void(null!==this.currentDirection&&i&&i(this.currentDirection));this.updateAxis("x",t.point,r),this.updateAxis("y",t.point,r),this.visualElement.render(),a&&a(e,t)},onSessionEnd:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>Jr(e=>"paused"===this.getAnimationState(e)&&this.getAxisMotionValue(e).animation?.play())},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:i,distanceThreshold:s,contextWindow:eo(this.visualElement)})}stop(e,t){const s=e||this.latestPointerEvent,n=t||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!n||!s)return;const{velocity:a}=n;this.startAnimation(a);const{onDragEnd:r}=this.getProps();r&&jt.postRender(()=>r(s,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,s){const{drag:n}=this.getProps();if(!s||!yo(e,n,this.currentDirection))return;const i=this.getAxisMotionValue(e);let a=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(a=function(e,{min:t,max:s},n){return void 0!==t&&e<t?e=n?ds(t,e,n.min):Math.max(e,t):void 0!==s&&e>s&&(e=n?ds(s,e,n.max):Math.min(e,s)),e}(a,this.constraints[e],this.elastic[e])),i.set(a)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,n=this.constraints;e&&Ea(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!e||!s)&&function(e,{top:t,left:s,bottom:n,right:i}){return{x:co(e.x,s,i),y:co(e.y,t,n)}}(s.layoutBox,e),this.elastic=function(e=mo){return!1===e?e=0:!0===e&&(e=mo),{x:ho(e,"left","right"),y:ho(e,"top","bottom")}}(t),n!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Jr(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const s={};return void 0!==t.min&&(s.min=t.min-e.min),void 0!==t.max&&(s.max=t.max-e.min),s}(s.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Ea(e))return!1;const s=e.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const i=function(e,t,s){const n=sr(e,s),{scroll:i}=t;return i&&(Ja(n.x,i.offset.x),Ja(n.y,i.offset.y)),n}(s,n.root,this.visualElement.getTransformPagePoint());let a=function(e,t){return{x:uo(e.x,t.x),y:uo(e.y,t.y)}}(n.layout.layoutBox,i);if(t){const e=t(function({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}(a));this.hasMutatedConstraints=!!e,e&&(a=Ua(e))}return a}startAnimation(e){const{drag:t,dragMomentum:s,dragElastic:n,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:r}=this.getProps(),o=this.constraints||{},l=Jr(r=>{if(!yo(r,t,this.currentDirection))return;let l=o&&o[r]||{};a&&(l={min:0,max:0});const c=n?200:1e6,d=n?40:1e7,u={type:"inertia",velocity:s?e[r]:0,bounceStiffness:c,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10,...i,...l};return this.startAxisValueAnimation(r,u)});return Promise.all(l).then(r)}startAxisValueAnimation(e,t){const s=this.getAxisMotionValue(e);return vr(this.visualElement,e),s.start(Tr(e,s,0,t,this.visualElement,!1))}stopAnimation(){Jr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Jr(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),n=s[t];return n||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){Jr(t=>{const{drag:s}=this.getProps();if(!yo(t,s,this.currentDirection))return;const{projection:n}=this.visualElement,i=this.getAxisMotionValue(t);if(n&&n.layout){const{min:s,max:a}=n.layout.layoutBox[t];i.set(e[t]-ds(s,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:s}=this.visualElement;if(!Ea(t)||!s||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Jr(e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const s=t.get();n[e]=function(e,t){let s=.5;const n=Xr(e),i=Xr(t);return i>n?s=Ze(t.min,t.max-n,e.min):n>i&&(s=Ze(e.min,e.max-i,t.min)),ze(0,1,s)}({min:s,max:s},this.constraints[e])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),Jr(t=>{if(!yo(t,e,null))return;const s=this.getAxisMotionValue(t),{min:i,max:a}=this.constraints[t];s.set(ds(i,a,n[t]))})}addListeners(){if(!this.visualElement.current)return;fo.set(this.visualElement,this);const e=Yr(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:s=!0}=this.getProps();t&&s&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();Ea(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,n=s.addEventListener("measure",t);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),jt.read(t);const i=qr(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(Jr(t=>{const s=this.getAxisMotionValue(t);s&&(this.originPoint[t]+=e[t].translate,s.set(s.get()+e[t].translate))}),this.visualElement.render())});return()=>{i(),e(),n(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:s=!1,dragPropagation:n=!1,dragConstraints:i=!1,dragElastic:a=mo,dragMomentum:r=!0}=e;return{...e,drag:t,dragDirectionLock:s,dragPropagation:n,dragConstraints:i,dragElastic:a,dragMomentum:r}}}function yo(e,t,s){return!(!0!==t&&t!==e||null!==s&&s!==e)}const xo=e=>(t,s)=>{e&&jt.postRender(()=>e(t,s))};const vo={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function bo(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const jo={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e){if(!Xt.test(e))return e;e=parseFloat(e)}return`${bo(e,t.target.x)}% ${bo(e,t.target.y)}%`}},No={correct:(e,{treeScale:t,projectionDelta:s})=>{const n=e,i=os.parse(e);if(i.length>5)return n;const a=os.createTransformer(e),r="number"!=typeof i[0]?1:0,o=s.x.scale*t.x,l=s.y.scale*t.y;i[0+r]/=o,i[1+r]/=l;const c=ds(o,l,.5);return"number"==typeof i[2+r]&&(i[2+r]/=c),"number"==typeof i[3+r]&&(i[3+r]/=c),a(i)}};let wo=!1;class So extends s.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:s,layoutId:n}=this.props,{projection:i}=e;!function(e){for(const t in e)na[t]=e[t],kt(t)&&(na[t].isCSSVariable=!0)}(To),i&&(t.group&&t.group.add(i),s&&s.register&&n&&s.register(i),wo&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),vo.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:s,drag:n,isPresent:i}=this.props,{projection:a}=s;return a?(a.isPresent=i,wo=!0,n||e.layoutDependency!==t||void 0===t||e.isPresent!==i?a.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?a.promote():a.relegate()||jt.postRender(()=>{const e=a.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),gi.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:s}=this.props,{projection:n}=e;wo=!0,n&&(n.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(n),s&&s.deregister&&s.deregister(n))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Co(t){const[n,i]=Bi(),a=s.useContext(Fe);return e.jsx(So,{...t,layoutGroup:a,switchLayoutGroup:s.useContext(Fa),isPresent:n,safeToRemove:i})}const To={borderRadius:{...jo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:jo,borderTopRightRadius:jo,borderBottomLeftRadius:jo,borderBottomRightRadius:jo,boxShadow:No};const Do=(e,t)=>e.depth-t.depth;class Po{constructor(){this.children=[],this.isDirty=!1}add(e){Oe(this.children,e),this.isDirty=!0}remove(e){Ue(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Do),this.isDirty=!1,this.children.forEach(e)}}const ko=["TopLeft","TopRight","BottomLeft","BottomRight"],Mo=ko.length,Eo=e=>"string"==typeof e?parseFloat(e):e,Ao=e=>"number"==typeof e||Xt.test(e);function Vo(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const Io=Ro(0,.5,ut),Fo=Ro(.5,.95,Ke);function Ro(e,t,s){return n=>n<e?0:n>t?1:s(Ze(e,t,n))}function Bo(e,t){e.min=t.min,e.max=t.max}function Lo(e,t){Bo(e.x,t.x),Bo(e.y,t.y)}function $o(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Oo(e,t,s,n,i){return e=Xa(e-=t,1/s,n),void 0!==i&&(e=Xa(e,1/i,n)),e}function Uo(e,t,[s,n,i],a,r){!function(e,t=0,s=1,n=.5,i,a=e,r=e){Yt.test(t)&&(t=parseFloat(t),t=ds(r.min,r.max,t/100)-r.min);if("number"!=typeof t)return;let o=ds(a.min,a.max,n);e===a&&(o-=t),e.min=Oo(e.min,t,s,o,i),e.max=Oo(e.max,t,s,o,i)}(e,t[s],t[n],t[i],t.scale,a,r)}const zo=["x","scaleX","originX"],Wo=["y","scaleY","originY"];function qo(e,t,s,n){Uo(e.x,t,zo,s?s.x:void 0,n?n.x:void 0),Uo(e.y,t,Wo,s?s.y:void 0,n?n.y:void 0)}function Ho(e){return 0===e.translate&&1===e.scale}function Yo(e){return Ho(e.x)&&Ho(e.y)}function Xo(e,t){return e.min===t.min&&e.max===t.max}function Ko(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Go(e,t){return Ko(e.x,t.x)&&Ko(e.y,t.y)}function _o(e){return Xr(e.x)/Xr(e.y)}function Zo(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Qo{constructor(){this.members=[]}add(e){Oe(this.members,e),e.scheduleRender()}remove(e){if(Ue(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let s;for(let n=t;n>=0;n--){const e=this.members[n];if(!1!==e.isPresent){s=e;break}}return!!s&&(this.promote(s),!0)}promote(e,t){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,t&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:n}=e.options;!1===n&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:s}=e;t.onExitComplete&&t.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Jo=["","X","Y","Z"];let el=0;function tl(e,t,s,n){const{latestValues:i}=t;i[e]&&(s[e]=i[e],t.setStaticValue(e,0),n&&(n[e]=0))}function sl(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const s=br(t);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:t,layoutId:n}=e.options;window.MotionCancelOptimisedAnimation(s,"transform",jt,!(t||n))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&sl(n)}function nl({attachResizeListener:e,defaultParent:t,measureScroll:s,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(e={},s=t?.()){this.id=el++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(rl),this.nodes.forEach(hl),this.nodes.forEach(pl),this.nodes.forEach(ol)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=s?s.root||s:this,this.path=s?[...s.path,s]:[],this.parent=s,this.depth=s?s.depth+1:0;for(let t=0;t<this.path.length;t++)this.path[t].shouldResetTransform=!0;this.root===this&&(this.nodes=new Po)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Qe),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){const s=this.eventHandlers.get(e);s&&s.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t){if(this.instance)return;var s;this.isSVG=ki(t)&&!(ki(s=t)&&"svg"===s.tagName),this.instance=t;const{layoutId:n,layout:i,visualElement:a}=this.options;if(a&&!a.current&&a.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(i||n)&&(this.isLayoutDirty=!0),e){let s,n=0;const i=()=>this.root.updateBlockedByResize=!1;jt.read(()=>{n=window.innerWidth}),e(t,()=>{const e=window.innerWidth;e!==n&&(n=e,this.root.updateBlockedByResize=!0,s&&s(),s=function(e,t){const s=Dt.now(),n=({timestamp:i})=>{const a=i-s;a>=t&&(Nt(n),e(a-t))};return jt.setup(n,!0),()=>Nt(n)}(i,250),vo.hasAnimatedSinceResize&&(vo.hasAnimatedSinceResize=!1,this.nodes.forEach(ml)))})}n&&this.root.registerSharedNode(n,this),!1!==this.options.animate&&a&&(n||i)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeLayoutChanged:s,layout:n})=>{if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const i=this.options.transition||a.getDefaultTransition()||bl,{onLayoutAnimationStart:r,onLayoutAnimationComplete:o}=a.getProps(),l=!this.targetLayout||!Go(this.targetLayout,n),c=!t&&s;if(this.options.layoutRoot||this.resumeFrom||c||t&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const t={...Gn(i,"layout"),onPlay:r,onComplete:o};(a.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t),this.setAnimationOrigin(e,c)}else t||ml(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=n})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Nt(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(fl),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&sl(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let i=0;i<this.path.length;i++){const e=this.path[i];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:s}=this.options;if(void 0===t&&!s)return;const n=this.getTransformTemplate();this.prevTransformTemplateValue=n?n(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(cl);if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(dl);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(ul),this.nodes.forEach(il),this.nodes.forEach(al)):this.nodes.forEach(dl),this.clearAllSnapshots();const e=Dt.now();wt.delta=ze(0,1e3/60,e-wt.timestamp),wt.timestamp=e,wt.isProcessing=!0,St.update.process(wt),St.preRender.process(wt),St.render.process(wt),wt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,gi.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(ll),this.sharedNodes.forEach(gl)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,jt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){jt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||Xr(this.snapshot.measuredBox.x)||Xr(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance)return;if(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead()||this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let s=0;s<this.path.length;s++){this.path[s].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){const t=n(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!i)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!Yo(this.projectionDelta),s=this.getTransformTemplate(),n=s?s(this.latestValues,""):void 0,a=n!==this.prevTransformTemplateValue;e&&this.instance&&(t||qa(this.latestValues)||a)&&(i(this.instance,n),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){const t=this.measurePageBox();let s=this.removeElementScroll(t);var n;return e&&(s=this.removeTransform(s)),wl((n=s).x),wl(n.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:s,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:e}=this.options;if(!e)return{x:{min:0,max:0},y:{min:0,max:0}};const t=e.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(Cl))){const{scroll:e}=this.root;e&&(Ja(t.x,e.offset.x),Ja(t.y,e.offset.y))}return t}removeElementScroll(e){const t={x:{min:0,max:0},y:{min:0,max:0}};if(Lo(t,e),this.scroll?.wasRoot)return t;for(let s=0;s<this.path.length;s++){const n=this.path[s],{scroll:i,options:a}=n;n!==this.root&&i&&a.layoutScroll&&(i.wasRoot&&Lo(t,e),Ja(t.x,i.offset.x),Ja(t.y,i.offset.y))}return t}applyTransform(e,t=!1){const s={x:{min:0,max:0},y:{min:0,max:0}};Lo(s,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&tr(s,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),qa(e.latestValues)&&tr(s,e.latestValues)}return qa(this.latestValues)&&tr(s,this.latestValues),s}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};Lo(t,e);for(let s=0;s<this.path.length;s++){const e=this.path[s];if(!e.instance)continue;if(!qa(e.latestValues))continue;Wa(e.latestValues)&&e.updateSnapshot();const n=nr();Lo(n,e.measurePageBox()),qo(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,n)}return qa(this.latestValues)&&qo(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==wt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){const t=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=t.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=t.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=t.isSharedProjectionDirty);const s=Boolean(this.resumingFrom)||this!==t;if(!(e||s&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:n,layoutId:i}=this.options;if(this.layout&&(n||i)){if(this.resolvedRelativeTargetAt=wt.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Qr(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),Lo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}var a,r,o;if(this.relativeTarget||this.targetDelta)if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),a=this.target,r=this.relativeTarget,o=this.relativeParent.target,_r(a.x,r.x,o.x),_r(a.y,r.y,o.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):Lo(this.target,this.layout.layoutBox),_a(this.target,this.targetDelta)):Lo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Qr(this.relativeTargetOrigin,this.target,e.target),Lo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(this.parent&&!Wa(this.parent.latestValues)&&!Ha(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const e=this.getLead(),t=Boolean(this.resumingFrom)||this!==e;let s=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(s=!1),t&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(s=!1),this.resolvedRelativeTargetAt===wt.timestamp&&(s=!1),s)return;const{layout:n,layoutId:i}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!n&&!i)return;Lo(this.layoutCorrected,this.layout.layoutBox);const a=this.treeScale.x,r=this.treeScale.y;!function(e,t,s,n=!1){const i=s.length;if(!i)return;let a,r;t.x=t.y=1;for(let o=0;o<i;o++){a=s[o],r=a.projectionDelta;const{visualElement:i}=a.options;i&&i.props.style&&"contents"===i.props.style.display||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&tr(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),r&&(t.x*=r.x.scale,t.y*=r.y.scale,_a(e,r)),n&&qa(a.latestValues)&&tr(e,a.latestValues))}t.x<Qa&&t.x>Za&&(t.x=1),t.y<Qa&&t.y>Za&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,t),!e.layout||e.target||1===this.treeScale.x&&1===this.treeScale.y||(e.target=e.layout.layoutBox,e.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:o}=e;o?(this.projectionDelta&&this.prevProjectionDelta?($o(this.prevProjectionDelta.x,this.projectionDelta.x),$o(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),Gr(this.projectionDelta,this.layoutCorrected,o,this.latestValues),this.treeScale.x===a&&this.treeScale.y===r&&Zo(this.projectionDelta.x,this.prevProjectionDelta.x)&&Zo(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",o))):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){if(this.options.visualElement?.scheduleRender(),e){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e,t=!1){const s=this.snapshot,n=s?s.latestValues:{},i={...this.latestValues},a={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const r={x:{min:0,max:0},y:{min:0,max:0}},o=(s?s.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,d=Boolean(o&&!c&&!0===this.options.crossfade&&!this.path.some(vl));let u;this.animationProgress=0,this.mixTargetDelta=t=>{const s=t/1e3;var l,m,h,p,f,g;yl(a.x,e.x,s),yl(a.y,e.y,s),this.setTargetDelta(a),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qr(r,this.layout.layoutBox,this.relativeParent.layout.layoutBox),h=this.relativeTarget,p=this.relativeTargetOrigin,f=r,g=s,xl(h.x,p.x,f.x,g),xl(h.y,p.y,f.y,g),u&&(l=this.relativeTarget,m=u,Xo(l.x,m.x)&&Xo(l.y,m.y))&&(this.isProjectionDirty=!1),u||(u={x:{min:0,max:0},y:{min:0,max:0}}),Lo(u,this.relativeTarget)),o&&(this.animationValues=i,function(e,t,s,n,i,a){i?(e.opacity=ds(0,s.opacity??1,Io(n)),e.opacityExit=ds(t.opacity??1,0,Fo(n))):a&&(e.opacity=ds(t.opacity??1,s.opacity??1,n));for(let r=0;r<Mo;r++){const i=`border${ko[r]}Radius`;let a=Vo(t,i),o=Vo(s,i);void 0===a&&void 0===o||(a||(a=0),o||(o=0),0===a||0===o||Ao(a)===Ao(o)?(e[i]=Math.max(ds(Eo(a),Eo(o),n),0),(Yt.test(o)||Yt.test(a))&&(e[i]+="%")):e[i]=o)}(t.rotate||s.rotate)&&(e.rotate=ds(t.rotate||0,s.rotate||0,n))}(i,n,this.latestValues,s,d,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=s},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Nt(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=jt.update(()=>{vo.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=fi(0)),this.currentAnimation=function(e,t,s){const n=Mi(e)?e:fi(e);return n.start(Tr("",n,t,s)),n.animation}(this.motionValue,[0,1e3],{...e,velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:s,layout:n,latestValues:i}=e;if(t&&s&&n){if(this!==e&&this.layout&&n&&Sl(this.options.animationType,this.layout.layoutBox,n.layoutBox)){s=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=Xr(this.layout.layoutBox.x);s.x.min=e.target.x.min,s.x.max=s.x.min+t;const n=Xr(this.layout.layoutBox.y);s.y.min=e.target.y.min,s.y.max=s.y.min+n}Lo(t,s),tr(t,i),Gr(this.projectionDeltaWithTransform,this.layoutCorrected,t,i)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new Qo);this.sharedNodes.get(e).add(t);const s=t.options.initialPromotionConfig;t.promote({transition:s?s.transition:void 0,preserveFollowOpacity:s&&s.shouldPreserveFollowOpacity?s.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){const{layoutId:e}=this.options;return e&&this.getStack()?.lead||this}getPrevLead(){const{layoutId:e}=this.options;return e?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:s}={}){const n=this.getStack();n&&n.promote(this,s),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:s}=e;if((s.z||s.rotate||s.rotateX||s.rotateY||s.rotateZ||s.skewX||s.skewY)&&(t=!0),!t)return;const n={};s.z&&tl("z",e,n,this.animationValues);for(let i=0;i<Jo.length;i++)tl(`rotate${Jo[i]}`,e,n,this.animationValues),tl(`skew${Jo[i]}`,e,n,this.animationValues);e.render();for(const i in n)e.setStaticValue(i,n[i]),this.animationValues&&(this.animationValues[i]=n[i]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible)return void(e.visibility="hidden");const s=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=wa(t?.pointerEvents)||"",void(e.transform=s?s(this.latestValues,""):"none");const n=this.getLead();if(!this.projectionDelta||!this.layout||!n.target)return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=wa(t?.pointerEvents)||""),void(this.hasProjected&&!qa(this.latestValues)&&(e.transform=s?s({},""):"none",this.hasProjected=!1));e.visibility="";const i=n.animationValues||n.latestValues;this.applyTransformsToTarget();let a=function(e,t,s){let n="";const i=e.x.translate/t.x,a=e.y.translate/t.y,r=s?.z||0;if((i||a||r)&&(n=`translate3d(${i}px, ${a}px, ${r}px) `),1===t.x&&1===t.y||(n+=`scale(${1/t.x}, ${1/t.y}) `),s){const{transformPerspective:e,rotate:t,rotateX:i,rotateY:a,skewX:r,skewY:o}=s;e&&(n=`perspective(${e}px) ${n}`),t&&(n+=`rotate(${t}deg) `),i&&(n+=`rotateX(${i}deg) `),a&&(n+=`rotateY(${a}deg) `),r&&(n+=`skewX(${r}deg) `),o&&(n+=`skewY(${o}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return 1===o&&1===l||(n+=`scale(${o}, ${l})`),n||"none"}(this.projectionDeltaWithTransform,this.treeScale,i);s&&(a=s(i,a)),e.transform=a;const{x:r,y:o}=this.projectionDelta;e.transformOrigin=`${100*r.origin}% ${100*o.origin}% 0`,n.animationValues?e.opacity=n===this?i.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:i.opacityExit:e.opacity=n===this?void 0!==i.opacity?i.opacity:"":void 0!==i.opacityExit?i.opacityExit:0;for(const l in na){if(void 0===i[l])continue;const{correct:t,applyTo:s,isCSSVariable:r}=na[l],o="none"===a?i[l]:t(i[l],n);if(s){const t=s.length;for(let n=0;n<t;n++)e[s[n]]=o}else r?this.options.visualElement.renderState.vars[l]=o:e[l]=o}this.options.layoutId&&(e.pointerEvents=n===this?wa(t?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>e.currentAnimation?.stop()),this.root.nodes.forEach(cl),this.root.sharedNodes.clear()}}}function il(e){e.updateLayout()}function al(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:n}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;"size"===i?Jr(e=>{const n=a?t.measuredBox[e]:t.layoutBox[e],i=Xr(n);n.min=s[e].min,n.max=n.min+i}):Sl(i,t.layoutBox,s)&&Jr(n=>{const i=a?t.measuredBox[n]:t.layoutBox[n],r=Xr(s[n]);i.max=i.min+r,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[n].max=e.relativeTarget[n].min+r)});const r={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};Gr(r,s,t.layoutBox);const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};a?Gr(o,e.applyTransform(n,!0),t.measuredBox):Gr(o,s,t.layoutBox);const l=!Yo(r);let c=!1;if(!e.resumeFrom){const n=e.getClosestProjectingParent();if(n&&!n.resumeFrom){const{snapshot:i,layout:a}=n;if(i&&a){const r={x:{min:0,max:0},y:{min:0,max:0}};Qr(r,t.layoutBox,i.layoutBox);const o={x:{min:0,max:0},y:{min:0,max:0}};Qr(o,s,a.layoutBox),Go(r,o)||(c=!0),n.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=r,e.relativeParent=n)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:o,layoutDelta:r,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function rl(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function ol(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function ll(e){e.clearSnapshot()}function cl(e){e.clearMeasurements()}function dl(e){e.isLayoutDirty=!1}function ul(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function ml(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function hl(e){e.resolveTargetDelta()}function pl(e){e.calcProjection()}function fl(e){e.resetSkewAndRotation()}function gl(e){e.removeLeadSnapshot()}function yl(e,t,s){e.translate=ds(t.translate,0,s),e.scale=ds(t.scale,1,s),e.origin=t.origin,e.originPoint=t.originPoint}function xl(e,t,s,n){e.min=ds(t.min,s.min,n),e.max=ds(t.max,s.max,n)}function vl(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const bl={duration:.45,ease:[.4,0,.1,1]},jl=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Nl=jl("applewebkit/")&&!jl("chrome/")?Math.round:Ke;function wl(e){e.min=Nl(e.min),e.max=Nl(e.max)}function Sl(e,t,s){return"position"===e||"preserve-aspect"===e&&(n=_o(t),i=_o(s),a=.2,!(Math.abs(n-i)<=a));var n,i,a}function Cl(e){return e!==e.root&&e.scroll?.wasRoot}const Tl=nl({attachResizeListener:(e,t)=>qr(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Dl={current:void 0},Pl=nl({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Dl.current){const e=new Tl({});e.mount(window),e.setOptions({layoutScroll:!0}),Dl.current=e}return Dl.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),kl={pan:{Feature:class extends Ur{constructor(){super(...arguments),this.removePointerDownListener=Ke}onPointerDown(e){this.session=new so(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:eo(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:s,onPanEnd:n}=this.node.getProps();return{onSessionStart:xo(e),onStart:xo(t),onMove:s,onEnd:(e,t)=>{delete this.session,n&&jt.postRender(()=>n(e,t))}}}mount(){this.removePointerDownListener=Yr(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends Ur{constructor(e){super(e),this.removeGroupControls=Ke,this.removeListeners=Ke,this.controls=new go(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ke}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:Pl,MeasureLayout:Co}};function Ml(e,t,s){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover","Start"===s);const i=n["onHover"+s];i&&jt.postRender(()=>i(t,Hr(t)))}function El(e,t,s){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap","Start"===s);const i=n["onTap"+("End"===s?"":s)];i&&jt.postRender(()=>i(t,Hr(t)))}const Al=new WeakMap,Vl=new WeakMap,Il=e=>{const t=Al.get(e.target);t&&t(e)},Fl=e=>{e.forEach(Il)};function Rl(e,t,s){const n=function({root:e,...t}){const s=e||document;Vl.has(s)||Vl.set(s,{});const n=Vl.get(s),i=JSON.stringify(t);return n[i]||(n[i]=new IntersectionObserver(Fl,{root:e,...t})),n[i]}(t);return Al.set(e,s),n.observe(e),()=>{Al.delete(e),n.unobserve(e)}}const Bl={some:0,all:1};const Ll=Oa({...Wr,...{inView:{Feature:class extends Ur{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:s,amount:n="some",once:i}=e,a={root:t?t.current:void 0,rootMargin:s,threshold:"number"==typeof n?n:Bl[n]};return Rl(this.node.current,a,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,i&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:s,onViewportLeave:n}=this.node.getProps(),a=t?s:n;a&&a(e)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return s=>e[s]!==t[s]}(e,t))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends Ur{mount(){const{current:e}=this.node;e&&(this.unmount=Pi(e,(e,t)=>(El(this.node,t,"Start"),(e,{success:t})=>El(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends Ur{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=_e(qr(this.node.current,"focus",()=>this.onFocus()),qr(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends Ur{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t,s={}){const[n,i,a]=vi(e,s),r=e=>{if(!bi(e))return;const{target:s}=e,n=t(s,e);if("function"!=typeof n||!s)return;const a=e=>{bi(e)&&(n(e),s.removeEventListener("pointerleave",a))};s.addEventListener("pointerleave",a,i)};return n.forEach(e=>{e.addEventListener("pointerenter",r,i)}),a}(e,(e,t)=>(Ml(this.node,t,"Start"),e=>Ml(this.node,e,"End"))))}unmount(){}}}},...kl,...{layout:{ProjectionNode:Pl,MeasureLayout:Co}}},pr),$l=({formData:n,updateFormData:i,nextStep:a,prevStep:r,hideBack:o,isContractor:l,contractorGroupId:c})=>{const[d,u]=s.useState(!1),[b,j]=s.useState(!1),{t:N}=g(),[w,S]=s.useState([]),C=E(),{list:T,loading:P}=A(e=>e.users),{list:k}=A(e=>e.locations),M=JSON.parse(localStorage.getItem("user")),I=M.userId,F=D(M,"admin:users"),R=m().shape({customerName:h().required(N("proposals.create.customerInfo.validation.customerName")),description:h().required(N("proposals.create.customerInfo.validation.description")),...F&&{designer:h().required(N("proposals.create.customerInfo.validation.designer"))}});s.useEffect(()=>{F&&C(y()),C(x())},[C,F]),s.useEffect(()=>{const e=localStorage.getItem("token"),t=e?{Authorization:`Bearer ${e}`}:{};let s="/api/customers";l&&c&&(s+=`?group_id=${c}`),v.get(s,{headers:t}).then(e=>{const t=e.data.data.map(e=>({label:e.name,value:e.name,data:e}));S(t)}).catch(e=>{})},[C,l,c]),s.useEffect(()=>{if(k.length>0&&!n.location){const e=k.find(e=>"main"===e.locationName.trim().toLowerCase());e&&i({location:e.id.toString()})}},[k]),s.useEffect(()=>{if(F&&T.length>0){const e=T.find(e=>e.id===I),t=T.filter(e=>"Manufacturers"===e.role),s=t.some(e=>e.id==n.designer);if(!n.designer||""===n.designer||!s)if(e&&"Manufacturers"===e.role)i({designer:e.id});else if(e&&("Admin"===e.role||"User"===e.role)&&t.length>0){const e=t[0];i({designer:e.id})}}},[T,F,I,n.designer,i]);const B=()=>u(!d),L=T.filter(e=>"Manufacturers"===e.role).map(e=>({value:e.id,label:e.name})),K=k.map(e=>({label:e.locationName,value:e.id.toString()}));return e.jsx("div",{className:"w-100 my-4 proposal-form-mobile",children:e.jsx($,{children:e.jsxs(O,{className:"p-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("h4",{className:"fw-semibold mb-0",children:N("proposals.create.customerInfo.title")}),!o&&e.jsx(U,{color:"secondary",variant:"outline",onClick:r,style:{borderRadius:"6px",minWidth:"90px"},children:N("common.back")})]}),e.jsx(p,{initialValues:n,enableReinitialize:!0,validationSchema:R,onSubmit:e=>{i(e),a()},children:({values:s,errors:a,touched:r,handleChange:o,handleBlur:l,handleSubmit:c,setFieldValue:u})=>e.jsxs(z,{onSubmit:c,children:[e.jsxs("div",{className:"form-section",children:[e.jsxs(W,{className:"mb-3",children:[e.jsxs(q,{md:6,children:[e.jsxs(H,{htmlFor:"customerName",children:[N("proposals.create.customerInfo.customerName")," *"]}),e.jsx(f,{isClearable:!0,options:w,value:w.find(e=>e.value===s.customerName)||(s.customerName?{label:s.customerName,value:s.customerName}:null),onChange:e=>{const t=e?.value||"",s=e?.data?.email||"",a=e?.data?.id||"";i({...n,customerName:t,customerEmail:s,customerId:a}),u("customerName",t),u("customerEmail",s),u("customerId",a)},onCreateOption:e=>{i({...n,customerName:e,customerEmail:"",customerId:""}),u("customerName",e),u("customerEmail",""),u("customerId","")},onBlur:l,inputId:"customerName",placeholder:N("proposals.create.customerInfo.customerNamePlaceholder"),isLoading:P}),a.customerName&&r.customerName&&e.jsx("div",{className:"text-danger small mt-1",children:a.customerName})]}),e.jsxs(q,{md:6,children:[e.jsx(H,{htmlFor:"customerEmail",children:N("proposals.create.customerInfo.customerEmail")}),e.jsx(Y,{type:"email",id:"customerEmail",name:"customerEmail",value:s.customerEmail,onChange:e=>{u("customerEmail",e.target.value),i({customerEmail:e.target.value})},placeholder:N("proposalCommon.emailPlaceholder")})]})]}),e.jsxs(W,{className:"mb-3",children:[F&&e.jsxs(q,{md:6,children:[e.jsxs(H,{htmlFor:"designer",children:[N("proposals.create.customerInfo.designer")," *"]}),e.jsx(f,{isClearable:!0,isLoading:b,isDisabled:b,id:"designer",name:"designer",options:L,value:L.find(e=>e.value===s.designer)||null,onChange:e=>{const t=e?.value||"";u("designer",t),i({designer:t})},onCreateOption:async e=>{const t=await(async e=>{try{j(!0);const t=localStorage.getItem("token"),s=t?{Authorization:`Bearer ${t}`}:{},n=`${e.toLowerCase().replace(/\s+/g,".")}@designer.local`,i=await v.post("/api/users",{name:e,email:n,password:"temppassword123",role:"Manufacturers",isSalesRep:!1,location:null,userGroup:null},{headers:s});if(200===i.status||201===i.status)return await C(y()),i.data.user}catch(t){return alert(`Error creating designer "${e}". Please try again.`),null}finally{j(!1)}})(e);t&&(u("designer",t.id),i({designer:t.id}))},onBlur:l,placeholder:b?"Creating designer...":"Select or create a designer...",formatCreateLabel:e=>`Create designer: "${e}"`}),a.designer&&r.designer&&e.jsx("div",{className:"text-danger small mt-1",children:a.designer})]}),e.jsxs(q,{md:6,children:[e.jsxs(H,{htmlFor:"description",children:[N("proposals.create.customerInfo.description")," *"]}),e.jsx(Y,{type:"text",id:"description",name:"description",value:s.description,onChange:e=>{u("description",e.target.value),i({description:e.target.value})},onBlur:l,placeholder:N("proposals.create.customerInfo.descriptionPlaceholder")}),a.description&&r.description&&e.jsx("div",{className:"text-danger small mt-1",children:a.description})]})]}),e.jsx("h5",{className:"mb-3 mt-4",children:N("proposals.create.customerInfo.schedule")}),e.jsxs(W,{className:"mb-4",children:[e.jsxs(q,{md:6,className:"d-flex flex-column",children:[e.jsx("div",{className:"d-flex align-items-center mb-3 mt-3",children:e.jsx(X,{id:"measurementDone",label:N("proposals.create.customerInfo.measurementDone"),name:"measurementDone",checked:s.measurementDone,onChange:e=>{const t=e.target.checked;u("measurementDone",t),i({measurementDone:t})},className:"me-3"})}),e.jsx(H,{htmlFor:"measurementDate",children:s.measurementDone?N("proposals.create.customerInfo.measurementDoneDate"):N("proposals.create.customerInfo.measurementScheduledDate")}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(t,{id:"measurementDate",selected:s.measurementDate?new Date(s.measurementDate):null,onChange:e=>{u("measurementDate",e)},className:"form-control",dateFormat:"MM/dd/yyyy",placeholderText:s.measurementDone?N("proposals.create.customerInfo.measurementDoneDate"):N("proposals.create.customerInfo.measurementScheduledDate"),wrapperClassName:"w-100"}),e.jsx(V,{style:{position:"absolute",top:"50%",right:"12px",transform:"translateY(-50%)",color:"#6c757d",pointerEvents:"none"}})]})]}),e.jsxs(q,{md:6,className:"d-flex flex-column",children:[e.jsx("div",{className:"d-flex align-items-center mb-3 mt-3",children:e.jsx(X,{id:"designDone",label:N("proposals.create.customerInfo.designDone"),name:"designDone",checked:s.designDone,onChange:e=>{const t=e.target.checked;u("designDone",t),i({designDone:t})},className:"me-3"})}),e.jsx(H,{htmlFor:"designDate",children:s.designDone?N("proposals.create.customerInfo.designDoneDate"):N("proposals.create.customerInfo.designScheduledDate")}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(t,{id:"designDate",selected:s.designDate?new Date(s.designDate):null,onChange:e=>{u("designDate",e)},className:"form-control",dateFormat:"MM/dd/yyyy",placeholderText:s.designDone?N("proposals.create.customerInfo.designDoneDate"):N("proposals.create.customerInfo.designScheduledDate"),wrapperClassName:"w-100"}),e.jsx(V,{style:{position:"absolute",top:"50%",right:"12px",transform:"translateY(-50%)",color:"#6c757d",pointerEvents:"none"}})]})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx(U,{color:"link",className:"text-decoration-none p-0",onClick:B,children:N(d?"proposals.create.customerInfo.hideOptions":"proposals.create.customerInfo.moreOptions")})}),e.jsx(Oi,{children:d&&e.jsxs(Ll.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[e.jsx("h5",{className:"mb-3 mt-4",children:N("proposals.create.customerInfo.additionalInfo")}),e.jsxs(W,{className:"mb-3",children:[e.jsxs(q,{md:6,children:[e.jsxs(H,{htmlFor:"location",children:[N("profile.location")," *"]}),e.jsx(f,{isClearable:!0,options:K,value:K.find(e=>e.value===s.location)||(s.location?{label:s.location,value:s.location}:null),onChange:e=>{const t=e?.value||"";u("location",t),i({...n,location:t})},onBlur:l,inputId:"location"})]}),e.jsxs(q,{md:6,children:[e.jsx(H,{htmlFor:"salesRep",children:N("proposals.create.customerInfo.salesRep")}),e.jsx(f,{isClearable:!0,id:"salesRep",name:"salesRep",options:L,value:L.find(e=>e.value===s.salesRep)||null,onChange:e=>{u("salesRep",e?.value||""),i({salesRep:e?.value||""})},onBlur:l})]})]}),e.jsxs(W,{className:"mb-3",children:[e.jsxs(q,{md:6,children:[e.jsx(H,{htmlFor:"leadSource",children:N("form.labels.leadSource")}),e.jsx(f,{isClearable:!0,options:[{label:N("proposals.create.customerInfo.sources.existing"),value:"Existing customer"},{label:N("proposals.create.customerInfo.sources.online"),value:"Online"},{label:N("form.sources.walkIn"),value:"Walk-in"},{label:N("form.sources.referral"),value:"Referral"},{label:N("proposals.create.customerInfo.sources.call"),value:"Call"},{label:N("proposals.create.customerInfo.sources.email"),value:"Email"}],value:["Existing customer","Online","Walk-in","Referral","Call","Email"].map(e=>({label:e,value:e})).find(e=>e.value===s.leadSource)||null,onChange:e=>{u("leadSource",e?.value||""),i({leadSource:e?.value||""})},onBlur:l,inputId:"leadSource"})]}),e.jsxs(q,{md:6,children:[e.jsx(H,{htmlFor:"type",children:N("proposals.create.customerInfo.type")}),e.jsx(f,{isClearable:!0,options:[{label:N("form.types.homeOwner"),value:"Home Owner"},{label:N("form.types.contractor"),value:"Contractor"},{label:N("proposals.create.customerInfo.types.builder"),value:"Builder"},{label:N("proposals.create.customerInfo.types.architect"),value:"Architect"},{label:N("proposals.create.customerInfo.types.interiorDesigner"),value:"Interior Designer"}],value:["Home Owner","Contractor","Builder","Architect","Interior Designer"].map(e=>({label:e,value:e})).find(e=>e.value===s.type)||null,onChange:e=>{u("type",e?.value||""),i({type:e?.value||""})},onBlur:l,inputId:"type"})]})]})]})})]})," ",e.jsx("div",{className:"button-group",children:e.jsx(U,{type:"submit",style:{borderRadius:"6px",minWidth:"90px"},color:"success",children:N("common.next","Next")})})]})})]})})})},Ol=({formData:t,updateFormData:i,nextStep:a,prevStep:r,hideBack:o})=>{const{t:l}=g(),c=E(),{list:d,loading:u}=A(e=>e.manufacturers),f=A(e=>e.auth?.user),y=P(f),x="https://app.nj.contractors",[v,j]=s.useState(null),N=s.useMemo(()=>d.filter(e=>!1!==e.enabled),[d]);s.useEffect(()=>{c(b())},[c]),s.useEffect(()=>{if(t.manufacturer&&N.length>0){const e=N.find(e=>e.id==t.manufacturer);e&&j(e)}},[t.manufacturer,N]);const w=s.useMemo(()=>m().shape({manufacturer:h().required(l("proposals.create.manufacturer.validation.manufacturerRequired")),...y?{versionName:h().required(l("proposals.create.manufacturer.validation.versionNameRequired"))}:{}}),[l,y]),S=s.useCallback((e,s)=>{j(e);const n=t.versionName&&t.versionName.trim()?t.versionName:e.name||"";s("manufacturer",e.id),s("versionName",n);const r={manufacturer:e.id,versionName:n||""};i({...t,manufacturer:e.id,manufacturerId:e.id,versionName:n,manufacturersData:[r]}),a()},[t,i,a]),C=n.memo(({manufacturer:t,isSelected:n,onClick:i})=>{const[a,r]=s.useState(!1),[o,c]=s.useState(!1),d=s.useCallback(()=>{r(!0),c(!0)},[]),u=s.useCallback(()=>{c(!0),r(!1)},[]),m=s.useMemo(()=>!t.image||a?"/images/nologo.png":`${x}/uploads/images/${t.image}`,[t.image,a,x]),h=s.useMemo(()=>({cursor:"pointer",transition:"all 0.3s ease",borderWidth:n?"2px":"1px",backgroundColor:n?"#f8f9ff":"#fff",position:"relative",overflow:"hidden"}),[n]),p=s.useMemo(()=>({maxWidth:"100%",maxHeight:"80px",objectFit:"contain",borderRadius:"8px",filter:n?"brightness(1.1)":"brightness(1)",transition:"filter 0.3s ease",backgroundColor:a?"#f8f9fa":"transparent",border:a?"2px dashed #dee2e6":"none",opacity:o?1:.7}),[n,a,o]),f=s.useMemo(()=>({fontSize:"0.9rem",color:n?"#0d6efd":"#495057",transition:"color 0.3s ease"}),[n]);return e.jsx(Ll.div,{className:"h-100",whileHover:{scale:1.02},whileTap:{scale:.98},transition:{duration:.2},children:e.jsxs($,{className:"h-100 manufacturer-card "+(n?"border-primary shadow-lg":"border-light shadow-sm"),style:h,onClick:i,children:[n&&e.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"#0d6efd",color:"white",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",zIndex:2},children:"✓"}),e.jsxs(O,{className:"text-center p-3 d-flex flex-column",children:[e.jsx("div",{className:"manufacturer-logo-container mb-3",style:{flex:"1",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"80px"},children:e.jsx("img",{src:m,alt:t.name,style:p,onError:d,onLoad:u,loading:"lazy"})}),e.jsx("h6",{className:"manufacturer-name mb-0 fw-semibold",style:f,children:t.name}),(t.assembledEtaDays||t.unassembledEtaDays)&&e.jsxs("div",{className:"mt-2",children:[e.jsx("small",{className:"text-muted d-block mb-1",children:e.jsx("strong",{children:l("proposals.create.manufacturer.eta.title","Estimated Delivery Time")})}),t.assembledEtaDays&&e.jsxs("small",{className:"text-success d-block",children:["📦 ",l("proposals.create.manufacturer.eta.assembled","Assembled"),": ",t.assembledEtaDays," ",l("proposals.create.manufacturer.eta.days","days")]}),t.unassembledEtaDays&&e.jsxs("small",{className:"text-info d-block",children:["📋 ",l("proposals.create.manufacturer.eta.unassembled","Unassembled"),": ",t.unassembledEtaDays," ",l("proposals.create.manufacturer.eta.days","days")]})]})]})]})})});return e.jsx("div",{className:"my-4 w-100 proposal-form-mobile",children:e.jsx($,{children:e.jsxs(O,{className:"p-4",children:[e.jsx("h4",{className:"mb-4 fw-semibold",children:l("proposals.create.manufacturer.title")}),e.jsx(p,{initialValues:{manufacturer:t.manufacturer||"",versionName:t.versionName||""},enableReinitialize:!0,validationSchema:w,onSubmit:e=>{const s={manufacturer:e.manufacturer,versionName:e.versionName||""};i({...t,manufacturersData:[s],manufacturerId:e.manufacturer}),a()},children:({values:t,errors:s,touched:n,handleChange:i,handleBlur:a,setFieldValue:c,handleSubmit:d})=>e.jsxs(z,{onSubmit:d,noValidate:!0,children:[e.jsxs("div",{className:"form-section",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs(H,{className:"fw-semibold mb-3",children:[l("proposals.create.manufacturer.labels.manufacturer")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),u?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"text-muted mt-2 mb-0",children:"Loading manufacturers..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"g-3 mb-3",children:N.map(t=>e.jsx(q,{xs:6,md:4,lg:3,className:"manufacturer-grid-item",children:e.jsx(C,{manufacturer:t,isSelected:v?.id===t.id,onClick:()=>S(t,c)})},t.id))}),s.manufacturer&&n.manufacturer&&e.jsx("div",{className:"text-danger small mt-2",children:s.manufacturer})]})]}),y&&e.jsx(W,{className:"mb-4",children:e.jsxs(q,{children:[e.jsxs(H,{htmlFor:"versionName",className:"fw-semibold",children:[l("proposals.create.manufacturer.labels.versionName")," ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(Y,{id:"versionName",name:"versionName",type:"text",placeholder:l("proposals.create.manufacturer.placeholders.enterVersionName"),value:t.versionName,onChange:i,onBlur:a,invalid:!!s.versionName&&n.versionName,style:{height:"42px",borderRadius:"6px"}}),e.jsx(K,{invalid:!0,children:s.versionName})]})})]}),e.jsxs("div",{className:"button-group",children:[!o&&e.jsx(U,{color:"secondary",variant:"outline",onClick:r,style:{borderRadius:"6px",minWidth:"90px"},children:l("common.back")}),e.jsx(U,{type:"submit",color:"primary",style:{borderRadius:"6px",minWidth:"90px"},disabled:!v,children:l("common.next")})]})]})}),y&&e.jsxs("div",{className:"mt-5 p-4 rounded text-center",style:{backgroundColor:"#e9f0f6",border:"1px solid #b3c7db",color:"#2c3e50",fontSize:"0.95rem",margin:"0 auto"},children:[e.jsx("h6",{className:"mb-2 fw-semibold",style:{letterSpacing:"0.03em"},children:l("proposals.create.manufacturer.cta.needAnother")}),e.jsx(U,{color:"primary",variant:"outline",size:"sm",style:{borderRadius:"25px",padding:"6px 20px",fontWeight:"600",letterSpacing:"0.05em",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#0275d8",e.currentTarget.style.color="#fff",e.currentTarget.style.borderColor="#0275d8"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#0275d8",e.currentTarget.style.borderColor="#0275d8"},children:l("proposals.create.manufacturer.cta.addManufacturer")})]})]})})})},Ul=()=>{const e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}},zl=({updateFormData:t,manufacturerData:n,onStyleSelect:i,formData:a,hideBack:r,prevStep:o})=>{const{t:l}=g(),c="https://app.nj.contractors",[d,u]=s.useState("manual"),[m,h]=s.useState(""),[p,f]=s.useState(null),[y,x]=s.useState([]),b=e=>{u(e)},j=y?.length?y.filter(e=>{const t=m.toLowerCase(),s=(e.style||"").toLowerCase().includes(t),n=Array.isArray(e.styleVariants)&&e.styleVariants.some(e=>(e.shortName||"").toLowerCase().includes(t));return!t||s||n}):[];s.useEffect(()=>{const e=a.manufacturersData?.[0]?.manufacturer;e&&N(e)},[a]);const N=async e=>{try{const t=await v.get(`/api/manufacturers/${e}/styles-meta`,{headers:Ul()});t.data&&t.data.styles&&Array.isArray(t.data.styles)?x(t.data.styles):Array.isArray(t.data)?x(t.data):x([])}catch(t){x([])}};return e.jsxs("div",{className:"w-100 proposal-form-mobile",children:[e.jsx($,{className:"my-4 shadow-sm w-100",children:e.jsxs(O,{className:"p-4",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("h5",{className:"mb-4 text-dark fw-semibold",children:l("proposals.create.design.title")}),!r&&e.jsx(U,{color:"secondary",variant:"outline",onClick:o,style:{borderRadius:"6px",minWidth:"90px"},children:l("common.back")})]}),e.jsxs(G,{variant:"tabs",role:"tablist",className:"mb-4 tabs-container d-none d-md-flex",children:[e.jsx(_,{children:e.jsx(Z,{active:"manual"===d,onClick:()=>b("manual"),style:{cursor:"pointer"},children:l("proposals.create.design.tabs.manualEntry")})}),e.jsx(_,{children:e.jsx(Z,{active:"import"===d,onClick:()=>b("import"),style:{cursor:"pointer"},children:l("proposals.create.design.tabs.import2020")})})]}),"import"===d?e.jsxs("div",{className:"form-section text-center py-5",children:[e.jsx("p",{className:"text-muted mb-4",children:l("proposals.create.design.supportedTypes",{types:".TXT, .CSV"})}),e.jsxs("div",{className:"upload-area p-5 border border-dashed rounded mb-4 bg-light d-flex flex-column align-items-center justify-content-center",style:{cursor:"pointer"},onClick:()=>document.getElementById("fileInput").click(),children:[e.jsx("i",{className:"bi bi-cloud-upload fs-1 text-muted mb-3"}),e.jsx("p",{className:"text-muted mb-2",children:l("proposals.create.design.selectExportedFile")}),e.jsx(U,{color:"success",onClick:()=>document.getElementById("fileInput").click(),children:l("proposals.create.design.selectFileCta")}),e.jsx(Y,{type:"file",id:"fileInput",style:{display:"none"},onChange:e=>{const s=e.target.files[0];t({designFile:s})},accept:".txt,.csv"})]}),e.jsx("p",{className:"text-primary mb-2",style:{cursor:"pointer"},onClick:()=>b("manual"),children:l("proposals.create.design.no2020SwitchToManual")}),e.jsxs(U,{color:"link",className:"text-primary p-0",children:[e.jsx("i",{className:"bi bi-question-circle me-1"})," ",l("proposals.create.design.howToExport")]})]}):e.jsxs("div",{className:"form-section text-center py-5",children:[e.jsx("div",{className:"mb-4 d-flex justify-content-center",children:e.jsx(Y,{placeholder:l("proposals.create.design.searchStylePlaceholder"),style:{maxWidth:300},value:m,onChange:e=>h(e.target.value)})}),e.jsx("div",{className:"d-flex flex-wrap justify-content-center gap-4",children:e.jsx("div",{className:"d-flex flex-wrap justify-content-center gap-4",children:j?.map(t=>e.jsxs("div",{className:"position-relative text-center",style:{width:100,cursor:"pointer"},onMouseEnter:()=>f(t.id),onMouseLeave:()=>f(null),onClick:()=>i(t.id),children:[e.jsxs("div",{className:"collection-hover border rounded shadow-sm position-relative",style:{overflow:"hidden",borderRadius:"8px",transition:"transform 0.3s ease"},children:[e.jsx("img",{src:t.styleVariants?.[0]?.image?`${c}/uploads/images/${t.styleVariants[0].image}`:"/images/nologo.png",alt:t.styleVariants?.[0]?.shortName||t.style,style:{width:"100%",height:210,objectFit:"cover",borderRadius:"8px",transition:"transform 0.3s ease",transform:p===t.id?"scale(1.05)":"scale(1)"},className:"img-fluid",onError:e=>{const s=t.styleVariants?.[0]?.image;s&&!e.target.dataset.fallbackTried?(e.target.dataset.fallbackTried="1",e.target.src=`${c}/uploads/manufacturer_catalogs/${s}`):e.target.src="/images/nologo.png"}}),e.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{backgroundColor:"rgba(0, 0, 0, 0.6)",color:"#fff",opacity:p===t.id?1:0,transition:"opacity 0.3s ease",fontSize:"0.85rem",fontWeight:"500",borderRadius:"8px"},children:t.style||l("common.na")})]}),e.jsx("div",{className:"mt-2 text-muted fw-semibold",children:t.styleVariants?.[0]?.shortName||t.style})]},t.id))})})]})]})}),e.jsx("div",{className:"d-md-none design-upload-mobile-actions",children:e.jsx("div",{className:"container-fluid p-3",children:e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-6",children:e.jsx(U,{color:"manual"===d?"primary":"light",className:"w-100 mobile-tab-button",onClick:()=>b("manual"),size:"lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"bi bi-pencil-square d-block mb-1"}),e.jsx("small",{children:l("proposals.create.design.tabs.manualEntry")})]})})}),e.jsx("div",{className:"col-6",children:e.jsx(U,{color:"import"===d?"primary":"light",className:"w-100 mobile-tab-button",onClick:()=>b("import"),size:"lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"bi bi-upload d-block mb-1"}),e.jsx("small",{children:l("proposals.create.design.tabs.import2020")})]})})})]})})})]})},Wl=({visible:t,onClose:s,onSave:n,modificationType:i,setModificationType:a,existingModifications:r,selectedExistingMod:o,setSelectedExistingMod:l,existingModQty:c,setExistingModQty:d,existingModNote:u,setExistingModNote:m,customModName:h,setCustomModName:p,customModQty:f,setCustomModQty:g,customModPrice:y,setCustomModPrice:x,customModTaxable:v,setCustomModTaxable:b,customModNote:N,setCustomModNote:w,validationAttempted:S,catalogData:C,itemModificationID:T})=>{const D=A(e=>e.auth?.user),k=P(D),M=A(e=>e.customization),E=M?.headerBg||"#007bff",V=j(E);return e.jsxs(Q,{visible:t,onClose:s,alignment:"center",size:"lg",children:[e.jsx(Se,{title:"Modification"}),e.jsxs(J,{style:{padding:"2rem",borderRadius:"0 0 8px 8px"},children:[e.jsxs("div",{className:"mb-4 d-flex gap-4 align-items-center",children:[e.jsx(X,{type:"radio",label:e.jsx("span",{style:{fontSize:"1.1rem"},children:"Select existing modification"}),name:"modType",value:"existing",checked:"existing"===i,onChange:()=>a("existing"),style:{transform:"scale(1.3)"}}),e.jsx(X,{type:"radio",label:e.jsx("span",{style:{fontSize:"1.1rem"},children:"Add custom modification"}),name:"modType",value:"custom",checked:"custom"===i,onChange:()=>a("custom"),style:{transform:"scale(1.3)"}})]}),"existing"===i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3",children:e.jsxs(ee,{"aria-label":"Select existing modification",value:o||"",onChange:e=>l(e.target.value),required:!0,invalid:S&&!o,feedbackInvalid:"Modification code is required",children:[e.jsx("option",{value:"",disabled:!0,children:"Select modification"}),Array.isArray(C)&&C.length>0?C.map(t=>e.jsx("option",{value:t.id,children:t.modificationName},t.id)):e.jsx("option",{disabled:!0,children:"No modifications available"})]})}),e.jsx(Y,{type:"number",value:c,onChange:e=>{const t=Math.max(1,Number(e.target.value));d(t)},placeholder:"Modification Qty",className:"mb-3",min:1,required:!0}),e.jsx(Y,{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"Note (Optional)"}),e.jsx("div",{className:"text-muted mb-1 p-1",children:"If needed, provide custom instructions for applying the modification"})]}),"custom"===i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3",children:e.jsx(Y,{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"Enter Custom Modification",required:!0,invalid:S&&!h,feedbackInvalid:"Modification code is required"})}),e.jsxs("div",{className:"d-flex align-items-center gap-3 mb-3",children:[e.jsx(Y,{type:"number",value:f,onChange:e=>{const t=Math.max(1,Number(e.target.value));g(t)},placeholder:"Qty",min:1,style:{width:"100px"}}),e.jsx(Y,{type:"number",value:y,onChange:e=>x(Number(e.target.value)),placeholder:"Price",min:0,className:"flex-grow-1",style:{width:"100px"}}),e.jsx("div",{className:"form-check mt-2 d-flex align-items-center",style:{gap:"0.5rem"},children:e.jsx(X,{checked:v,onChange:e=>{k&&b(e.target.checked)},disabled:!k,style:{transform:"scale(1.4)"},label:e.jsx("span",{style:{fontSize:"1.1rem",marginLeft:"0.5rem"},children:"Taxable"})})})]}),e.jsx(Y,{type:"text",value:N,onChange:e=>w(e.target.value),placeholder:"Note (Optional)"}),e.jsx("div",{className:"text-muted mb-5 p-1",children:"If needed, provide custom instructions for applying the modification"})]})]}),e.jsxs(te,{children:[e.jsx(U,{color:"secondary",onClick:s,children:"Cancel"}),e.jsx(U,{style:{backgroundColor:E,color:V,borderColor:E},onClick:n,children:"Save"})]})]})},ql=["L","R","-"],Hl=["L","R","B","-"],Yl=({catalogData:t,handleCatalogSelect:i,addOnTop:a,setAddOnTop:o,handleCopy:l,groupEnabled:c,setGroupEnabled:d,searchTerm:u,setSearchTerm:m,updateQty:h,handleOpenModificationModal:p,handleDelete:f,updateModification:y,setModificationsMap:x,modificationsMap:b,handleDeleteModification:N,formatPrice:w,selectVersion:S,isAssembled:C,selectedStyleData:T,toggleRowAssembly:D,updateHingeSide:P,updateExposedSide:M,items:E})=>{const V=Array.isArray(E)?E:Array.isArray(S?.items)?S.items:[],{t:I}=g(),F=A(e=>e.customization).headerBg||"#667eea",R=j(F),[B,L]=s.useState(""),[$,O]=s.useState(!1),[U,z]=s.useState([]),[W,q]=s.useState(!1),[H,K]=s.useState(null);s.useRef(null);const G=s.useRef(null),_="https://app.nj.contractors",Z=()=>{try{const e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}}catch{return{}}};s.useEffect(()=>{L(""),O(!1)},[T&&T.id]),s.useEffect(()=>{const e=e=>{G.current&&!G.current.contains(e.target)&&O(!1)};if($)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[$]),s.useEffect(()=>{const e=S?.manufacturerData?.id;if(!e)return void z([]);let t=!1;return(async()=>{try{const s=await v.get(`/api/manufacturers/${e}/types-meta`,{headers:Z()}),n=Array.isArray(s?.data)?s.data:[];t||z(n)}catch(s){t||z([])}})(),()=>{t=!0}},[S?.manufacturerData?.id]);const ee=e=>{switch(e){case"L":return I("common.short.left",{defaultValue:"L"});case"R":return I("common.short.right",{defaultValue:"R"});case"B":return I("common.short.both",{defaultValue:"B"});default:return e}},te=s.useMemo(()=>{const e=Array.isArray(t)?t.filter(e=>e?.style===T?.style):[],s=(B||"").toLowerCase().trim();return s?e.filter(e=>e.code&&String(e.code).toLowerCase().includes(s)||e.description&&String(e.description).toLowerCase().includes(s)).slice(0,20):[]},[t,T?.style,B]),de=s.useMemo(()=>{const e=new Map;return(U||[]).forEach(t=>{t?.type&&e.set(String(t.type),t)}),e},[U]),ue=e=>{if(!e)return!1;const t=de.get(String(e));return t&&(t.image||(t.longDescription||t.description||"").trim())},me=e=>{const t=de.get(String(e));t&&(K(t),q(!0))},he=e=>{e&&(i({target:{value:`${e.code} -- ${e.description}`}}),L(""),O(!1))};return e.jsxs("div",{className:"mt-5 mb-5",children:[e.jsxs("div",{className:"d-flex flex-wrap gap-3 align-items-center justify-content-between mb-4 catalog-controls-mobile",children:[e.jsxs("div",{className:"position-relative flex-grow-1",style:{minWidth:"200px",maxWidth:"600px"},ref:G,children:[e.jsx(se,{children:e.jsx(Y,{placeholder:I("proposalUI.enterPartCode"),value:B,onChange:e=>{L(e.target.value),O(!0)},onFocus:()=>O(!0),onKeyDown:e=>{"Enter"===e.key&&te[0]&&(e.preventDefault(),he(te[0]))}})}),$&&te.length>0&&e.jsx("div",{className:"dropdown-menu show w-100",style:{maxHeight:"260px",overflowY:"auto"},children:te.map(t=>e.jsxs("div",{className:"dropdown-item-wrapper d-flex justify-content-between align-items-center",style:{padding:"0.25rem"},children:[e.jsxs("button",{type:"button",className:"dropdown-item text-wrap flex-grow-1 border-0 bg-transparent text-start",onMouseDown:e=>e.preventDefault(),onClick:()=>he(t),style:{padding:"0.25rem 0.75rem"},children:[e.jsx("strong",{children:t.code})," — ",t.description]}),ue(t.type)&&e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info ms-2",style:{fontSize:"0.65rem",padding:"0.1rem 0.3rem",flexShrink:0},onClick:e=>{e.stopPropagation(),me(t.type)},title:`View ${t.type} specifications`,children:"Specs"})]},t.id))})]}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-3 flex-shrink-0",children:[e.jsx(X,{label:e.jsx("span",{style:{fontSize:"1rem"},children:I("proposalUI.addOnTop")}),checked:a,onChange:e=>o(e.target.checked),style:{transform:"scale(1.1)"}}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(ne,{icon:r,style:{cursor:"pointer"},onClick:l}),e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:I("proposalUI.copy")})]}),e.jsx(X,{label:e.jsx("span",{style:{fontSize:"1rem"},children:I("proposalUI.group")}),checked:c,onChange:e=>d(e.target.checked),style:{transform:"scale(1.1)"}})]}),e.jsx("div",{className:"flex-shrink-0",style:{minWidth:"200px",maxWidth:"240px",width:"100%"},children:e.jsx(se,{children:e.jsx(Y,{placeholder:I("proposalUI.findInCart"),value:u,onChange:e=>m(e.target.value)})})})]}),e.jsxs(Q,{visible:W,onClose:()=>q(!1),size:"lg",children:[e.jsx(Se,{title:H?.type||"Type Specifications",onClose:()=>q(!1)}),e.jsxs(J,{className:"p-3 p-md-4",children:[H?e.jsxs("div",{className:"d-flex flex-column flex-md-row gap-4",children:[e.jsx("div",{className:"text-center text-md-start border rounded p-3 bg-light",style:{width:"100%",maxWidth:"220px",margin:"0 auto"},children:e.jsx("img",{src:H.image?`${_}/uploads/types/${H.image}`:"/images/nologo.png",alt:H.type,className:"img-fluid",style:{maxWidth:"100%",height:"auto",maxHeight:"200px",objectFit:"contain",background:"#ffffff",borderRadius:"6px",border:"1px solid #dee2e6"},onError:e=>{H.image&&!e.target.dataset.fallbackTried?(e.target.dataset.fallbackTried="1",e.target.src=`${_}/uploads/manufacturer_catalogs/${H.image}`):e.target.src="/images/nologo.png"}})}),e.jsxs("div",{className:"flex-grow-1 border rounded p-3 bg-light",style:{minWidth:0},children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"badge text-bg-secondary me-2",children:I("Type")}),e.jsx("strong",{style:{fontSize:"1.1rem"},children:H.type})]}),H.code&&e.jsxs("div",{className:"mb-2 border-bottom pb-2",children:[e.jsx("span",{className:"text-muted fw-medium",children:"Code:"})," ",e.jsx("strong",{children:H.code})]}),H.name&&e.jsxs("div",{className:"mb-2 border-bottom pb-2",children:[e.jsx("span",{className:"text-muted fw-medium",children:"Name:"})," ",e.jsx("strong",{children:H.name})]}),H.shortName&&e.jsxs("div",{className:"mb-3 border-bottom pb-2",children:[e.jsx("span",{className:"text-muted fw-medium",children:"Short:"})," ",e.jsx("strong",{children:H.shortName})]}),e.jsxs("div",{className:"mt-3",style:{whiteSpace:"pre-wrap",lineHeight:"1.6",fontSize:"0.95rem"},children:[e.jsx("strong",{className:"text-muted d-block mb-2",children:"Description:"}),H.longDescription||H.description||I("No description available for this type.")]})]})]}):e.jsx("div",{className:"text-muted text-center p-4 border rounded bg-light",children:I("No type information available.")}),e.jsx("div",{className:"d-block d-md-none mt-4 text-center",children:e.jsx("button",{type:"button",className:"btn btn-dark btn-lg shadow-sm",onClick:()=>q(!1),style:{minWidth:"140px",borderRadius:"8px",fontWeight:"500"},children:"Close"})})]})]}),e.jsx("div",{className:"table-responsive table-responsive-md",children:e.jsxs(ie,{children:[e.jsx(ae,{children:e.jsxs(re,{children:[e.jsx(oe,{children:I("proposalColumns.no")}),e.jsx(oe,{children:I("proposalColumns.qty")}),e.jsx(oe,{children:I("proposalColumns.item")}),e.jsx(oe,{children:I("proposalColumns.hingeSide")}),e.jsx(oe,{children:I("proposalColumns.exposedSide")}),e.jsx(oe,{children:I("proposalColumns.price")}),e.jsx(oe,{children:I("proposalColumns.assemblyCost")}),e.jsx(oe,{children:I("proposalColumns.total")}),e.jsx(oe,{children:I("proposals.headers.actions")})]})}),e.jsx(le,{children:V.map((t,s)=>{const i=!!C,a=Number(t.qty||1),r=!!t.unavailable,o=i?Number(t.assemblyFee||0):0,l=r?0:o*a,c=(r?0:Number(t.price||0)*a)+l;return e.jsxs(n.Fragment,{children:[e.jsxs(re,{children:[e.jsx(ce,{children:s+1}),e.jsx(ce,{children:e.jsx(Y,{type:"number",min:"1",value:t.qty,onChange:e=>h(s,parseInt(e.target.value)),style:{width:"70px",textAlign:"center"}})}),e.jsx(ce,{className:r?"text-danger text-decoration-line-through":"",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:t.code}),ue(t.type)&&e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",style:{fontSize:"0.7rem",padding:"0.15rem 0.4rem"},onClick:()=>me(t.type),title:`View ${t.type} specifications`,children:"Specs"})]})}),e.jsx(ce,{children:i?e.jsx("div",{className:"d-flex gap-1",children:ql.map(n=>e.jsx("button",{className:"btn btn-sm "+(t.hingeSide,"btn-light"),style:t.hingeSide===n?{background:F,color:R,border:`1px solid ${F}`}:{},onClick:()=>P(s,n),children:ee(n)},n))}):I("common.na")}),e.jsx(ce,{children:i?e.jsx("div",{className:"d-flex gap-1",children:Hl.map(n=>e.jsx("button",{className:"btn btn-sm "+(t.exposedSide,"btn-light"),style:t.exposedSide===n?{background:F,color:R,border:`1px solid ${F}`}:{},onClick:()=>M(s,n),children:ee(n)},n))}):I("common.na")}),e.jsx(ce,{className:r?"text-danger text-decoration-line-through":"",children:w(r?0:t.price)}),e.jsx(ce,{children:i?e.jsx("span",{children:w(l)}):e.jsx("span",{className:"text-muted",children:w(0)})}),e.jsx(ce,{className:r?"text-danger text-decoration-line-through":"",children:w(c)}),e.jsx(ce,{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(ne,{icon:k,style:{cursor:"pointer",color:"black",marginRight:"16px"},onClick:()=>p(s,t.id)}),e.jsx(ne,{icon:Ce,style:{cursor:"pointer",color:"red"},onClick:()=>f(s)})]})})]}),Array.isArray(t.modifications)&&t.modifications.length>0&&e.jsx(re,{className:"table-light",children:e.jsx(ce,{colSpan:9,className:"fw-bold text-muted",children:I("proposalDoc.modifications")})}),Array.isArray(t.modifications)&&t.modifications.length>0&&t.modifications.map((t,n)=>e.jsxs(re,{className:"table-secondary",children:[e.jsx(ce,{children:"-"}),e.jsx(ce,{children:t.qty}),e.jsx(ce,{colSpan:3,children:t.name||I("proposalUI.mod.unnamed")}),e.jsx(ce,{children:w(t.price||0)}),e.jsx(ce,{children:"-"}),e.jsx(ce,{children:w((t.price||0)*(t.qty||1))}),e.jsx(ce,{children:e.jsx(ne,{icon:Ce,style:{cursor:"pointer",color:"red"},onClick:()=>N(s,n)})})]},`mod-${s}-${n}`))]},s)})})]})}),e.jsx("div",{className:"mobile-card-view d-none",children:V.map((t,s)=>{const i=!!C,a=Number(t.qty||1),r=!!t.unavailable,o=i?Number(t.assemblyFee||0):0,l=r?0:o*a,c=(r?0:Number(t.price||0)*a)+l;return e.jsxs(n.Fragment,{children:[e.jsxs("div",{className:"item-card-mobile",children:[e.jsxs("div",{className:"item-header",children:[e.jsx("div",{className:"item-number",children:s+1}),e.jsxs("div",{className:"item-actions",children:[e.jsx(ne,{icon:k,style:{cursor:"pointer",color:"var(--cui-primary)",fontSize:"1.2rem"},onClick:()=>p(s,t.id)}),e.jsx(ne,{icon:Ce,style:{cursor:"pointer",color:"var(--cui-danger)",fontSize:"1.2rem"},onClick:()=>f(s)})]})]}),e.jsxs("div",{className:"item-detail-row",children:[e.jsx("span",{className:"item-label",children:I("proposalColumns.item")}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{className:"item-value item-code "+(r?"text-danger text-decoration-line-through":""),children:t.code}),ue(t.type)&&e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",style:{fontSize:"0.7rem",padding:"0.15rem 0.4rem"},onClick:()=>me(t.type),title:`View ${t.type} specifications`,children:"Specs"})]})]}),e.jsxs("div",{className:"item-detail-row",children:[e.jsx("span",{className:"item-label",children:I("proposalColumns.qty")}),e.jsx("input",{type:"number",min:"1",value:t.qty,onChange:e=>h(s,parseInt(e.target.value)),className:"qty-input-mobile"})]}),e.jsxs("div",{className:"item-detail-row",children:[e.jsx("span",{className:"item-label",children:I("proposalColumns.price")}),e.jsx("span",{className:"item-value "+(r?"text-danger text-decoration-line-through":""),children:w(r?0:t.price)})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"item-detail-row",children:[e.jsx("span",{className:"item-label",children:I("proposalColumns.hingeSide")}),e.jsx("div",{className:"btn-group-mobile",children:ql.map(n=>e.jsx("button",{className:"btn "+(t.hingeSide,"btn-outline-secondary"),style:t.hingeSide===n?{background:F,color:R,border:`1px solid ${F}`}:{},onClick:()=>P(s,n),children:ee(n)},n))})]}),e.jsxs("div",{className:"item-detail-row",children:[e.jsx("span",{className:"item-label",children:I("proposalColumns.exposedSide")}),e.jsx("div",{className:"btn-group-mobile",children:Hl.map(n=>e.jsx("button",{className:"btn "+(t.exposedSide,"btn-outline-secondary"),style:t.exposedSide===n?{background:F,color:R,border:`1px solid ${F}`}:{},onClick:()=>M(s,n),children:ee(n)},n))})]}),e.jsxs("div",{className:"item-detail-row",children:[e.jsx("span",{className:"item-label",children:I("proposalColumns.assemblyCost")}),e.jsx("span",{className:"item-value "+(r?"text-danger text-decoration-line-through":""),children:w(l)})]})]}),e.jsx("div",{className:"total-highlight "+(r?"text-danger text-decoration-line-through":""),children:e.jsxs("strong",{children:[I("proposalColumns.total"),": ",w(c)]})})]}),Array.isArray(t.modifications)&&t.modifications.length>0&&t.modifications.map((t,n)=>e.jsxs("div",{className:"modification-card-mobile",children:[e.jsxs("div",{className:"mod-header",children:[e.jsx("span",{className:"mod-label",children:I("proposalDoc.modifications")}),e.jsx(ne,{icon:Ce,style:{cursor:"pointer",color:"var(--cui-danger)"},onClick:()=>N(s,n)})]}),e.jsxs("div",{className:"mod-detail",children:[e.jsx("span",{children:t.name||I("proposalUI.mod.unnamed")}),e.jsxs("span",{children:["Qty: ",t.qty]})]}),e.jsxs("div",{className:"mod-detail",children:[e.jsxs("span",{children:[I("proposalColumns.price"),": ",w(t.price||0)]}),e.jsx("span",{children:e.jsxs("strong",{children:[I("proposalColumns.total"),": ",w((t.price||0)*(t.qty||1))]})})]})]},`mobile-mod-${s}-${n}`))]},`mobile-${s}`)})})]})},Xl=()=>{const e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}},Kl=({selectVersion:t,selectedVersion:n,formData:i,setFormData:a,setSelectedVersion:r})=>{const{t:l}=g(),c="https://app.nj.contractors",d=E(),[u,m]=s.useState(null),[h,p]=s.useState([]),[f,y]=s.useState(!1),[x,b]=s.useState(!1),[j,S]=s.useState(""),C=t?.manufacturerData?.collections||[],T=t?.manufacturerData?.catalogData||[],[D,V]=s.useState(!1),[I,F]=s.useState(!1),[R,B]=s.useState(""),[L,$]=s.useState(""),[O,U]=s.useState(!0),[z,W]=s.useState([]),[q,H]=s.useState(!1),[Y,K]=s.useState(null),[G,_]=s.useState("existing"),[Z,Q]=s.useState(1),[J,ee]=s.useState(""),[te,se]=s.useState(""),[ie,ae]=s.useState(1),[re,oe]=s.useState(""),[le,ce]=s.useState(""),[ue,me]=s.useState(!0),[he,pe]=s.useState(!1),[fe,ge]=s.useState(""),[ye,xe]=s.useState({}),[ve,be]=s.useState(!0),[je,Ne]=s.useState(0),{taxes:we,loading:Se}=A(e=>e.taxes),Ce=A(e=>e.auth?.user),ke=P(Ce),[Me,Ee]=s.useState(""),[Ae,Ve]=s.useState(""),[Ie,Fe]=s.useState(""),[Re,Be]=s.useState(1),[Le,$e]=s.useState(1),[Oe,Ue]=s.useState([]),[ze,We]=s.useState([]),[qe,He]=s.useState(!0),[Ye,Xe]=s.useState(0),[Ke,Ge]=s.useState(4),[_e,Ze]=s.useState({styleId:null,stylePrice:null}),[Qe,Je]=s.useState(!1),[et,tt]=s.useState(0),st=s.useRef(new Map),nt=s.useRef(null);s.useEffect(()=>{const e=t?.versionName;if(!e)return;if(nt.current===e)return;nt.current=e;const s=Array.isArray(t?.items)?t.items:[];p(s),d(N(s))},[t?.versionName]),s.useEffect(()=>{(async()=>{try{const e=await v.get("/api/user/multiplier",{headers:Xl()});e?.data?.multiplier&&Be(Number(e.data.multiplier))}catch(e){}})()},[]),s.useEffect(()=>{ke||!0===O||U(!0)},[ke]),s.useEffect(()=>{ke||!0===ue||me(!0)},[ke]);const it=s.useMemo(()=>Array.isArray(h)?h.filter(e=>e?.selectVersion===t?.versionName):[],[h,t?.versionName]);s.useDeferredValue(it);const at=e=>{if(!Array.isArray(e)||0===e.length)return;const t=new Map;e.forEach(e=>{e.code&&e.type&&t.set(String(e.code).trim(),e.type)}),p(e=>{const s=e.map(e=>{if(e.type)return e;const s=t.get(String(e.code).trim());return s?{...e,type:s}:e});return s.some((t,s)=>t.type!==e[s]?.type)&&d(N(s)),s})};s.useEffect(()=>{(()=>{try{const e=it.reduce((e,t)=>e+Number(t.price||0)*Number(t.qty||1),0),s=z.reduce((e,t)=>e+t.price,0),n=gt,r=ve?it.reduce((e,t)=>e+(t?.includeAssemblyFee?Number(t?.assemblyFee||0):0)*Number(t?.qty||1),0):0,o=e+r+s+n,l=z?.reduce((e,t)=>e+t.price,0)+it.reduce((e,t)=>e+Number(t.price||0)*Number(t.qty||1),0),c=o*je/100,d=o-c,u=d*ut/100,m=d+u,h=i.manufacturersData.map(e=>{if(e.versionName===t?.versionName){const s=z.filter(e=>e.selectVersion===t?.versionName),n=it.filter(e=>e.selectVersion===t?.versionName);return{...e,selectedStyle:t?.selectedStyle,items:n,customItems:s,summary:{cabinets:parseFloat((Number(l)||0).toFixed(2)),assemblyFee:parseFloat((Number(r)||0).toFixed(2)),modificationsCost:parseFloat((Number(gt)||0).toFixed(2)),styleTotal:parseFloat((Number(o)||0).toFixed(2)),discountPercent:Number(je)||0,discountAmount:parseFloat((Number(c)||0).toFixed(2)),total:parseFloat((Number(d)||0).toFixed(2)),taxRate:Number(ut)||0,taxAmount:parseFloat((Number(u)||0).toFixed(2)),grandTotal:parseFloat((Number(m)||0).toFixed(2))}}}return e});a(e=>({...e,manufacturersData:h}))}catch(e){}})()},[h,z,je,ve]),s.useEffect(()=>{d(w())},[d]),s.useEffect(()=>{(async()=>{const e=t?.manufacturerData?.id;if(e){He(!0);try{const t=await v.get(`/api/manufacturers/${e}/styles-meta`,{headers:Xl()});if(t.data.styles&&Array.isArray(t.data.styles)){const e=t.data.styles.filter(e=>String(e?.style||"").trim().length>0);Ue(e),$e(Number(t.data.manufacturerCostMultiplier||1))}else if(Array.isArray(t.data)){const e=t.data.filter(e=>String(e?.style||"").trim().length>0);Ue(e)}else Ue([])}catch(s){Ue([])}finally{He(!1)}}})()},[t?.manufacturerData?.id]),s.useEffect(()=>{(async()=>{const e=t?.manufacturerData?.id,s=t?.selectedStyle;if(e&&s){He(!0);try{const t=`${e}:${s}`;if(st.current.has(t)){const e=st.current.get(t)||[];return We(e),void at(e)}const n=await v.get(`/api/manufacturers/${e}/styles/${s}/items`,{headers:Xl(),params:{includeDetails:"1",limit:1e3}}),i=n?.data?.catalogData||[];st.current.set(t,i),void 0!==n?.data?.manufacturerCostMultiplier&&$e(Number(n.data.manufacturerCostMultiplier||1)),at(i),We(i)}catch(n){We([])}finally{He(!1)}}else We([])})()},[t?.manufacturerData?.id,t?.selectedStyle]),s.useEffect(()=>{const e=t?.manufacturerData?.id,s=t?.selectedStyle;if(!e||!s)return;if(!Array.isArray(T)||0===T.length)return;const n=(C||[]).find(e=>e.id===s)?.style;if(n&&0===ze.length){const e=T.filter(e=>e.style===n);e.length&&We(e)}},[t?.manufacturerData?.id,t?.selectedStyle,T,C]),s.useEffect(()=>{if(t?.selectedStyle&&Oe.length){const e=Oe.find(e=>e.id===t.selectedStyle);m(e||null)}},[t,Oe]),s.useEffect(()=>{const e=()=>{window.innerWidth<=767?Ge(2):window.innerWidth<=992?Ge(4):window.innerWidth<=1200?Ge(5):Ge(6)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),s.useEffect(()=>{Xe(0)},[ze]);const rt=()=>Ye<Oe.length-Ke,ot=()=>Ye>0,lt=s.useMemo(()=>{try{const e=it.reduce((e,t)=>e+Number(t?.comparisonPriceFallback??t?.price??0)*Number(t?.qty||1),0),t=z.reduce((e,t)=>e+Number(t.price||0),0),s=it.reduce((e,t)=>{if(!Array.isArray(t?.modifications)||0===t.modifications.length)return e;return e+t.modifications.reduce((e,t)=>e+Number(t.price||0)*Number(t.qty||1),0)},0),n=ve?it.reduce((e,t)=>e+Number(t?.comparisonAssemblyUnitFallback??(t?.assemblyFee||0))*Number(t?.qty||1),0):0;return{cabinetPartsTotal:e,customItemsTotal:t,modificationsTotal:s,assemblyFeeTotal:n,baseTotal:e+n+t+s}}catch{return{cabinetPartsTotal:0,customItemsTotal:0,modificationsTotal:0,assemblyFeeTotal:0,baseTotal:0}}},[it,z,ve]),ct=e=>{try{const t=Number((null!=_e?.stylePrice?_e.stylePrice:u?.price)||0),s=Number(e||0)-t,n=s*Number(Le||1)*Number(Re||1),i=Number(lt.baseTotal||0)+n,a=i-i*Number(je||0)/100,r=a*Number(ut||0)/100;return a+r}catch(t){return 0}},dt=we.find(e=>e.isDefault),ut=parseFloat(dt?.value||"0");s.useEffect(()=>{if(t?.selectedStyle&&C.length){const e=Oe.find(e=>e.id===t.selectedStyle);m(e)}},[t]);const mt=e=>{W(t=>t.filter((t,s)=>t!==e&&(t.name===e.name&&Number(t.price)===Number(e.price)&&t.selectVersion===e.selectVersion&&t.taxable===e.taxable&&(e={...e,name:`__removed__${Math.random()}`}),!0)))},ht=(e,s)=>{xe(t=>({...t,[e]:s}));const n=it.filter(e=>e.selectVersion===t?.versionName)[e],i=h?.findIndex(e=>e?.id===n?.id);if(-1!==i){const e=[...h];e[i]={...e[i],modifications:s},p(e)}},pt=async e=>{try{if(e){const t=await v.get(`${c}/api/manufacturers/catalogs/modificationsItems/${e}`,{headers:Xl()});Fe(t.data)}}catch(t){}},ft=async e=>{const n={...i},o=n.manufacturersData.findIndex(e=>e.versionName===t.versionName);if(-1!==o){n.manufacturersData[o].selectedStyle=e,a(n);const i={...t,selectedStyle:e};r(i);const c=Oe.find(t=>t.id===e)||C.find(t=>t.id===e);m(c),Ze(t=>t?.styleId?t:{styleId:c?.id||e,stylePrice:c?.price||0});try{const n=t?.manufacturerData?.id;if(!n||!e)return;const i=`${n}:${e}`;let a=st.current.get(i);if(!a){const t=await v.get(`/api/manufacturers/${n}/styles/${e}/items`,{headers:Xl(),params:{includeDetails:"1",limit:1e3}});a=t?.data?.catalogData||[],st.current.set(i,a)}const r=new Map(a.map(e=>[String(e.code).trim(),e]));let o=0;const l=h.map(e=>{const t=r.get(String(e.code).trim());if(!t){const t=Number(e.qty||1);return o+=1,{...e,unavailable:!0,price:0,assemblyFee:0,total:0*t,comparisonPriceFallback:e.comparisonPriceFallback??Number(e.price||0),comparisonAssemblyUnitFallback:e.comparisonAssemblyUnitFallback??Number(e.assemblyFee||0)}}const s=Number(t.price)||0,n=s*Number(Le||1),i=n*Number(Re||1),a=t.styleVariantsAssemblyCost;let l=0;if(a){const e=parseFloat(a.price||0),t=a.type;l="flat"===t||"fixed"===t?e:"percentage"===t?i*e/100:e}const c=Number(e.qty||1);return{...e,unavailable:!1,type:t.type,originalPrice:s,manufacturerAdjustedPrice:n,appliedManufacturerMultiplier:Number(Le||1),appliedUserGroupMultiplier:Number(Re||1),price:i,assemblyFee:l,total:i*c+(ve?l*c:0),comparisonPriceFallback:e.comparisonPriceFallback??Number(e.price||i||0),comparisonAssemblyUnitFallback:e.comparisonAssemblyUnitFallback??Number(e.assemblyFee||l||0)}});s.startTransition(()=>{p(l),d(N(l)),tt(o)})}catch(l){}}};ve&&it.reduce((e,t)=>e+(t.includeAssemblyFee?Number(t.assemblyFee||0):0),0);const gt=it.reduce((e,t)=>{if(!t.modifications)return e;return e+t.modifications.reduce((e,t)=>e+parseFloat(t.price||0)*parseFloat(t.qty||1),0)},0);return s.useEffect(()=>{let e=null;p(t=>{const s=t.map(e=>{const t=!!ve,s=t?Number(e.assemblyFee||0):0,n=Number(e.qty||1);return{...e,includeAssemblyFee:t,isRowAssembled:t,hingeSide:ve?e.hingeSide||"":"N/A",exposedSide:ve?e.exposedSide||"":"N/A",total:n*Number(e.price||0)+s*n}});return e=s,s}),e&&s.startTransition(()=>d(N(e)))},[ve]),s.useEffect(()=>{if(!h?.length)return;if(!(Re&&1!==Re||Le&&1!==Le))return;const e=h.map(e=>{const t=null!=e.originalPrice?Number(e.originalPrice):Number(e.price)||0,s=t*Number(Le||1),n=s*Number(Re||1),i=e?.includeAssemblyFee?Number(e?.assemblyFee||0):0,a=Number(e?.qty||1);return{...e,originalPrice:null!=e.originalPrice?e.originalPrice:t,manufacturerAdjustedPrice:s,appliedManufacturerMultiplier:Number(Le||1),appliedUserGroupMultiplier:Number(Re||1),price:n,total:a*n+i*a}});s.startTransition(()=>{p(e),d(N(e))})},[Re,Le]),e.jsxs("div",{children:[u&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"d-flex gap-5 mb-4 flex-wrap style-selection-mobile",style:{alignItems:"stretch"},children:[e.jsxs("div",{className:"current-style-section",style:{minWidth:"250px",flex:"0 0 auto"},children:[e.jsx("h5",{className:"mb-3",children:l("proposalUI.currentStyle")}),e.jsxs("div",{className:"current-style-content d-flex gap-3 align-items-start",children:[e.jsx("div",{className:"current-style-image",style:{width:"100px",flexShrink:0},children:e.jsx("img",{src:u.styleVariants?.[0]?.image?`${c}/uploads/images/${u.styleVariants[0].image}`:"/images/nologo.png",alt:"Selected Style",style:{width:"100%",height:"240px",objectFit:"contain",borderRadius:"10px",backgroundColor:"#f8f9fa"},onError:e=>{const t=u.styleVariants?.[0]?.image;t&&!e.target.dataset.fallbackTried?(e.target.dataset.fallbackTried="1",e.target.src=`${c}/uploads/manufacturer_catalogs/${t}`):e.target.src="/images/nologo.png"}})}),e.jsxs("div",{className:"current-style-info d-flex flex-column",style:{gap:"1.5rem",flex:1},children:[e.jsxs("div",{className:"d-flex align-items-center",style:{fontSize:"1rem"},children:[e.jsx(ne,{icon:Te,className:"me-2 text-primary",style:{width:"20px",height:"20px"}}),e.jsx("h5",{className:"mb-0",children:t?.manufacturerData?.name})]}),e.jsxs("div",{className:"d-flex align-items-center text-muted",style:{fontSize:"1rem"},children:[e.jsx(ne,{icon:M,className:"me-2 text-secondary",style:{width:"20px",height:"20px"}}),e.jsx("h5",{className:"mb-0",children:u.style})]}),e.jsxs("div",{className:"d-flex align-items-center",style:{fontSize:"1.1rem"},children:[e.jsx(ne,{icon:k,className:"me-2 text-success",style:{width:"20px",height:"20px"}}),e.jsx("span",{className:"me-2",children:l("proposalColumns.assembled")}),e.jsx(de,{size:"md",shape:"pill",checked:ve,onChange:e=>be(e.target.checked)})]})]})]})]}),e.jsx("div",{className:"style-separator",style:{width:"1px",backgroundColor:"#ccc",marginInline:"16px"}}),e.jsxs("div",{className:"other-styles-section",style:{flex:1},children:[e.jsxs("div",{className:"other-styles-header d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h5",{className:"mb-0",children:l("proposalUI.otherStyles")}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{className:"btn btn-sm "+(Qe?"btn-primary":"btn-outline-primary"),onClick:()=>Je(!Qe),style:{padding:"0.25rem 0.75rem"},children:Qe?e.jsxs(e.Fragment,{children:[e.jsx(ne,{icon:o,size:"sm",className:"me-1"}),e.jsx("span",{className:"d-none d-sm-inline",children:l("proposalUI.expandImages")}),e.jsx("span",{className:"d-sm-none",children:"📋"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{icon:o,size:"sm",className:"me-1"}),e.jsx("span",{className:"d-none d-sm-inline",children:l("proposalUI.compactView")}),e.jsx("span",{className:"d-sm-none",children:"🖼️"})]})}),it.length>0&&!Qe&&e.jsxs("div",{className:"carousel-controls d-flex gap-2 d-md-none",children:[e.jsx("button",{className:"btn btn-outline-secondary btn-sm "+(ot()?"":"disabled"),onClick:()=>Xe(e=>Math.max(e-1,0)),disabled:!ot(),style:{padding:"0.25rem 0.5rem"},"aria-label":"Previous styles",children:e.jsx(ne,{icon:De,size:"sm"})}),e.jsx("button",{className:"btn btn-outline-secondary btn-sm "+(rt()?"":"disabled"),onClick:()=>{const e=Math.max(0,Oe.length-Ke);Xe(t=>Math.min(t+1,e))},disabled:!rt(),style:{padding:"0.25rem 0.5rem"},"aria-label":"Next styles",children:e.jsx(ne,{icon:Pe,size:"sm"})})]})]})]}),et>0&&e.jsxs("div",{className:"alert alert-warning py-2 px-3 mb-3",role:"alert",children:[et," item",1!==et?"s":""," not available in this style. They remain listed in red with $0 and won’t affect totals."]}),e.jsx("div",{className:"other-styles-carousel-container "+(Qe?"collapsed-view":""),children:qe?e.jsx("div",{className:"py-4 text-muted",children:l("proposalUI.loadingStyles")}):0===Oe.length?e.jsx("div",{className:"py-4 text-muted",children:l("proposalUI.noStyles")}):e.jsx("div",{className:"styles-carousel-container",children:0===it.length?e.jsx("div",{className:"py-4 text-center text-muted",style:{fontSize:"0.9rem"},children:l("proposalUI.styleComparison.selectItemsMessage")}):Qe?e.jsx("div",{className:"styles-compact-list",children:Oe.map((t,s)=>{t.styleVariants;const n=ct(t.price),i=t.id===u?.id;return e.jsxs("div",{className:"compact-style-item "+(i?"current-style":""),onClick:()=>ft(t.id),children:[e.jsxs("div",{className:"style-info",children:[e.jsx("span",{className:"style-name",children:t.style}),e.jsx("span",{className:"price-label",children:l(i?"proposalUI.styleComparison.currentTotal":"proposalUI.styleComparison.totalIfSelected")})]}),e.jsxs("div",{className:"style-price "+(i?"current":"alternate"),children:["$",n.toFixed(2)]})]},`compact-style-${t.id}-${s}`)})}):e.jsx("div",{className:"styles-carousel-track",style:{display:"flex",gap:"1rem",transform:`translateX(-${Ye*(100/Ke)}%)`,transition:"transform 0.3s ease-in-out",width:Oe.length>Ke?100*Math.ceil(Oe.length/Ke)+"%":"100%"},children:Oe.map((t,s)=>{const n=t.styleVariants?.[0];return e.jsxs("div",{className:"style-carousel-item text-center",style:{cursor:"pointer",transition:"transform 0.2s ease",flexShrink:0},onClick:()=>ft(t.id),onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.02)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)"},children:[e.jsx("img",{src:n?.image?`${c}/uploads/images/${n.image}`:"/images/nologo.png",alt:n?.shortName||t.style,style:{width:"100%",height:"220px",objectFit:"contain",borderRadius:"10px",backgroundColor:"#f8f9fa",borderWidth:t.id===u?.id?"3px":"1px",borderStyle:"solid",borderColor:t.id===u?.id?"#1a73e8":"#e9ecef"},onError:e=>{n?.image&&!e.target.dataset.fallbackTried?(e.target.dataset.fallbackTried="1",e.target.src=`${c}/uploads/manufacturer_catalogs/${n.image}`):e.target.src="/images/nologo.png"}}),e.jsxs("div",{className:"mt-2 p-2 rounded",style:{backgroundColor:t.id===u?.id?"#d0e6ff":"#ffffff",borderWidth:t.id===u?.id?"2px":"1px",borderStyle:"solid",borderColor:t.id===u?.id?"#1a73e8":"#ced4da",fontWeight:t.id===u?.id?"600":"normal"},children:[e.jsx("div",{style:{fontSize:"0.875rem",marginBottom:"0.25rem"},children:t.style}),e.jsx("div",{style:{fontSize:"0.75rem",color:"#666",marginBottom:"0.25rem"},children:t.id===u?.id?l("proposalUI.styleComparison.currentTotal"):l("proposalUI.styleComparison.totalIfSelected")}),e.jsxs("strong",{style:{color:t.id===u?.id?"#1a73e8":"#28a745"},children:["$",ct(t.price).toFixed(2)]})]})]},`style-${t.id}-${s}`)})})})})]})]})}),e.jsx("hr",{}),"            ",e.jsx(Yl,{catalogData:ze,handleCatalogSelect:e=>{const s=e.target.value,n=ze.find(e=>`${e.code} -- ${e.description}`===s);if(n&&n.style===u?.style){const e=Number(n.price)||0,s=e*Number(Le||1),i=s*Number(Re||1),a=n.styleVariantsAssemblyCost;let r=0;if(a){const e=parseFloat(a.price||0),t=a.type;r="flat"===t||"fixed"===t?e:"percentage"===t?i*e/100:e}const o=1,l=i*o+r*o,c={id:n.id,code:n.code,description:n.description,type:n.type,qty:o,originalPrice:e,manufacturerAdjustedPrice:s,appliedManufacturerMultiplier:Number(Le||1),appliedUserGroupMultiplier:Number(Re||1),price:i,assemblyFee:r,total:l,selectVersion:t?.versionName};c.comparisonPriceFallback=Number(i||0),c.comparisonAssemblyUnitFallback=Number(r||0),p(e=>{const t=f?[c,...e]:[...e,c];return d(N(t)),t})}},addOnTop:f,setAddOnTop:y,handleCopy:()=>{const e=h.map(e=>`${e.code} x${e.qty}`).join("\n");e?(F(!1),navigator.clipboard.writeText(e)):F(!0),V(!0),setTimeout(()=>V(!1),2e3)},groupEnabled:x,setGroupEnabled:b,searchTerm:j,setSearchTerm:S,updateQty:(e,t)=>{const s=it[e];!s||t<1||p(e=>{const n=e.findIndex(e=>e?.id===s?.id&&e?.selectVersion===s?.selectVersion);if(n<0)return e;const i=e.map((e,s)=>s!==n?e:{...e,qty:t,total:t*Number(e.price||0)+Number(e.includeAssemblyFee&&e.assemblyFee||0)*t});return d(N(i)),i})},handleOpenModificationModal:(e,t)=>{K(e),H(!0),Ve(t),pt(t)},handleDelete:e=>{const t=it[e];t&&p(e=>{const s=e.findIndex(e=>e?.id===t?.id&&e?.selectVersion===t?.selectVersion),n=s>=0?e.filter((e,t)=>t!==s):e;return d(N(n)),n})},updateModification:ht,setModificationsMap:xe,modificationsMap:ye,handleDeleteModification:(e,t)=>{const s=[...ye[e]];s.splice(t,1),ht(e,s)},formatPrice:e=>{const t=Number(e);return isNaN(t)?"$0.00":`$${t.toFixed(2)}`},selectVersion:t,isAssembled:ve,selectedStyleData:u,toggleRowAssembly:(e,t)=>{const n=it[e];if(!n)return;const i=h.findIndex(e=>e?.id===n?.id&&e?.selectVersion===n?.selectVersion);if(i<0)return;const a=[...h],r=a[i],o=t?Number(r.assemblyFee||0):0,l=Number(r.qty||1),c=t?"N/A"===r.hingeSide?"":r.hingeSide:"N/A",u=t?"N/A"===r.exposedSide?"":r.exposedSide:"N/A";a[i]={...r,includeAssemblyFee:t,isRowAssembled:t,hingeSide:c,exposedSide:u,total:l*Number(r.price||0)+o*l},s.startTransition(()=>{p(a),d(N(a))})},updateHingeSide:(e,t)=>{const s=it[e];s&&p(e=>{const n=e.findIndex(e=>e?.id===s?.id&&e?.selectVersion===s?.selectVersion);if(n<0)return e;const i=e.map((e,s)=>s!==n?e:{...e,hingeSide:t});return d(N(i)),i})},updateExposedSide:(e,t)=>{const s=it[e];s&&p(e=>{const n=e.findIndex(e=>e?.id===s?.id&&e?.selectVersion===s?.selectVersion);if(n<0)return e;const i=e.map((e,s)=>s!==n?e:{...e,exposedSide:t});return d(N(i)),i})},items:it}),D&&e.jsx("div",{className:"position-fixed bottom-10 start-50 translate-middle-x p-3",style:{zIndex:9999},children:e.jsx("div",{className:"toast show align-items-center text-white bg-success border-0",children:e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"toast-body",children:l(I?"proposalUI.toast.copyEmpty":"proposalUI.toast.copySuccess")}),e.jsx("button",{type:"button",className:"btn-close btn-close-white me-2 m-auto",onClick:()=>V(!1)})]})})}),ke&&e.jsxs("div",{className:"mt-5 p-0 custom-items-mobile",style:{maxWidth:"100%"},children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2",style:{rowGap:"0.75rem"},children:[e.jsx("h6",{className:"mb-0 w-100 w-md-auto",children:l("proposalUI.custom.title")}),e.jsx("input",{type:"text",placeholder:l("proposalUI.custom.itemName"),value:R,onChange:e=>{B(e.target.value),Me&&Ee("")},className:"form-control",style:{flex:1,minWidth:"200px",maxWidth:"100%"}}),e.jsx("input",{type:"number",placeholder:l("proposalUI.custom.price"),value:L,onChange:e=>{$(e.target.value),Me&&Ee("")},className:"form-control",style:{width:"90px",minWidth:"70px"},min:"0",step:"0.01"}),e.jsx("div",{className:"form-check d-flex align-items-center",children:e.jsx(X,{checked:O,onChange:e=>{ke&&U(e.target.checked)},disabled:!ke,style:{transform:"scale(1.4)"},label:e.jsx("span",{style:{fontSize:"1.1rem",marginLeft:"0.5rem"},children:l("proposalUI.custom.taxable")})})}),e.jsx("button",{className:"btn btn-primary",style:{minWidth:"80px"},onClick:()=>{if(!R||!L)return void Ee("Please enter both item name and price.");const e={name:R,price:parseFloat(L),taxable:!ke||O,selectVersion:t?.versionName};W(t=>[...t,e]),B(""),$(""),U(!0)},children:l("proposalUI.custom.add")})]}),Me&&e.jsx("div",{style:{color:"red",marginTop:"0.25rem",marginBottom:"1rem"},children:Me}),e.jsx("div",{className:"table-responsive d-none d-md-block",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:l("proposalUI.custom.table.index")}),e.jsx("th",{children:l("proposalUI.custom.table.itemName")}),e.jsx("th",{children:l("proposalUI.custom.table.price")}),e.jsx("th",{children:l("proposalUI.custom.table.taxable")}),e.jsx("th",{children:l("proposalUI.custom.table.actions")})]})}),e.jsx("tbody",{children:z.filter(e=>e.selectVersion===t?.versionName).map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:s+1}),e.jsx("td",{children:t.name}),e.jsxs("td",{children:["$",(Number(t.price)||0).toFixed(2)]}),e.jsx("td",{children:t.taxable?l("common.yes"):l("common.no")}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-danger text-white",onClick:()=>mt(t),children:l("proposalUI.custom.delete")})})]},s))})]})}),e.jsxs("div",{className:"d-block d-md-none",children:[z&&z.filter(e=>e.selectVersion===t?.versionName).length>0&&e.jsxs("div",{className:"row fw-bold text-muted mb-2 px-2",style:{fontSize:"0.85rem"},children:[e.jsx("div",{className:"col-1",children:"#"}),e.jsx("div",{className:"col-4",children:l("proposalUI.custom.table.itemName")}),e.jsx("div",{className:"col-3",children:l("proposalUI.custom.table.price")}),e.jsx("div",{className:"col-2",children:l("proposalUI.custom.table.taxable")}),e.jsx("div",{className:"col-2",children:l("proposalUI.custom.table.actions")})]}),z.filter(e=>e.selectVersion===t?.versionName).map((t,s)=>e.jsxs("div",{className:"row mb-2 py-2 border-bottom align-items-center",children:[e.jsx("div",{className:"col-1 text-center",children:s+1}),e.jsx("div",{className:"col-4",style:{fontSize:"0.9rem"},children:t.name}),e.jsxs("div",{className:"col-3",style:{fontSize:"0.9rem"},children:["$",(Number(t.price)||0).toFixed(2)]}),e.jsx("div",{className:"col-2 text-center",style:{fontSize:"0.9rem"},children:t.taxable?l("common.yes"):l("common.no")}),e.jsx("div",{className:"col-2",children:e.jsx("button",{onClick:()=>mt(t),style:{fontSize:"0.75rem",padding:"0.2rem 0.4rem"},children:l("proposalUI.custom.delete")})})]},s)),(!z||0===z.filter(e=>e.selectVersion===t?.versionName).length)&&e.jsx("div",{className:"text-muted text-center py-3",style:{fontSize:"0.9rem"},children:"No custom items added yet"})]})]}),e.jsx("div",{className:"mt-5 mb-5 d-flex justify-content-center totals-summary-mobile",children:e.jsx("table",{className:"table shadow-lg",style:{maxWidth:"500px"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:l("proposalDoc.priceSummary.cabinets")}),e.jsxs("td",{className:"text-center fw-medium",children:["$",t?.summary?.cabinets||"0"]})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:l("proposalDoc.priceSummary.assembly")}),e.jsxs("td",{className:"text-center",children:["$",t?.summary?.assemblyFee||"0"]})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:l("proposalDoc.priceSummary.modifications")}),e.jsxs("td",{className:"text-center",children:["$",t?.summary?.modificationsCost||"0"]})]}),e.jsxs("tr",{className:"table-secondary",children:[e.jsx("th",{children:l("proposalDoc.priceSummary.styleTotal")}),e.jsxs("td",{className:"text-center fw-semibold",children:["$",t?.summary?.styleTotal||"0"]})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:l("proposalUI.summary.discountPct")}),e.jsx("td",{className:"text-center",children:e.jsx("input",{type:"number",min:"0",max:"100",value:t?.summary?.discountPercent||"0",onChange:e=>{const t=Math.max(0,Math.min(100,parseFloat(e.target.value)||0));Ne(t)},style:{border:"none",outline:"none",background:"transparent",width:"60px",textAlign:"right",fontWeight:"500"}})})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:l("proposalDoc.priceSummary.total")}),e.jsxs("td",{className:"text-center",children:["$",t?.summary?.total||"0"]})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:l("proposalUI.summary.taxRate")}),e.jsxs("td",{className:"text-center",children:[t?.summary?.taxRate||"0","%"]})]}),e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:l("proposalDoc.priceSummary.tax")}),e.jsxs("td",{className:"text-center",children:["$",t?.summary?.taxAmount||"0"]})]}),e.jsxs("tr",{className:"table-success fw-bold",children:[e.jsx("th",{children:l("proposalDoc.priceSummary.grandTotal")}),e.jsxs("td",{className:"text-center",children:["$",t?.summary?.grandTotal||"0"]})]})]})})}),e.jsx(Wl,{itemModificationID:Ae,catalogData:Ie,visible:q,onClose:()=>H(!1),onSave:()=>{if(pe(!0),"existing"===G){if(!fe||!Z||Z<=0)return}else if("custom"===G&&(!ie||ie<=0||!te.trim()))return;const e=ye[Y]||[],t=Ie.find(e=>e.id==fe),s="existing"===G?{type:"existing",modificationId:fe,qty:Z,note:J,name:t?t.modificationName:"",price:t?t.price:0}:{type:"custom",qty:ie,price:re,taxable:!ke||ue,note:le,name:te},n=[...e,s];ht(Y,n),H(!1),Q(1),ee(""),ae(1),oe(""),ce(""),me(!ke),ge(""),pe(!1),se(""),"custom"==G&&(async(e,t)=>{try{const s={catalogId:t,name:e.name,price:e.price,note:e.note,description:e.note};await v.post("/api/manufacturers/catalogs/modificationsItems/add",s,{headers:Xl()})}catch(s){}})(s,Ae)},modificationType:G,setModificationType:_,existingModifications:Ie,selectedExistingMod:fe,setSelectedExistingMod:ge,existingModQty:Z,setExistingModQty:Q,existingModNote:J,setExistingModNote:ee,customModName:te,setCustomModName:se,customModQty:ie,setCustomModQty:ae,customModPrice:re,setCustomModPrice:oe,customModTaxable:ue,setCustomModTaxable:me,customModNote:le,setCustomModNote:ce,validationAttempted:he,isUserAdmin:ke})]})},Gl="https://app.nj.contractors",_l=({proposalId:t,onFilesChange:n})=>{const{t:i}=g(),[a,r]=s.useState([]),[o,l]=s.useState(!1),[c,d]=s.useState(!1),[u,m]=s.useState({open:!1,file:null}),h=s.useRef(null),p={images:["image/jpeg","image/jpg","image/png","image/gif","image/webp"],documents:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"],videos:["video/mp4","video/avi","video/mov","video/wmv","video/flv"]},f=[...p.images,...p.documents,...p.videos],y=52428800,x=e=>p.images.includes(e)?"image":p.documents.includes(e)?"document":p.videos.includes(e)?"video":"unknown",v=e=>{switch(e){case"image":return Me;case"video":return Ie;default:return Ve}},b=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},j=s.useCallback(async e=>{const s=[],o=[];if(Array.from(e).forEach(e=>{const t=(e=>f.includes(e.type)?e.size>y?i("files.validation.sizeExceeded",{size:b(y)}):null:i("files.validation.unsupportedType",{type:e.type}))(e);t?o.push(`${e.name}: ${t}`):s.push(e)}),o.length>0&&we.fire({icon:"error",title:i("files.invalidTitle"),html:o.join("<br>")}),0!==s.length){l(!0);try{const e=s.map(async e=>{const s=await(async e=>{const s=new FormData;s.append("file",e),s.append("proposalId",t),s.append("fileType",x(e.type));try{const e=await fetch(`${Gl}/api/proposals/upload-file`,{method:"POST",body:s,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error("Upload failed");return await e.json()}catch(n){throw n}})(e);return{id:s.id,name:e.name,size:e.size,type:x(e.type),mimeType:e.type,url:s.url,uploadedAt:(new Date).toISOString(),status:"uploaded"}}),o=await Promise.all(e),l=[...a,...o];r(l),n(l),we.fire({icon:"success",title:i("common.success"),text:i("files.uploadSuccess",{count:o.length}),timer:2e3,showConfirmButton:!1})}catch(c){we.fire({icon:"error",title:i("files.uploadFailedTitle"),text:i("files.uploadFailedText")})}finally{l(!1)}}},[a,t,n]),N=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?d(!0):"dragleave"===e.type&&d(!1)},[]),w=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),d(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&j(e.dataTransfer.files)},[j]),S=s.useCallback(e=>{e.target.files&&e.target.files[0]&&j(e.target.files)},[j]),C=e=>{we.fire({title:i("customers.confirmTitle"),text:i("files.confirmDelete",{name:e.name}),icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:i("customers.confirmYes")}).then(t=>{t.isConfirmed&&(async e=>{try{if(!(await fetch(`${Gl}/api/proposals/files/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).ok)throw new Error("Delete failed");const t=a.filter(t=>t.id!==e);r(t),n(t),we.fire({icon:"success",title:i("common.deleted"),text:i("files.deleteSuccess"),timer:2e3,showConfirmButton:!1})}catch(t){we.fire({icon:"error",title:i("files.deleteFailedTitle"),text:i("files.deleteFailedText")})}})(e.id)})},T=e=>{const t=document.createElement("a");t.href=e.url,t.download=e.name,document.body.appendChild(t),t.click(),document.body.removeChild(t)};return e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsxs(ue,{children:[e.jsx("h5",{className:"mb-0",children:i("files.title")}),e.jsx("small",{className:"text-muted",children:i("files.supportedList")})]}),e.jsxs(O,{children:[e.jsxs("div",{className:"border-2 border-dashed rounded p-5 text-center mb-4 "+(c?"border-primary bg-light":"border-secondary"),onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:w,style:{cursor:"pointer",transition:"all 0.3s ease",minHeight:"150px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},onClick:()=>h.current?.click(),children:[e.jsx("input",{ref:h,type:"file",multiple:!0,accept:f.join(","),onChange:S,style:{display:"none"}}),o?e.jsxs("div",{children:[e.jsx(me,{color:"primary",className:"mb-3"}),e.jsx("p",{className:"mb-0",children:i("files.uploading")})]}):e.jsxs("div",{children:[e.jsx(ne,{icon:ke,size:"3xl",className:"mb-3 text-primary"}),e.jsx("h6",{children:i("files.dropOrBrowse")}),e.jsx("p",{className:"text-muted mb-0",children:i("files.maxSize",{size:b(y)})})]})]}),a.length>0&&e.jsxs("div",{children:[e.jsx("h6",{className:"mb-3",children:i("files.uploadedCount",{count:a.length})}),e.jsx(W,{children:a.map(t=>e.jsx(q,{xs:12,sm:6,md:4,lg:3,className:"mb-3",children:e.jsx($,{className:"h-100",children:e.jsxs(O,{className:"p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx(he,{color:"image"===t.type?"success":"video"===t.type?"warning":"info",className:"text-uppercase",children:t.type}),e.jsxs(pe,{children:[e.jsx(fe,{color:"transparent",size:"sm",style:{padding:"2px 6px"},children:e.jsx(ne,{icon:k})}),e.jsxs(ge,{children:[e.jsxs(ye,{onClick:()=>(e=>{m({open:!0,file:e})})(t),children:[e.jsx(ne,{icon:k,className:"me-2"}),i("files.preview")]}),e.jsxs(ye,{onClick:()=>T(t),children:[e.jsx(ne,{icon:k,className:"me-2"}),i("files.download")]}),e.jsxs(ye,{onClick:()=>C(t),className:"text-danger",children:[e.jsx(ne,{icon:k,className:"me-2"}),i("common.delete")]})]})]})]}),e.jsx("div",{className:"text-center mb-2",children:e.jsx(ne,{icon:v(t.type),size:"2xl",className:"text-primary"})}),e.jsx("h6",{className:"small mb-1",title:t.name,children:t.name.length>20?`${t.name.substring(0,20)}...`:t.name}),e.jsx("small",{className:"text-muted",children:b(t.size)})]})})},t.id))})]}),0===a.length&&!o&&e.jsxs(xe,{color:"info",className:"mb-0",children:[e.jsx("strong",{children:i("files.noneYet")})," ",i("files.dropHint")]})]})]}),e.jsxs(Q,{visible:u.open,onClose:()=>m({open:!1,file:null}),size:"lg",alignment:"center",children:[e.jsx(ve,{closeButton:!0,children:e.jsx(be,{children:u.file?.name})}),e.jsx(J,{className:"text-center",children:u.file&&(D=u.file,"image"===D.type?e.jsx("img",{src:D.url,alt:D.name,style:{maxWidth:"100%",maxHeight:"400px",objectFit:"contain"}}):"video"===D.type?e.jsxs("video",{controls:!0,style:{maxWidth:"100%",maxHeight:"400px"},children:[e.jsx("source",{src:D.url,type:D.mimeType}),i("files.videoNotSupported")]}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx(ne,{icon:Ve,size:"4xl",className:"mb-3"}),e.jsx("p",{children:i("files.docPreviewNA")}),e.jsxs(U,{color:"primary",onClick:()=>T(D),children:[e.jsx(ne,{icon:k,className:"me-2"}),i("files.downloadToView")]})]}))}),e.jsxs(te,{children:[e.jsxs(U,{color:"primary",onClick:()=>T(u.file),children:[e.jsx(ne,{icon:k,className:"me-2"}),i("files.download")]}),e.jsx(U,{color:"secondary",onClick:()=>m({open:!1,file:null}),children:i("common.cancel")})]})]})]});var D},Zl=({setFormData:n,formData:i,updateFormData:a,setCurrentStep:c,setBackStep:d,sendToBackend:u,prevStep:y,hideBack:x})=>{const{t:v}=g(),b=m().shape({customerName:h().required(v("proposals.create.customerInfo.validation.customerName")),description:h().required(v("proposals.create.customerInfo.validation.description")),designer:h().required(v("proposals.create.customerInfo.validation.designer"))}),j=[{label:v("proposals.status.draft"),value:"Draft"},{label:v("proposals.status.followUp1"),value:"Follow up 1"},{label:v("proposals.status.followUp2"),value:"Follow up 2"},{label:v("proposals.status.followUp3"),value:"Follow up 3"},{label:v("proposals.status.measurementScheduled"),value:"Measurement Scheduled"},{label:v("proposals.status.measurementDone"),value:"Measurement done"},{label:v("proposals.status.designDone"),value:"Design done"},{label:v("proposals.status.proposalAccepted"),value:"Proposal accepted"},{label:v("proposals.status.proposalRejected"),value:"Proposal rejected"}],[N,w]=s.useState("item"),T=E(),{list:D}=A(e=>e.users),P=JSON.parse(localStorage.getItem("user")),k=P.userId,M=P?.group&&"contractor"===P.group.group_type,I=A(e=>e.manufacturers.byId),[F,R]=s.useState(!1),[B,L]=s.useState(!1),[$,O]=s.useState(null),[X,K]=s.useState(null),[ee,se]=s.useState(""),[ie,ae]=s.useState(null),[re,oe]=s.useState(null);s.useEffect(()=>{re&&"object"==typeof re&&T(S(re))},[re?.versionName,re?.manufacturer,T]),s.useEffect(()=>{i.manufacturersData?.forEach(e=>{e.manufacturer&&T(C({id:e.manufacturer,includeCatalog:!1}))})},[i.manufacturersData,T]);const le=i?.manufacturersData?.map(e=>({...e,manufacturerData:I[e.manufacturer]})),ce=le[ie];s.useEffect(()=>{le?.length>0&&null===ie&&(ae(0),oe(le[0]))},[le,ie]);const de=()=>{u("0")},ue=()=>{u("1")},me=()=>{u("2")},xe=D.filter(e=>e.id!==k).map(e=>({value:e.id,label:e.name}));return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"proposal-form-mobile",children:[e.jsx("div",{className:"button-group",children:!x&&e.jsx(U,{color:"secondary",variant:"outline",onClick:y,style:{borderRadius:"6px",minWidth:"90px"},children:"Back"})}),e.jsx(p,{initialValues:i,enableReinitialize:!0,validationSchema:b,onSubmit:e=>{a(e)},children:({values:s,errors:c,touched:d,handleChange:u,handleBlur:m,handleSubmit:h})=>e.jsxs(e.Fragment,{children:[e.jsx(z,{onSubmit:h,className:"proposal-summary-form",children:e.jsx("div",{className:"form-section",children:e.jsxs(W,{children:[e.jsxs(q,{xs:12,md:2,className:"mt-4",children:[e.jsx(H,{htmlFor:"designer",children:"Designer *"}),e.jsx(f,{isClearable:!0,id:"designer",name:"designer",options:xe,value:xe.find(e=>e.value===s.designer)||null,onChange:e=>{a({...i,designer:e?.value||""})},onBlur:m}),c.designer&&d.designer&&e.jsx("div",{className:"text-danger small mt-1",children:c.designer})]}),e.jsxs(q,{xs:12,md:2,className:"mt-4",children:[e.jsxs(H,{htmlFor:"description",children:[v("proposals.create.customerInfo.description")," *"]}),e.jsx(Y,{type:"text",id:"description",name:"description",value:s.description,onChange:u,onBlur:m,placeholder:v("proposals.create.customerInfo.descriptionPlaceholder")}),c.description&&d.description&&e.jsx("div",{className:"text-danger small mt-1",children:c.description})]}),e.jsxs(q,{xs:12,md:2,className:"mt-4",children:[e.jsx(H,{htmlFor:"status",children:v("proposals.headers.status")}),e.jsx(f,{isClearable:!0,options:j,value:j.find(e=>e.value===(s.status||"Draft")),onChange:e=>{a({...i,status:e?.value||"Draft"})},onBlur:m,inputId:"status"})]}),e.jsx(q,{xs:12,md:2,className:"mt-4",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(H,{htmlFor:"date",children:v("proposals.headers.date")}),e.jsx(t,{id:"date",selected:s.date?new Date(s.date):null,onChange:e=>{const t=s.date?new Date(s.date):null;(!t&&!!e||!!t&&!e||!!t&&!!e&&t.getTime()!==e.getTime())&&(u({target:{name:"date",value:e}}),a({...i,date:e}))},className:"form-control",dateFormat:"MM/dd/yyyy",wrapperClassName:"w-100",placeholderText:v("proposals.headers.date")}),e.jsx(V,{style:{position:"absolute",top:"70%",right:"12px",transform:"translateY(-50%)",color:"#6c757d",pointerEvents:"none"}})]})}),e.jsx(q,{xs:12,md:2,className:"mt-4",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(H,{htmlFor:"designDate",children:v("proposals.create.customerInfo.designDoneDate")}),e.jsx(t,{id:"designDate",selected:s.designDate?new Date(s.designDate):null,onChange:e=>{const t=s.designDate?new Date(s.designDate):null;(!t&&!!e||!!t&&!e||!!t&&!!e&&t.getTime()!==e.getTime())&&(u({target:{name:"designDate",value:e}}),a({...i,designDate:e}))},className:"form-control",dateFormat:"MM/dd/yyyy",wrapperClassName:"w-100",placeholderText:v("proposals.create.customerInfo.designDoneDate")}),e.jsx(V,{style:{position:"absolute",top:"70%",right:"12px",transform:"translateY(-50%)",color:"#6c757d",pointerEvents:"none"}})]})}),e.jsx(q,{xs:12,md:2,className:"mt-4",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(H,{htmlFor:"measurementDate",children:v("proposals.create.customerInfo.measurementDoneDate")}),e.jsx(t,{id:"measurementDate",selected:s.measurementDate?new Date(s.measurementDate):null,onChange:e=>{const t=s.measurementDate?new Date(s.measurementDate):null;(!t&&!!e||!!t&&!e||!!t&&!!e&&t.getTime()!==e.getTime())&&(u({target:{name:"measurementDate",value:e}}),a({...i,measurementDate:e}))},className:"form-control",dateFormat:"MM/dd/yyyy",wrapperClassName:"w-100",placeholderText:v("proposals.create.customerInfo.measurementDoneDate")}),e.jsx(V,{style:{position:"absolute",top:"70%",right:"12px",transform:"translateY(-50%)",color:"#6c757d",pointerEvents:"none"}})]})})]})})}),e.jsx("div",{className:"proposal-version-badges",children:le.map((t,s)=>{const n=s===ie;return e.jsxs(he,{className:"proposal-version-badge p-2 d-flex "+(n?"selected":""),style:{fontSize:"0.8rem",backgroundColor:n?"#084298":"#d0e7ff",color:n?"#d0e7ff":"#084298",borderRadius:"5px",transition:"all 0.3s ease"},onClick:()=>((e,t)=>{ae(e),oe(t)})(s,t),children:[e.jsxs("div",{children:[!M&&e.jsx("strong",{style:{display:"block"},children:t.versionName}),e.jsxs("small",{style:{fontSize:"0.7rem",color:n?"#a9c7ff":"#4a6fa5"},children:["$ ",t.manufacturerData?.costMultiplier||"N/A"]})]}),!M&&e.jsxs(pe,{onClick:e=>e.stopPropagation(),children:[e.jsx(fe,{color:"transparent",size:"sm",style:{padding:"0 4px",color:n?"#d0e7ff":"#084298",backgroundColor:"transparent",border:"none",outline:"none",boxShadow:"none",transition:"all 0.2s ease"},children:e.jsx(ne,{icon:l})}),e.jsxs(ge,{style:{minWidth:"120px",border:"1px solid #e0e0e0",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",borderRadius:"4px",padding:"4px 0"},children:[e.jsxs(ye,{onClick:()=>(e=>{O(e),se(le[e].versionName),R(!0)})(s),style:{padding:"6px 12px",fontSize:"0.875rem",color:"#333",transition:"all 0.2s ease"},children:[e.jsx(ne,{icon:Ee,className:"me-2"})," ",v("common.edit")]}),e.jsxs(ye,{onClick:()=>(e=>{K(e),L(!0)})(s),style:{padding:"6px 12px",fontSize:"0.875rem",color:"#dc3545",transition:"all 0.2s ease"},children:[e.jsx(ne,{icon:Ce,className:"me-2"})," ",v("common.delete")]}),e.jsxs(ye,{onClick:()=>(e=>{const t={...i.manufacturersData[e]};t.versionName=`Copy of ${t.versionName}`,a({manufacturersData:[...i.manufacturersData,t]})})(s),style:{padding:"6px 12px",fontSize:"0.875rem",color:"#333",transition:"all 0.2s ease"},children:[e.jsx(ne,{icon:r,className:"me-2"})," ",v("proposals.create.summary.duplicate")]})]})]})]},s)})}),e.jsx("hr",{}),e.jsx(je,{className:"proposal-tabs",children:e.jsxs(G,{variant:"tabs",className:"border-0",children:[e.jsx(_,{children:e.jsx(Z,{active:"item"===N,onClick:()=>{w("item")},style:{cursor:"pointer",border:"none",padding:"10px 20px",fontWeight:600,color:"item"===N?"#084298":"#6c757d",backgroundColor:"item"===N?"rgba(8, 66, 152, 0.1)":"transparent",borderBottom:"item"===N?"3px solid #084298":"none",transition:"all 0.3s ease",borderRadius:"4px 4px 0 0",marginRight:"4px",":hover":{color:"#084298",backgroundColor:"rgba(8, 66, 152, 0.05)"}},children:e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx(ne,{icon:o,className:"me-2"}),v("proposalColumns.items")]})})}),e.jsx(_,{})]})}),"item"===N&&e.jsx("div",{className:"tab-content mt-5",children:e.jsx(Kl,{selectedVersion:re,formData:i,setFormData:n,setSelectedVersion:oe,selectVersion:ce})}),"file"===N&&e.jsxs("div",{className:"tab-content mt-5",children:[e.jsx("h5",{children:v("proposals.create.files.title")}),e.jsx("p",{children:v("proposals.create.files.subtitle")}),e.jsx(_l,{proposalId:i.id,onFilesChange:e=>a({...i,files:e})})]}),e.jsx("hr",{}),e.jsxs("div",{className:"button-group",children:[e.jsx(U,{color:"secondary",variant:"outline",onClick:de,style:{minWidth:"140px"},children:v("common.save")}),e.jsx(U,{color:"success",onClick:ue,style:{minWidth:"140px"},children:v("proposals.create.summary.acceptAndOrder")}),e.jsx(U,{color:"danger",variant:"outline",onClick:me,style:{minWidth:"140px"},children:v("proposals.create.summary.rejectAndArchive")})]})]})})]}),e.jsxs(Q,{visible:F,onClose:()=>R(!1),alignment:"center",backdrop:"static",className:"modal-lg",children:[e.jsx(ve,{closeButton:!0,children:e.jsx(be,{children:v("proposals.create.summary.editVersionTitle")})}),e.jsx(J,{children:e.jsx(Y,{className:"mb-3",value:ee,onChange:e=>se(e.target.value),placeholder:v("proposals.create.manufacturer.labels.versionName")})}),e.jsxs(te,{children:[e.jsx(U,{color:"secondary",onClick:()=>R(!1),children:v("common.cancel")}),e.jsx(U,{color:"primary",onClick:()=>{if(i.manufacturersData.find(e=>e.versionName===ee))return void we.fire({icon:"error",title:"Duplicate Manufacturer Version",text:`Manufacturer Version Name "${ee}" already exists.`});const e=[...i.manufacturersData];e[$].versionName=ee,a({manufacturersData:e}),R(!1)},children:v("common.save")})]})]}),e.jsxs(Q,{visible:B,onClose:()=>L(!1),alignment:"center",backdrop:"static",className:"modal-sm",children:[e.jsx(ve,{closeButton:!0,children:e.jsx(be,{children:v("customers.confirmTitle")})}),e.jsx(J,{children:v("proposals.create.summary.confirmDeleteVersion")}),e.jsxs(te,{children:[e.jsx(U,{color:"secondary",onClick:()=>L(!1),children:v("common.cancel")}),e.jsx(U,{color:"danger",onClick:()=>{const e=i.manufacturersData.filter((e,t)=>t!==X);a({manufacturersData:e}),L(!1)},children:v("common.delete")})]})]})]})},Ql=Ae(({isContractor:t,contractorGroupId:n,contractorModules:r,contractorGroupName:o})=>{const l=i(),{t:m}=g(),h="yes"===new URLSearchParams(l.search).get("quick"),[p,f]=s.useState(h?2:1),[y,x]=s.useState(!1),[v,b]=s.useState({customerId:"",customerName:"",customerEmail:"",designer:"",description:"",measurementDone:!1,designDone:!1,measurementDate:null,designDate:null,location:"",salesRep:"",leadSource:"",type:"",manufacturerId:"",versionName:"",assembled:!0,totalPrice:0,status:"",manufacturersData:[]}),[j,N]=s.useState(!1),[w,S]=s.useState(!1),[D,P]=s.useState(!1),k=E(),M=A(e=>e.manufacturers.selected),[V,z]=s.useState(null),W=a(),[q,H]=s.useState(!0);s.useEffect(()=>{if(!q)return;const e=e=>{e.preventDefault(),e.returnValue=""},t=t=>{window.confirm("You have unsaved changes. Are you sure you want to leave?")?window.removeEventListener("beforeunload",e):window.history.pushState(null,"",window.location.pathname)};return window.history.pushState(null,"",window.location.pathname),window.addEventListener("beforeunload",e),window.addEventListener("popstate",t),()=>{window.removeEventListener("beforeunload",e),window.removeEventListener("popstate",t)}},[q]),s.useEffect(()=>{v.manufacturerId&&k(C({id:v.manufacturerId,includeCatalog:!1}))},[v.manufacturerId,k]);const Y=e=>{b({...v,...e})},X=e=>{const t=[...v.manufacturersData],s=t[t.length-1];s&&(s.selectedStyle=e,t[t.length-1]=s,Y({...v,manufacturersData:t})),K()},K=()=>{f(p+1)},G=()=>{if(p<=1)return void W("/quotes");let e=y?4:p-1;e<1&&(e=1),f(e)},_=async e=>{try{const t={action:e,formData:{...v,type:e}};1==(await k(T(t))).payload.success&&(we.fire("Success!","Proposal saved successfully!","success"),H(!1),W("/quotes"))}catch(t){}},Z=(()=>{const e=[{number:1,title:m("proposals.create.steps.1"),icon:I},{number:2,title:m("proposals.create.steps.2"),icon:F},{number:3,title:m("proposals.create.steps.3"),icon:R},{number:4,title:m("proposals.create.steps.4"),icon:B}];return e.find(e=>e.number===p)||e[0]})();return e.jsxs(Ne,{fluid:!0,className:"dashboard-container",style:{backgroundColor:"#f8fafc",minHeight:"100vh"},children:[e.jsx(Se,{title:Z.title,icon:Z.icon,subtitle:m("proposals.create.stepOf",{current:p,total:4}),badge:{text:m(h?"proposals.create.quickMode":"proposals.create.standardMode"),variant:"secondary"},rightContent:4!==p?null:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsxs(U,{className:"shadow-sm px-4 fw-semibold d-flex align-items-center",style:{backgroundColor:"print"===V?"#218838":"#28a745",color:"#fff",borderRadius:"8px",border:"none",transition:"all 0.3s ease"},onMouseEnter:()=>z("print"),onMouseLeave:()=>z(null),onClick:()=>N(!0),children:[e.jsx(B,{className:"me-2"}),m("proposals.create.actions.print")]}),!t&&e.jsxs(e.Fragment,{children:[e.jsxs(U,{className:"shadow-sm px-4 fw-semibold d-flex align-items-center",style:{backgroundColor:"email"===V?"#138496":"#17a2b8",color:"#fff",borderRadius:"8px",border:"none",transition:"all 0.3s ease"},onMouseEnter:()=>z("email"),onMouseLeave:()=>z(null),onClick:()=>S(!0),children:[e.jsx(L,{className:"me-2"}),m("proposals.create.actions.email")]}),e.jsxs(U,{className:"shadow-sm px-4 fw-semibold d-flex align-items-center",style:{backgroundColor:"contract"===V?"#e0a800":"#ffc107",color:"#212529",borderRadius:"8px",border:"none",transition:"all 0.3s ease"},onMouseEnter:()=>z("contract"),onMouseLeave:()=>z(null),onClick:()=>P(!0),children:[e.jsx(R,{className:"me-2"}),m("proposals.create.actions.contract")]})]})]})}),e.jsx($,{className:"proposal-progress-bar",children:e.jsx(O,{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between position-relative w-100",children:[e.jsx("div",{className:"position-absolute w-100",style:{height:"2px",backgroundColor:"#e9ecef",top:"50%",transform:"translateY(-50%)",zIndex:1}}),e.jsx("div",{className:"position-absolute",style:{height:"2px",backgroundColor:"#212529",top:"50%",transform:"translateY(-50%)",width:(p-1)/3*100+"%",transition:"all 0.3s ease",zIndex:2}}),[1,2,3,4].map((t,s)=>e.jsx("div",{className:"d-flex align-items-center justify-content-center fw-bold proposal-step-number position-relative",style:{width:"36px",height:"36px",borderRadius:"50%",backgroundColor:t<=p?"#212529":"#ffffff",color:t<=p?"#ffffff":"#495057",fontSize:"14px",fontWeight:t<=p?"800":"600",transition:"all 0.3s ease",border:t<=p?"2px solid #343a40":"2px solid #dee2e6",boxShadow:t<=p?"0 3px 6px rgba(0,0,0,0.2)":"0 1px 2px rgba(0,0,0,0.05)",zIndex:3,flexShrink:0,textShadow:t<=p?"0 2px 4px rgba(0, 0, 0, 0.9)":"none"},children:t},t))]})})}),e.jsx("div",{className:"mb-4",children:(()=>{switch(p){case 1:return e.jsx($l,{formData:v,updateFormData:Y,nextStep:K,prevStep:G,hideBack:!1,isContractor:t,contractorGroupId:n});case 2:return e.jsx(Ol,{formData:v,updateFormData:Y,nextStep:K,prevStep:G,hideBack:!1});case 3:return M&&0!==Object.keys(M).length?e.jsx(zl,{formData:v,updateFormData:Y,nextStep:K,prevStep:G,manufacturerData:M,onStyleSelect:X,hideBack:!1}):e.jsx($,{className:"border-0 shadow-sm",children:e.jsxs(O,{className:"text-center py-5",children:[e.jsx(me,{color:"primary",size:"lg"}),e.jsx("p",{className:"text-muted mt-3 mb-0",children:m("proposals.create.loadingManufacturer")})]})});case 4:return e.jsx(Zl,{setFormData:b,formData:v,updateFormData:Y,prevStep:G,manufacturerData:M,setCurrentStep:f,setBackStep:x,sendToBackend:_,hideBack:!1});default:return null}})()}),e.jsx(c,{show:j,onClose:()=>N(!1),formData:v}),e.jsx(d,{show:w,onClose:()=>S(!1),formData:v}),e.jsx(u,{show:D,onClose:()=>P(!1)})]})},"proposals",["proposals:create"]);export{Ql as default};
