import{j as s}from"./date-vendor-DfW9khhA.js";import{h as e,u as a,r as i}from"./react-vendor-Dhx0OYb2.js";import{h as r,a3 as n,b as t,d as o,r as l,R as c,S as m,a4 as d,V as u,a7 as h,w as p,a8 as g,e as f}from"./ui-vendor-pFEG3kEv.js";import{u as x,a as j}from"./redux-vendor-B0DAdCYB.js";import{u as v,d as N,Q as b,x as w,H as y,b as S,R as C}from"./index-CRxBN8Fj.js";import{S as P}from"./utils-vendor-Nl-sF5xe.js";import{P as R}from"./PageHeader-UABCfWk-.js";import{c as G,f as B,b as k}from"./DefaultLayout-CNvO87EM.js";import{c as F}from"./cil-arrow-left-D66Kb3Zq.js";import{c as z}from"./cil-save-CHBg7z_U.js";import"./form-vendor-C_vzjFiG.js";import"./icons-vendor-CVrEPnlB.js";const O={name:"",email:"",password:"",confirmPassword:"",userGroup:"",location:"",isSalesRep:!1},q=()=>{const{t:q}=v(),{id:E}=e(),A=N(E),D=x(),H=a(),[J,Q]=i.useState(O),T=i.useRef(O),[_,I]=i.useState({}),[L,M]=i.useState(!1),{selected:V}=j(s=>s.users),{list:W}=j(s=>s.locations),{list:$=[]}=j(s=>s.usersGroup||{}),K=j(s=>s.customization);i.useEffect(()=>{A&&D(b(A)),D(w()),D(y())},[D,A]),i.useEffect(()=>{V&&A&&(Q({name:V.name||"",email:V.email||"",password:"",confirmPassword:"",userGroup:V.group_id||"",location:V.location||"",isSalesRep:V.isSalesRep||!1}),T.current={...T.current,name:V.name||"",email:V.email||"",userGroup:V.group_id||"",location:V.location||"",isSalesRep:V.isSalesRep||!1})},[V,A]);const U=s=>{const{name:e,value:a,type:i,checked:r}=s.target;Q(s=>({...s,[e]:"checkbox"===i?r:a}))};return s.jsxs(r,{fluid:!0,className:"settings-form-container",children:[s.jsx(R,{title:q("settings.users.edit.title"),subtitle:q("settings.users.edit.subtitle"),icon:G,showBackButton:!0,onBackClick:()=>H("/settings/users")}),s.jsxs(n,{onSubmit:async s=>{if(s.preventDefault(),(()=>{const s={};return J.name.trim()||(s.name=q("settings.users.form.validation.nameRequired")),J.password!==J.confirmPassword&&(s.confirmPassword=q("settings.users.form.validation.passwordMismatch")),J.userGroup||(s.userGroup=q("settings.users.form.validation.userGroupRequired")),J.location.trim()||(s.location=q("settings.users.form.validation.locationRequired")),I(s),0===Object.keys(s).length})()){M(!0);try{const s=await D(C({id:A,data:J}));200==s?.payload?.status&&(P.fire(q("common.success")+"!",s.payload.message,"success"),H("/settings/users"))}catch(e){P.fire(q("common.error"),e.message||q("settings.users.alerts.genericError"),"error")}finally{M(!1)}}},children:[s.jsx(t,{className:"settings-section-card",children:s.jsxs(o,{className:"p-3 p-md-4",children:[s.jsxs("div",{className:"settings-section-header",children:[s.jsx("div",{className:"settings-section-icon",children:s.jsx(l,{icon:G,size:"sm"})}),s.jsx("h6",{className:"settings-section-title",children:q("settings.users.form.titles.basicInfo")})]}),s.jsxs(c,{children:[s.jsx(m,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsxs(d,{htmlFor:"name",className:"settings-form-label",children:[q("settings.users.form.labels.fullName"),s.jsx("span",{className:"text-danger ms-1",children:"*"})]}),s.jsx(u,{id:"name",name:"name",value:J.name,onChange:U,invalid:!!_.name,className:"settings-form-input"}),s.jsx(h,{invalid:!0,children:_.name})]})}),s.jsx(m,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx(d,{htmlFor:"email",className:"settings-form-label",children:q("settings.users.form.labels.email")}),s.jsx(u,{id:"email",name:"email",type:"email",value:J.email,disabled:!0,className:"settings-form-input",style:{cursor:"not-allowed",backgroundColor:"#e9ecef"}})]})})]})]})}),s.jsx(t,{className:"settings-section-card",children:s.jsxs(o,{className:"p-3 p-md-4",children:[s.jsxs("div",{className:"settings-section-header",children:[s.jsx("div",{className:"settings-section-icon",children:s.jsx(l,{icon:B,size:"sm"})}),s.jsx("h6",{className:"settings-section-title",children:q("settings.users.form.titles.security")})]}),s.jsxs(c,{children:[s.jsx(m,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx(d,{htmlFor:"password",className:"settings-form-label",children:q("settings.users.form.labels.password")}),s.jsx(u,{id:"password",name:"password",type:"password",value:J.password,onChange:U,invalid:!!_.password,className:"settings-form-input",placeholder:q("settings.users.form.placeholders.password")}),s.jsx(h,{invalid:!0,children:_.password})]})}),s.jsx(m,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx(d,{htmlFor:"confirmPassword",className:"settings-form-label",children:q("settings.users.form.labels.confirmPassword")}),s.jsx(u,{id:"confirmPassword",name:"confirmPassword",type:"password",value:J.confirmPassword,onChange:U,invalid:!!_.confirmPassword,className:"settings-form-input",placeholder:q("settings.users.form.placeholders.confirmPassword")}),s.jsx(h,{invalid:!0,children:_.confirmPassword})]})})]})]})}),s.jsx(t,{className:"settings-section-card",children:s.jsxs(o,{className:"p-3 p-md-4",children:[s.jsxs("div",{className:"settings-section-header",children:[s.jsx("div",{className:"settings-section-icon",children:s.jsx(l,{icon:k,size:"sm"})}),s.jsx("h6",{className:"settings-section-title",children:q("settings.users.form.titles.details")})]}),s.jsxs(c,{children:[s.jsx(m,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsxs(d,{htmlFor:"userGroup",className:"settings-form-label",children:[q("settings.users.form.labels.userGroup"),s.jsx("span",{className:"text-danger ms-1",children:"*"})]}),s.jsxs(p,{id:"userGroup",name:"userGroup",value:J.userGroup,onChange:U,invalid:!!_.userGroup,className:"settings-form-input",children:[s.jsx("option",{value:"",children:q("settings.users.form.select.group")}),$.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),s.jsx(h,{invalid:!0,children:_.userGroup})]})}),s.jsx(m,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsxs(d,{htmlFor:"location",className:"settings-form-label",children:[q("settings.users.form.labels.location"),s.jsx("span",{className:"text-danger ms-1",children:"*"})]}),s.jsxs(p,{id:"location",name:"location",value:J.location,onChange:U,invalid:!!_.location,className:"settings-form-input",children:[s.jsx("option",{value:"",children:q("settings.users.form.select.location")}),W.map(e=>s.jsx("option",{value:e.id,children:e.address},e.id))]}),s.jsx(h,{invalid:!0,children:_.location})]})})]}),s.jsx("div",{className:"mb-3",children:s.jsx(g,{label:s.jsx("span",{className:"settings-form-label",children:q("settings.users.form.labels.salesRep")}),id:"isSalesRep",name:"isSalesRep",checked:J.isSalesRep,onChange:U,size:"lg",style:{transform:"scale(1.1)"}})})]})}),s.jsx(t,{className:"settings-form-actions",children:s.jsx(o,{className:"p-3 p-md-4",children:s.jsxs("div",{className:"d-flex flex-column flex-md-row gap-2 gap-md-3 justify-content-end",children:[s.jsxs(f,{type:"button",color:"light",className:"settings-form-cancel-btn order-2 order-md-1",onClick:()=>{JSON.stringify(J)!==JSON.stringify(T.current)?P.fire({title:q("common.confirm")||"Are you sure?",text:q("settings.users.form.alerts.leaveWarning"),icon:"warning",showCancelButton:!0,confirmButtonText:q("settings.users.form.alerts.leaveAnyway"),cancelButtonText:q("settings.users.form.alerts.stayOnPage"),confirmButtonColor:"#d33",cancelButtonColor:"#6c757d"}).then(s=>{s.isConfirmed&&H("/settings/users")}):H("/settings/users")},children:[s.jsx(l,{icon:F,className:"me-2"}),q("common.cancel")]}),s.jsx(f,{type:"submit",disabled:L,className:"settings-form-submit-btn order-1 order-md-2",style:{backgroundColor:K?.headerBg||"#28a745",borderColor:K?.headerBg||"#28a745",color:S(K?.headerBg||"#28a745"),border:"none"},children:L?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",style:{width:"14px",height:"14px"},children:s.jsx("span",{className:"visually-hidden",children:q("common.loading")})}),q("settings.users.edit.updating")]}):s.jsxs(s.Fragment,{children:[s.jsx(l,{icon:z,className:"me-2"}),q("settings.users.edit.update")]})})]})})})]})]})};export{q as default};
