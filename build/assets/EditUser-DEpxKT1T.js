import{j as s}from"./date-vendor-DfW9khhA.js";import{h as e,u as a,r as i}from"./react-vendor-Dhx0OYb2.js";import{h as r,b as n,d as t,R as l,S as o,r as c,e as m,a3 as d,a4 as u,V as h,a7 as x,w as j,a8 as g}from"./ui-vendor-pFEG3kEv.js";import{u as p,a as f}from"./redux-vendor-B0DAdCYB.js";import{u as N,d as v,Q as b,x as w,H as y,R as S}from"./index-BxG4qwLs.js";import{S as R}from"./utils-vendor-Nl-sF5xe.js";import{c as G,f as C,b as P}from"./DefaultLayout-CDydDzk1.js";import{c as k}from"./cil-arrow-left-D66Kb3Zq.js";import{c as F}from"./cil-save-CHBg7z_U.js";import"./form-vendor-C_vzjFiG.js";import"./icons-vendor-CVrEPnlB.js";const z={name:"",email:"",password:"",confirmPassword:"",userGroup:"",location:"",isSalesRep:!1},B=()=>{const{t:B}=N(),{id:O}=e(),q=v(O),E=p(),A=a(),[D,J]=i.useState(z),T=i.useRef(z),[_,H]=i.useState({}),[I,L]=i.useState(!1),{selected:M}=f(s=>s.users),{list:Q}=f(s=>s.locations),{list:V=[]}=f(s=>s.usersGroup||{});i.useEffect(()=>{q&&E(b(q)),E(w()),E(y())},[E,q]),i.useEffect(()=>{M&&q&&(J({name:M.name||"",email:M.email||"",password:"",confirmPassword:"",userGroup:M.group_id||"",location:M.location||"",isSalesRep:M.isSalesRep||!1}),T.current={...T.current,name:M.name||"",email:M.email||"",userGroup:M.group_id||"",location:M.location||"",isSalesRep:M.isSalesRep||!1})},[M,q]);const W=s=>{const{name:e,value:a,type:i,checked:r}=s.target;J(s=>({...s,[e]:"checkbox"===i?r:a}))};return s.jsxs(r,{fluid:!0,className:"settings-form-container",children:[s.jsx(n,{className:"settings-form-header",children:s.jsx(t,{children:s.jsxs(l,{className:"align-items-center",children:[s.jsx(o,{children:s.jsxs("div",{className:"d-flex align-items-center flex-column flex-md-row text-center text-md-start",children:[s.jsx("div",{className:"settings-form-icon",children:s.jsx(c,{icon:G,size:"sm",className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h5",{className:"settings-form-title",children:B("settings.users.edit.title")}),s.jsx("p",{className:"settings-form-subtitle d-none d-md-block",children:B("settings.users.edit.subtitle")})]})]})}),s.jsx(o,{xs:"12",className:"mt-3 mt-md-0",md:"auto",children:s.jsxs(m,{color:"light",className:"settings-back-button w-100 w-md-auto",onClick:()=>A("/settings/users"),children:[s.jsx(c,{icon:k,className:"me-2"}),B("common.back")]})})]})})}),s.jsxs(d,{onSubmit:async s=>{if(s.preventDefault(),(()=>{const s={};return D.name.trim()||(s.name=B("settings.users.form.validation.nameRequired")),D.password!==D.confirmPassword&&(s.confirmPassword=B("settings.users.form.validation.passwordMismatch")),D.userGroup||(s.userGroup=B("settings.users.form.validation.userGroupRequired")),D.location.trim()||(s.location=B("settings.users.form.validation.locationRequired")),H(s),0===Object.keys(s).length})()){L(!0);try{const s=await E(S({id:q,data:D}));200==s?.payload?.status&&(R.fire(B("common.success")+"!",s.payload.message,"success"),A("/settings/users"))}catch(e){R.fire(B("common.error"),e.message||B("settings.users.alerts.genericError"),"error")}finally{L(!1)}}},children:[s.jsx(n,{className:"settings-section-card",children:s.jsxs(t,{className:"p-3 p-md-4",children:[s.jsxs("div",{className:"settings-section-header",children:[s.jsx("div",{className:"settings-section-icon",children:s.jsx(c,{icon:G,size:"sm"})}),s.jsx("h6",{className:"settings-section-title",children:B("settings.users.form.titles.basicInfo")})]}),s.jsxs(l,{children:[s.jsx(o,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsxs(u,{htmlFor:"name",className:"settings-form-label",children:[B("settings.users.form.labels.fullName"),s.jsx("span",{className:"text-danger ms-1",children:"*"})]}),s.jsx(h,{id:"name",name:"name",value:D.name,onChange:W,invalid:!!_.name,className:"settings-form-input"}),s.jsx(x,{invalid:!0,children:_.name})]})}),s.jsx(o,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx(u,{htmlFor:"email",className:"settings-form-label",children:B("settings.users.form.labels.email")}),s.jsx(h,{id:"email",name:"email",type:"email",value:D.email,disabled:!0,className:"settings-form-input",style:{cursor:"not-allowed",backgroundColor:"#e9ecef"}})]})})]})]})}),s.jsx(n,{className:"settings-section-card",children:s.jsxs(t,{className:"p-3 p-md-4",children:[s.jsxs("div",{className:"settings-section-header",children:[s.jsx("div",{className:"settings-section-icon",children:s.jsx(c,{icon:C,size:"sm"})}),s.jsx("h6",{className:"settings-section-title",children:B("settings.users.form.titles.security")})]}),s.jsxs(l,{children:[s.jsx(o,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx(u,{htmlFor:"password",className:"settings-form-label",children:B("settings.users.form.labels.password")}),s.jsx(h,{id:"password",name:"password",type:"password",value:D.password,onChange:W,invalid:!!_.password,className:"settings-form-input",placeholder:B("settings.users.form.placeholders.password")}),s.jsx(x,{invalid:!0,children:_.password})]})}),s.jsx(o,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsx(u,{htmlFor:"confirmPassword",className:"settings-form-label",children:B("settings.users.form.labels.confirmPassword")}),s.jsx(h,{id:"confirmPassword",name:"confirmPassword",type:"password",value:D.confirmPassword,onChange:W,invalid:!!_.confirmPassword,className:"settings-form-input",placeholder:B("settings.users.form.placeholders.confirmPassword")}),s.jsx(x,{invalid:!0,children:_.confirmPassword})]})})]})]})}),s.jsx(n,{className:"settings-section-card",children:s.jsxs(t,{className:"p-3 p-md-4",children:[s.jsxs("div",{className:"settings-section-header",children:[s.jsx("div",{className:"settings-section-icon",children:s.jsx(c,{icon:P,size:"sm"})}),s.jsx("h6",{className:"settings-section-title",children:B("settings.users.form.titles.details")})]}),s.jsxs(l,{children:[s.jsx(o,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsxs(u,{htmlFor:"userGroup",className:"settings-form-label",children:[B("settings.users.form.labels.userGroup"),s.jsx("span",{className:"text-danger ms-1",children:"*"})]}),s.jsxs(j,{id:"userGroup",name:"userGroup",value:D.userGroup,onChange:W,invalid:!!_.userGroup,className:"settings-form-input",children:[s.jsx("option",{value:"",children:B("settings.users.form.select.group")}),V.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),s.jsx(x,{invalid:!0,children:_.userGroup})]})}),s.jsx(o,{md:6,children:s.jsxs("div",{className:"mb-3",children:[s.jsxs(u,{htmlFor:"location",className:"settings-form-label",children:[B("settings.users.form.labels.location"),s.jsx("span",{className:"text-danger ms-1",children:"*"})]}),s.jsxs(j,{id:"location",name:"location",value:D.location,onChange:W,invalid:!!_.location,className:"settings-form-input",children:[s.jsx("option",{value:"",children:B("settings.users.form.select.location")}),Q.map(e=>s.jsx("option",{value:e.id,children:e.address},e.id))]}),s.jsx(x,{invalid:!0,children:_.location})]})})]}),s.jsx("div",{className:"mb-3",children:s.jsx(g,{label:s.jsx("span",{className:"settings-form-label",children:B("settings.users.form.labels.salesRep")}),id:"isSalesRep",name:"isSalesRep",checked:D.isSalesRep,onChange:W,size:"lg",style:{transform:"scale(1.1)"}})})]})}),s.jsx(n,{className:"settings-form-actions",children:s.jsx(t,{className:"p-3 p-md-4",children:s.jsxs("div",{className:"d-flex flex-column flex-md-row gap-2 gap-md-3 justify-content-end",children:[s.jsxs(m,{type:"button",color:"light",className:"settings-form-cancel-btn order-2 order-md-1",onClick:()=>{JSON.stringify(D)!==JSON.stringify(T.current)?R.fire({title:B("common.confirm")||"Are you sure?",text:B("settings.users.form.alerts.leaveWarning"),icon:"warning",showCancelButton:!0,confirmButtonText:B("settings.users.form.alerts.leaveAnyway"),cancelButtonText:B("settings.users.form.alerts.stayOnPage"),confirmButtonColor:"#d33",cancelButtonColor:"#6c757d"}).then(s=>{s.isConfirmed&&A("/settings/users")}):A("/settings/users")},children:[s.jsx(c,{icon:k,className:"me-2"}),B("common.cancel")]}),s.jsx(m,{type:"submit",color:"success",disabled:I,className:"settings-form-submit-btn order-1 order-md-2",children:I?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",style:{width:"14px",height:"14px"},children:s.jsx("span",{className:"visually-hidden",children:B("common.loading")})}),B("settings.users.edit.updating")]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{icon:F,className:"me-2"}),B("settings.users.edit.update")]})})]})})})]})]})};export{B as default};
