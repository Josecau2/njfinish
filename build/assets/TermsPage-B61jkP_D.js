import{j as s}from"./date-vendor-DfW9khhA.js";import{r as e}from"./react-vendor-Dhx0OYb2.js";import{a as t}from"./redux-vendor-B0DAdCYB.js";import{P as a}from"./PageHeader-UABCfWk-.js";import{i as r,j as n,k as i,s as c}from"./DefaultLayout-CNvO87EM.js";import{u as l}from"./index-CRxBN8Fj.js";import{R as o,S as d,b as m,d as j,a3 as h,a5 as u,e as x,Z as v,_ as p,$ as g,a0 as f,a1 as b,a2 as N,v as w}from"./ui-vendor-pFEG3kEv.js";import"./form-vendor-C_vzjFiG.js";import"./utils-vendor-Nl-sF5xe.js";import"./icons-vendor-CVrEPnlB.js";const y=()=>{const{t:y}=l(),S=t(s=>s.auth.user),C=e.useMemo(()=>r(S),[S]),[E,k]=e.useState(""),[P,V]=e.useState(null),[A,D]=e.useState(!1),[F,H]=e.useState({version:null,users:[]}),L=async()=>{try{const s=await n(),e=s?.data?.data;if(e?(k(e.content||""),V(e.version)):(k(""),V(null)),C){const s=await i();H(s?.data?.data||{version:null,users:[]})}}catch(s){k(""),V(null)}};e.useEffect(()=>{L()},[]);const M=async s=>{if(C){D(!0);try{await c({content:E,bumpVersion:!!s}),await L()}catch(e){}finally{D(!1)}}};return C?s.jsxs(s.Fragment,{children:[s.jsx(a,{title:y("settings.terms.title","Terms & Conditions"),subtitle:y("settings.terms.subtitle","Edit terms and track acceptance")}),s.jsxs(o,{className:"g-3",children:[s.jsx(d,{lg:6,children:s.jsx(m,{className:"border-0 shadow-sm",children:s.jsxs(j,{children:[s.jsx("h6",{className:"mb-3",children:y("settings.terms.editor","Editor")}),s.jsxs(h,{children:[s.jsx(u,{rows:16,value:E,onChange:s=>k(s.target.value),placeholder:y("settings.terms.placeholder","Enter terms and conditions...")}),s.jsxs("div",{className:"mt-3 d-flex gap-2",children:[s.jsx(x,{color:"primary",disabled:A,onClick:()=>M(!1),children:A?y("common.saving","Saving..."):y("common.save","Save")}),s.jsx(x,{color:"warning",variant:"outline",disabled:A,onClick:()=>M(!0),children:y("settings.terms.publishNew","Publish as new version")})]}),P&&s.jsxs("div",{className:"text-muted mt-2 small",children:[y("settings.terms.currentVersion","Current version"),": ",P]})]})]})})}),s.jsx(d,{lg:6,children:s.jsx(m,{className:"border-0 shadow-sm",children:s.jsxs(j,{children:[s.jsx("h6",{className:"mb-3",children:y("settings.terms.acceptance","Acceptance")}),s.jsxs("div",{className:"text-muted small mb-2",children:[y("settings.terms.version","Version"),": ",F?.version??"-"]}),s.jsxs(v,{hover:!0,responsive:!0,children:[s.jsx(p,{children:s.jsxs(g,{children:[s.jsx(f,{children:y("common.user","User")}),s.jsx(f,{children:y("common.email","Email")}),s.jsx(f,{className:"text-end",children:y("settings.terms.status","Status")})]})}),s.jsx(b,{children:(F.users||[]).map(e=>s.jsxs(g,{children:[s.jsx(N,{children:e.name||"-"}),s.jsx(N,{children:e.email||"-"}),s.jsx(N,{className:"text-end",children:e.accepted?s.jsx(w,{color:"success",children:y("settings.terms.accepted","Accepted")}):s.jsx(w,{color:"secondary",children:y("settings.terms.pending","Pending")})})]},e.id))})]})]})})})]})]}):null};export{y as default};
