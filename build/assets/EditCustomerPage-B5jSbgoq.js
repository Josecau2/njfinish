import{j as e}from"./date-vendor-DfW9khhA.js";import{r as s,h as o,u as a}from"./react-vendor-Dhx0OYb2.js";import{a as r}from"./redux-vendor-B0DAdCYB.js";import{u as l,b as i,d as n}from"./index-BxG4qwLs.js";import{h as t,b as c,d,C as m,e as u,r as h,a3 as p,R as x,S as f,a4 as j,T as b,U as v,V as g,a7 as y,w as N}from"./ui-vendor-pFEG3kEv.js";import{P as C}from"./PageHeader-UABCfWk-.js";import{a as S,S as k}from"./utils-vendor-Nl-sF5xe.js";import{C as w}from"./editor-vendor-RxX6MBW0.js";import{C as I}from"./ckeditor-BRc8bNm1.js";import{c as R}from"./cil-arrow-left-D66Kb3Zq.js";import{c as z}from"./cil-pencil-m516yCOw.js";import{c as D,a as O}from"./DefaultLayout-CDydDzk1.js";import{c as M}from"./cil-envelope-closed-DSbcONbs.js";import{c as T}from"./cil-building-DVuwBvuD.js";import{c as A}from"./cil-phone-4mwkG2LD.js";import{c as P}from"./cil-save-CHBg7z_U.js";import"./form-vendor-C_vzjFiG.js";import"./icons-vendor-CVrEPnlB.js";const q=({title:s,icon:o,children:a,className:r=""})=>e.jsx(c,{className:`border-0 shadow-sm mb-4 ${r}`,children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"40px",height:"40px",backgroundColor:"#e7f3ff",color:"#0d6efd"},children:e.jsx(h,{icon:o,size:"sm"})}),e.jsx("h6",{className:"mb-0 fw-semibold text-dark",children:s})]}),a]})}),F=({label:s,name:o,type:a="text",required:r=!1,icon:l=null,placeholder:i="",value:n,onChange:t,isInvalid:c,feedback:d,inputRef:m,...u})=>e.jsxs("div",{className:"mb-3",children:[e.jsxs(j,{htmlFor:o,className:"fw-medium text-dark mb-2",children:[s,r&&e.jsx("span",{className:"text-danger ms-1",children:"*"})]}),e.jsxs(b,{children:[l&&e.jsx(v,{style:{background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",border:"1px solid #e3e6f0",borderRight:"none"},children:e.jsx(h,{icon:l,size:"sm",style:{color:"#6c757d"}})}),e.jsx(g,{id:o,name:o,type:a,value:n,onChange:t,invalid:c,ref:m,placeholder:i,style:{border:"1px solid "+(c?"#dc3545":"#e3e6f0"),borderRadius:l?"0 10px 10px 0":"10px",fontSize:"14px",padding:"12px 16px",transition:"all 0.3s ease",borderLeft:l?"none":"1px solid #e3e6f0"},onFocus:e=>{c||(e.target.style.borderColor="#0d6efd",e.target.style.boxShadow="0 0 0 0.2rem rgba(13, 110, 253, 0.25)")},onBlur:e=>{c||(e.target.style.borderColor="#e3e6f0",e.target.style.boxShadow="none")},...u})]}),d&&e.jsx(y,{invalid:!0,children:d})]}),H=({label:s,name:o,required:a=!1,icon:r=null,children:l,value:i,onChange:n,isInvalid:t,feedback:c,inputRef:d,...m})=>e.jsxs("div",{className:"mb-3",children:[e.jsxs(j,{htmlFor:o,className:"fw-medium text-dark mb-2",children:[s,a&&e.jsx("span",{className:"text-danger ms-1",children:"*"})]}),e.jsxs(b,{children:[r&&e.jsx(v,{style:{background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",border:"1px solid #e3e6f0",borderRight:"none"},children:e.jsx(h,{icon:r,size:"sm",style:{color:"#6c757d"}})}),e.jsx(N,{id:o,name:o,value:i,onChange:n,invalid:t,ref:d,style:{border:"1px solid "+(t?"#dc3545":"#e3e6f0"),borderRadius:r?"0 10px 10px 0":"10px",fontSize:"14px",padding:"12px 16px",transition:"all 0.3s ease",borderLeft:r?"none":"1px solid #e3e6f0"},onFocus:e=>{t||(e.target.style.borderColor="#0d6efd",e.target.style.boxShadow="0 0 0 0.2rem rgba(13, 110, 253, 0.25)")},onBlur:e=>{t||(e.target.style.borderColor="#e3e6f0",e.target.style.boxShadow="none")},...m,children:l})]}),c&&e.jsx(y,{invalid:!0,children:c})]}),L=()=>{const{t:b}=l(),v=r(e=>e.customization).headerBg||"#667eea",g=i(v),[y,N]=s.useState({name:"",email:"",address:"",aptOrSuite:"",city:"",state:"",zipCode:"",homePhone:"",mobile:"",leadSource:"",customerType:"Home Owner",defaultDiscount:0,companyName:"",note:""}),[L,V]=s.useState({}),[W,$]=s.useState(!0),[E,K]=s.useState(!1),U=s.useRef({}),{customerId:Y}=o(),B=n(Y),G=a(),J="https://app.nj.contractors";s.useEffect(()=>{B&&(async()=>{try{$(!0);const e=await S.get(`${J}/api/customers/${B}`);N(e.data)}catch(e){k.fire(b("common.error"),b("customers.form.alerts.notFound"),"error")}finally{$(!1)}})()},[B,J]);const X=e=>{const{name:s,value:o}=e.target;N(e=>({...e,[s]:o})),V(e=>({...e,[s]:""}))};return W?e.jsx(t,{fluid:!0,className:"p-2 m-2 bg-body",style:{minHeight:"100vh"},children:e.jsx(c,{className:"border-0 shadow-sm",children:e.jsxs(d,{className:"text-center py-5",children:[e.jsx(m,{color:"primary",size:"lg"}),e.jsx("p",{className:"text-muted mt-3 mb-0",children:b("customers.loading")})]})})}):e.jsxs(t,{fluid:!0,className:"p-2 m-2 edit-customer-page bg-body",style:{minHeight:"100vh"},children:[e.jsx(C,{title:e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"12px"},children:e.jsx(h,{icon:z,style:{fontSize:"24px",color:"white"}})}),b("customers.form.titles.edit")]}),subtitle:"Update customer profile with detailed information",rightContent:e.jsxs(u,{color:"light",variant:"outline",className:"me-2",onClick:()=>window.history.back(),style:{borderColor:"rgba(255, 255, 255, 0.3)",color:"rgba(255, 255, 255, 0.9)"},children:[e.jsx(h,{icon:R,className:"me-1",size:"sm"}),b("common.back")]})}),e.jsxs(p,{onSubmit:async e=>{e.preventDefault();const s=(()=>{const e={};return["name","email","address","city","state","zipCode","mobile","leadSource"].forEach(s=>{y[s]?.toString().trim()||(e[s]=b("customers.form.validation.required"))}),y.email&&!/^\S+@\S+\.\S+$/.test(y.email)&&(e.email=b("customers.form.validation.invalidEmail")),y.zipCode&&!/^\d{5}$/.test(y.zipCode)&&(e.zipCode=b("customers.form.validation.zip5")),y.mobile&&!/^\d{10}$/.test(y.mobile)&&(e.mobile=b("customers.form.validation.mobile10")),e})();if(V(s),Object.keys(s).length){const e=Object.keys(s)[0];return void U.current[e]?.focus()}K(!0);try{await S.put(`${J}/api/customers/update/${B}`,y),k.fire({icon:"success",title:b("customers.form.alerts.updatedTitle"),text:b("customers.form.alerts.updatedText"),timer:2e3,showConfirmButton:!1}),G("/customers")}catch(o){k.fire({icon:"error",title:b("common.error"),text:b("customers.form.alerts.updateFailed")})}finally{K(!1)}},children:[e.jsxs(q,{title:b("customers.form.titles.basicInfo"),icon:D,children:[e.jsxs(x,{children:[e.jsx(f,{md:6,children:e.jsx(F,{label:b("customers.form.labels.fullName"),name:"name",required:!0,icon:D,placeholder:b("customers.form.placeholders.fullName"),value:y.name,onChange:X,isInvalid:!!L.name,feedback:L.name,inputRef:e=>U.current.name=e})}),e.jsx(f,{md:6,children:e.jsx(F,{label:b("customers.form.labels.email"),name:"email",type:"email",required:!0,icon:M,placeholder:b("customers.form.placeholders.email"),value:y.email,onChange:X,isInvalid:!!L.email,feedback:L.email,inputRef:e=>U.current.email=e})})]}),e.jsxs(x,{children:[e.jsx(f,{md:6,children:e.jsxs(H,{label:b("customers.form.labels.customerType"),name:"customerType",icon:D,value:y.customerType,onChange:X,isInvalid:!!L.customerType,feedback:L.customerType,inputRef:e=>U.current.customerType=e,children:[e.jsx("option",{value:"Home Owner",children:b("customers.form.types.homeOwner")}),e.jsx("option",{value:"Contractor",children:b("customers.form.types.contractor")}),e.jsx("option",{value:"Company",children:b("customers.form.types.company")}),e.jsx("option",{value:"Sub Contractor",children:b("customers.form.types.subContractor")})]})}),e.jsx(f,{md:6,children:e.jsx(F,{label:b("customers.form.labels.companyName"),name:"companyName",icon:T,placeholder:b("customers.form.placeholders.companyName"),value:y.companyName,onChange:X,isInvalid:!!L.companyName,feedback:L.companyName,inputRef:e=>U.current.companyName=e})})]})]}),e.jsxs(q,{title:b("customers.form.titles.addressInfo"),icon:O,children:[e.jsxs(x,{children:[e.jsx(f,{md:8,children:e.jsx(F,{label:b("customers.form.labels.address"),name:"address",required:!0,icon:O,placeholder:b("customers.form.placeholders.street"),value:y.address,onChange:X,isInvalid:!!L.address,feedback:L.address,inputRef:e=>U.current.address=e})}),e.jsx(f,{md:4,children:e.jsx(F,{label:b("customers.form.labels.aptSuite"),name:"aptOrSuite",placeholder:b("customers.form.placeholders.aptSuite"),value:y.aptOrSuite,onChange:X,isInvalid:!!L.aptOrSuite,feedback:L.aptOrSuite,inputRef:e=>U.current.aptOrSuite=e})})]}),e.jsxs(x,{children:[e.jsx(f,{md:4,children:e.jsx(F,{label:b("customers.form.labels.city"),name:"city",required:!0,placeholder:b("customers.form.placeholders.city"),value:y.city,onChange:X,isInvalid:!!L.city,feedback:L.city,inputRef:e=>U.current.city=e})}),e.jsx(f,{md:4,children:e.jsxs(H,{label:b("customers.form.labels.state"),name:"state",required:!0,value:y.state,onChange:X,isInvalid:!!L.state,feedback:L.state,inputRef:e=>U.current.state=e,children:[e.jsx("option",{value:"",children:b("customers.form.select.selectState")}),e.jsx("option",{value:"AL",children:"Alabama"}),e.jsx("option",{value:"AK",children:"Alaska"}),e.jsx("option",{value:"AZ",children:"Arizona"}),e.jsx("option",{value:"AR",children:"Arkansas"}),e.jsx("option",{value:"CA",children:"California"}),e.jsx("option",{value:"CO",children:"Colorado"}),e.jsx("option",{value:"CT",children:"Connecticut"}),e.jsx("option",{value:"DE",children:"Delaware"}),e.jsx("option",{value:"FL",children:"Florida"}),e.jsx("option",{value:"GA",children:"Georgia"}),e.jsx("option",{value:"HI",children:"Hawaii"}),e.jsx("option",{value:"ID",children:"Idaho"}),e.jsx("option",{value:"IL",children:"Illinois"}),e.jsx("option",{value:"IN",children:"Indiana"}),e.jsx("option",{value:"IA",children:"Iowa"}),e.jsx("option",{value:"KS",children:"Kansas"}),e.jsx("option",{value:"KY",children:"Kentucky"}),e.jsx("option",{value:"LA",children:"Louisiana"}),e.jsx("option",{value:"ME",children:"Maine"}),e.jsx("option",{value:"MD",children:"Maryland"}),e.jsx("option",{value:"MA",children:"Massachusetts"}),e.jsx("option",{value:"MI",children:"Michigan"}),e.jsx("option",{value:"MN",children:"Minnesota"}),e.jsx("option",{value:"MS",children:"Mississippi"}),e.jsx("option",{value:"MO",children:"Missouri"}),e.jsx("option",{value:"MT",children:"Montana"}),e.jsx("option",{value:"NE",children:"Nebraska"}),e.jsx("option",{value:"NV",children:"Nevada"}),e.jsx("option",{value:"NH",children:"New Hampshire"}),e.jsx("option",{value:"NJ",children:"New Jersey"}),e.jsx("option",{value:"NM",children:"New Mexico"}),e.jsx("option",{value:"NY",children:"New York"}),e.jsx("option",{value:"NC",children:"North Carolina"}),e.jsx("option",{value:"ND",children:"North Dakota"}),e.jsx("option",{value:"OH",children:"Ohio"}),e.jsx("option",{value:"OK",children:"Oklahoma"}),e.jsx("option",{value:"OR",children:"Oregon"}),e.jsx("option",{value:"PA",children:"Pennsylvania"}),e.jsx("option",{value:"RI",children:"Rhode Island"}),e.jsx("option",{value:"SC",children:"South Carolina"}),e.jsx("option",{value:"SD",children:"South Dakota"}),e.jsx("option",{value:"TN",children:"Tennessee"}),e.jsx("option",{value:"TX",children:"Texas"}),e.jsx("option",{value:"UT",children:"Utah"}),e.jsx("option",{value:"VT",children:"Vermont"}),e.jsx("option",{value:"VA",children:"Virginia"}),e.jsx("option",{value:"WA",children:"Washington"}),e.jsx("option",{value:"WV",children:"West Virginia"}),e.jsx("option",{value:"WI",children:"Wisconsin"}),e.jsx("option",{value:"WY",children:"Wyoming"})]})}),e.jsx(f,{md:4,children:e.jsx(F,{label:b("customers.form.labels.zipCode"),name:"zipCode",required:!0,placeholder:b("customers.form.placeholders.zip"),value:y.zipCode,onChange:X,isInvalid:!!L.zipCode,feedback:L.zipCode,inputRef:e=>U.current.zipCode=e})})]})]}),e.jsx(q,{title:b("customers.form.titles.contactInfo"),icon:A,children:e.jsxs(x,{children:[e.jsx(f,{md:6,children:e.jsx(F,{label:b("customers.form.labels.mobile"),name:"mobile",required:!0,icon:A,placeholder:b("customers.form.placeholders.mobile"),value:y.mobile,onChange:X,isInvalid:!!L.mobile,feedback:L.mobile,inputRef:e=>U.current.mobile=e})}),e.jsx(f,{md:6,children:e.jsx(F,{label:b("customers.form.labels.homePhone"),name:"homePhone",icon:A,placeholder:b("customers.form.placeholders.homePhone"),value:y.homePhone,onChange:X,isInvalid:!!L.homePhone,feedback:L.homePhone,inputRef:e=>U.current.homePhone=e})})]})}),e.jsxs(q,{title:b("customers.form.titles.businessInfo"),icon:T,children:[e.jsxs(x,{children:[e.jsx(f,{md:6,children:e.jsx(F,{label:b("customers.form.labels.leadSource"),name:"leadSource",required:!0,placeholder:b("customers.form.placeholders.leadSource"),value:y.leadSource,onChange:X,isInvalid:!!L.leadSource,feedback:L.leadSource,inputRef:e=>U.current.leadSource=e})}),e.jsx(f,{md:6,children:e.jsx(F,{label:b("customers.form.labels.defaultDiscount"),name:"defaultDiscount",type:"number",min:0,max:100,placeholder:b("customers.form.placeholders.defaultDiscount"),value:y.defaultDiscount,onChange:X,isInvalid:!!L.defaultDiscount,feedback:L.defaultDiscount,inputRef:e=>U.current.defaultDiscount=e})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{className:"fw-medium text-dark mb-2",children:b("customers.form.labels.notes")}),e.jsx("div",{style:{border:"1px solid #e3e6f0",borderRadius:"10px",overflow:"hidden"},children:e.jsx(w,{editor:I,data:y.note||"",onChange:(e,s)=>{(e=>{N(s=>({...s,note:e}))})(s.getData())},config:{toolbar:["bold","italic","link","bulletedList","numberedList"],placeholder:b("customers.form.placeholders.notes")}})})]})]}),e.jsx(c,{className:"border-0 shadow-sm",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"d-flex gap-3 justify-content-end form-buttons",children:[e.jsxs(u,{color:"light",size:"lg",onClick:()=>G("/customers"),className:"px-4 fw-semibold",style:{borderRadius:"5px",border:"1px solid #e3e6f0",transition:"all 0.3s ease"},children:[e.jsx(h,{icon:R,className:"me-2"}),b("customers.form.actions.cancel")]}),e.jsx(u,{type:"submit",size:"lg",disabled:E,className:"px-5 fw-semibold",style:{borderRadius:"5px",border:"none",background:v,color:g,transition:"all 0.3s ease"},children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",style:{width:"16px",height:"16px"},children:e.jsx("span",{className:"visually-hidden",children:b("common.loading")})}),b("customers.form.actions.updating")]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{icon:P,className:"me-2"}),b("customers.form.actions.update")]})})]})})})]})]})};export{L as default};
