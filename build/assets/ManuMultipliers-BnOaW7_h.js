import{j as e}from"./date-vendor-DfW9khhA.js";import{r as s}from"./react-vendor-Dhx0OYb2.js";import{a as t,u as r}from"./redux-vendor-B0DAdCYB.js";import{u as l,H as i,I as a,J as o,K as n,L as d}from"./index-BxG4qwLs.js";import{i as c,a3 as m,l as u,a as p,h as x,R as h,S as g,a4 as j,V as b,m as f,e as y,v as N,r as v,b as w,d as G,T as C,U as S,Z as k,_ as z,$ as _,a0 as P,a1 as B,a2 as R,a8 as F}from"./ui-vendor-pFEG3kEv.js";import{P as H}from"./PageHeader-UABCfWk-.js";import{S as O}from"./utils-vendor-Nl-sF5xe.js";import{P as T}from"./PaginationComponent-Du09fPLe.js";import{c as $,b as L}from"./DefaultLayout-CDydDzk1.js";import{c as M}from"./cil-search-CDkY_4k-.js";import{c as E}from"./cil-pencil-m516yCOw.js";import"./form-vendor-C_vzjFiG.js";import"./icons-vendor-CVrEPnlB.js";const W=({show:r,onClose:i,manufacturer:a,onSave:o})=>{const{t:n}=l();t(e=>e.customization);const[d,N]=s.useState({name:"",multiplier:"",enabled:!1}),[v,w]=s.useState(null);s.useEffect(()=>{a&&N({name:a.user_group.name||"",multiplier:a.multiplier||"",enabled:a.enabled||!1})},[a]);const G={backgroundColor:"#f8f9fa",border:"1px solid #dcdcdc",borderRadius:"8px",padding:"10px 14px",fontSize:"15px"},C={...G,backgroundColor:"#f1f3f5",color:"#6c757d",cursor:"not-allowed"};return e.jsx(c,{visible:r,onClose:i,size:"lg",backdrop:"static",alignment:"center",scrollable:!0,children:e.jsxs(m,{onSubmit:e=>{e.preventDefault(),w(null),o(d)},children:[e.jsxs(u,{className:"p-0",children:[e.jsx(H,{title:n("settings.userGroups.multipliers.modal.title"),cardClassName:"mb-0 rounded-top-3"}),e.jsxs("div",{className:"p-4",children:[v&&e.jsx(p,{color:"danger",children:v}),e.jsxs(x,{fluid:!0,children:[e.jsxs(h,{className:"mb-3",children:[e.jsxs(g,{xs:6,md:6,children:[e.jsx(j,{htmlFor:"name",children:n("settings.userGroups.multipliers.modal.labels.name")}),e.jsx(b,{type:"text",id:"name",name:"name",value:d.name,readOnly:!0,placeholder:n("settings.userGroups.multipliers.modal.placeholders.name"),style:C})]}),e.jsxs(g,{xs:6,md:6,children:[e.jsx(j,{htmlFor:"multiplier",children:n("settings.userGroups.multipliers.modal.labels.multiplier")}),e.jsx(b,{type:"number",step:"0.01",id:"multiplier",name:"multiplier",value:d.multiplier,onChange:e=>{const s=e.target.value;(""===s||/^(?:\d{0,4})(?:\.\d{0,2})?$/.test(s))&&N(e=>({...e,multiplier:s}))},placeholder:n("settings.userGroups.multipliers.modal.placeholders.multiplier"),style:G})]})]}),e.jsx(h,{children:e.jsx(g,{xs:6,md:6,children:e.jsxs("div",{className:"form-check form-switch mt-5",style:{transform:"scale(1.0)",display:"flex",alignItems:"center"},children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"enabled",name:"enabled",checked:d.enabled,onChange:e=>{const{name:s,value:t,type:r,checked:l}=e.target;N(e=>({...e,[s]:"checkbox"===r?l:t}))}}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:"enabled",style:{fontSize:"1.1rem"},children:n("settings.userGroups.multipliers.modal.labels.enabled")})]})})})]})]})]}),e.jsxs(f,{children:[e.jsx(y,{color:"secondary",variant:"outline",onClick:i,children:n("common.cancel")}),e.jsx(y,{color:"primary",type:"submit",children:n("common.save")})]})]})})},D=()=>{const{t:c}=l(),m=r(),{list:u=[],allGroups:p=[]}=t(e=>e.usersGroup||{}),{list:j=[]}=t(e=>e.multiManufacturer||{}),f=t(e=>e.customization),[D,I]=s.useState(""),[V,J]=s.useState("name"),[K,U]=s.useState("desc"),[X,Z]=s.useState(!1),[q,A]=s.useState(null),[Q,Y]=s.useState(1),[ee,se]=s.useState(10);s.useEffect(()=>{m(i()),m(a()),m(o())},[m]);const te=p.map(e=>{const s=u.find(s=>s.user_group?.id===e.id);return{id:s?.id||null,user_group:e,multiplier:s?.multiplier||null,enabled:s?.enabled||0}}).filter(e=>2!==e.user_group.id),re=te.filter(e=>(e.user_group?.name||"").toLowerCase().includes(D.toLowerCase())),le=(Q-1)*ee,ie=le+ee,ae=re.slice(le,ie),oe=Math.ceil(re.length/ee),ne=te.filter(e=>1===e.enabled).length,de=te.length-ne;return e.jsxs(x,{fluid:!0,className:"p-2 m-2",style:{backgroundColor:"#f8fafc",minHeight:"100vh"},children:[e.jsx(H,{title:e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"12px"},children:e.jsx(v,{icon:$,style:{fontSize:"24px",color:"white"}})}),c("settings.userGroups.multipliers.header")]}),subtitle:c("settings.userGroups.multipliers.subtitle"),rightContent:e.jsxs(N,{color:"light",className:"px-3 py-2",style:{borderRadius:"5px",fontSize:"12px",fontWeight:"500",color:"#6c757d"},children:[e.jsx(v,{icon:$,className:"me-1",size:"sm"}),te.length," ",c("settings.userGroups.multipliers.groups")]})}),e.jsxs(h,{className:"mb-2",children:[e.jsx(g,{md:4,children:e.jsx(w,{className:"border-0 shadow-sm h-100",children:e.jsx(G,{className:"text-center py-4",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"50px",height:"50px",backgroundColor:"#e6ffed",color:"#28a745"},children:e.jsx(v,{icon:L,size:"lg"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0 fw-bold text-success",children:ne}),e.jsx("small",{className:"text-muted",children:c("settings.userGroups.multipliers.stats.activeGroups")})]})]})})})}),e.jsx(g,{md:4,children:e.jsx(w,{className:"border-0 shadow-sm h-100",children:e.jsx(G,{className:"text-center py-4",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"50px",height:"50px",backgroundColor:"#ffe6e6",color:"#dc3545"},children:e.jsx(v,{icon:L,size:"lg"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0 fw-bold text-danger",children:de}),e.jsx("small",{className:"text-muted",children:c("settings.userGroups.multipliers.stats.inactiveGroups")})]})]})})})}),e.jsx(g,{md:4,children:e.jsx(w,{className:"border-0 shadow-sm h-100",children:e.jsx(G,{className:"text-center py-4",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"50px",height:"50px",backgroundColor:`${f.headerBg||"#667eea"}20`,color:f.headerBg||"#667eea"},children:e.jsx(v,{icon:$,size:"lg"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0 fw-bold text-primary",children:u.length}),e.jsx("small",{className:"text-muted",children:c("settings.userGroups.multipliers.stats.totalGroups")})]})]})})})})]}),e.jsx(w,{className:"border-0 shadow-sm mb-1",children:e.jsx(G,{children:e.jsxs(h,{className:"align-items-center",children:[e.jsx(g,{md:6,lg:4,children:e.jsxs(C,{children:[e.jsx(S,{style:{background:"none",border:"none"},children:e.jsx(v,{icon:M})}),e.jsx(b,{type:"text",placeholder:c("settings.userGroups.multipliers.searchPlaceholder"),value:D,onChange:e=>{I(e.target.value),Y(1)},style:{border:"1px solid #e3e6f0",borderRadius:"10px",fontSize:"14px",padding:"12px 16px"}})]})}),e.jsx(g,{md:6,lg:8,className:"text-md-end mt-3 mt-md-0",children:e.jsx("span",{className:"text-muted small",children:c("settings.userGroups.multipliers.showing",{count:re?.length||0,total:te?.length||0})})})]})})}),e.jsx(w,{className:"border-0 shadow-sm",children:e.jsxs(G,{className:"p-0",children:[e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs(k,{hover:!0,responsive:!0,className:"mb-0",children:[e.jsx(z,{style:{backgroundColor:"#f8f9fa"},children:e.jsxs(_,{children:[e.jsx(P,{className:"border-0 fw-semibold text-muted py-3",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(v,{icon:$,size:"sm"}),c("settings.userGroups.multipliers.table.groupName")]})}),e.jsx(P,{className:"border-0 fw-semibold text-muted py-3",children:c("settings.userGroups.multipliers.table.multiplier")}),e.jsx(P,{className:"border-0 fw-semibold text-muted py-3",children:c("settings.userGroups.multipliers.table.status")}),e.jsx(P,{className:"border-0 fw-semibold text-muted py-3 text-center",children:c("settings.userGroups.multipliers.table.actions")})]})}),e.jsx(B,{children:0===ae?.length?e.jsx(_,{children:e.jsx(R,{colSpan:"4",className:"text-center py-5",children:e.jsxs("div",{className:"text-muted",children:[e.jsx(v,{icon:M,size:"xl",className:"mb-3 opacity-25"}),e.jsx("p",{className:"mb-0",children:c("settings.userGroups.multipliers.empty.title")}),e.jsx("small",{children:c("settings.userGroups.multipliers.empty.subtitle")})]})})}):ae.map(s=>e.jsxs(_,{style:{transition:"all 0.2s ease"},children:[e.jsx(R,{className:"py-3 border-0 border-bottom border-light",children:e.jsx("div",{className:"fw-medium text-dark",children:s.user_group?.name||c("common.na")})}),e.jsx(R,{className:"py-3 border-0 border-bottom border-light",children:e.jsx(N,{color:"primary",className:"px-3 py-2",style:{borderRadius:"20px",fontSize:"12px",fontWeight:"600"},children:s.multiplier?`${s.multiplier}`:c("common.na")})}),e.jsx(R,{className:"py-3 border-0 border-bottom border-light",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(F,{checked:1===s.enabled,onChange:()=>((e,s)=>{const t={enabled:!s};e.id?m(d({id:e.id,data:t})).unwrap().then(()=>{m(o()),m(a()),O.fire({toast:!0,position:"top",icon:"success",title:c("settings.userGroups.multipliers.toast.updateSuccess"),showConfirmButton:!1,timer:1500,width:"360px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}).catch(e=>{O.fire({toast:!0,position:"top",icon:"error",title:c("settings.userGroups.multipliers.toast.updateFailed"),showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}):(t.user_group_id=e.user_group.id,t.multiplier=1,m(n(t)).unwrap().then(()=>{m(o()),m(a()),O.fire({toast:!0,position:"top",icon:"success",title:c("settings.userGroups.multipliers.toast.updateSuccess"),showConfirmButton:!1,timer:1500,width:"360px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}).catch(e=>{O.fire({toast:!0,position:"top",icon:"error",title:c("settings.userGroups.multipliers.toast.updateFailed"),showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}))})(s,s.enabled),style:{transform:"scale(1.1)"}}),e.jsx(N,{color:1===s.enabled?"success":"secondary",className:"px-2 py-1",style:{borderRadius:"15px",fontSize:"10px",fontWeight:"500"},children:1===s.enabled?c("settings.userGroups.multipliers.status.active"):c("settings.userGroups.multipliers.status.inactive")})]})}),e.jsx(R,{className:"py-3 border-0 border-bottom border-light text-center",children:e.jsx(y,{color:"light",size:"sm",className:"p-2",onClick:()=>(e=>{A(e),Z(!0)})(s),title:c("settings.userGroups.multipliers.actions.edit"),"aria-label":c("settings.userGroups.multipliers.actions.edit"),style:{borderRadius:"8px",border:"1px solid #e3e6f0",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=`${f.headerBg||"#667eea"}20`,e.currentTarget.style.borderColor=f.headerBg||"#667eea"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="",e.currentTarget.style.borderColor="#e3e6f0"},children:e.jsx(v,{icon:E,size:"sm",style:{color:f.headerBg||"#667eea"}})})})]},s.id||`group-${s.user_group.id}`))})]})}),e.jsx(T,{currentPage:Q,totalPages:oe,onPageChange:Y,itemsPerPage:ee})]})}),e.jsx(W,{show:X,onClose:()=>{Z(!1),A(null)},manufacturer:q,onSave:e=>{q&&(q.id?m(d({id:q.id,data:e})).unwrap().then(e=>{Z(!1),A(null),O.fire(c("common.success")+"!",e.message||c("settings.userGroups.multipliers.toast.updateSuccess"),"success"),m(o()),m(a())}).catch(e=>{O.fire(c("common.error"),e.message||c("settings.userGroups.multipliers.toast.updateFailed"),"error")}):(e.user_group_id=q.user_group.id,m(n(e)).unwrap().then(e=>{Z(!1),A(null),O.fire(c("common.success")+"!",e.message||c("settings.userGroups.multipliers.toast.updateSuccess"),"success"),m(o()),m(a())}).catch(e=>{O.fire(c("common.error"),e.message||c("settings.userGroups.multipliers.toast.updateFailed"),"error")})))}})]})};export{D as default};
