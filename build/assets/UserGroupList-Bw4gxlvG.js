import{j as s}from"./date-vendor-DfW9khhA.js";import{u as e,r}from"./react-vendor-Dhx0OYb2.js";import{u as t,a as n}from"./redux-vendor-B0DAdCYB.js";import{h as o,C as a,a as c,R as i,S as l,b as d,c as m,e as u,r as p,d as x,Z as j,_ as h,$ as g,a0 as f,a1 as y,a2 as N,v as b,a8 as v}from"./ui-vendor-pFEG3kEv.js";import{u as G,H as w,g as $,m as A,P as k}from"./index-CRxBN8Fj.js";import{c as z}from"./cil-plus-D8mtC-W5.js";import{c as S}from"./cil-pencil-m516yCOw.js";import"./form-vendor-C_vzjFiG.js";import"./utils-vendor-Nl-sF5xe.js";import"./icons-vendor-CVrEPnlB.js";const _=()=>{const{t:_}=G(),C=t(),E=e(),{allGroups:U=[],loading:D,error:H}=n(s=>s.usersGroup||{}),I=U,[J,O]=r.useState(null);r.useEffect(()=>{C(w())},[C]);const F=s=>{const e=`/${$(6)}/${$(8)}`+A("/settings/users/group/edit/:id",{id:s});E(e)},L=(e,r)=>{let t;if("string"==typeof e.modules)try{t=JSON.parse(e.modules)}catch(c){t={dashboard:!1,proposals:!1,customers:!1,resources:!1}}else t=e.modules||{dashboard:!1,proposals:!1,customers:!1,resources:!1};const n=!0===t[r],o=J===`${e.id}-${r}`;return s.jsx(v,{id:`${e.id}-${r}`,checked:n,disabled:"contractor"!==e.group_type||o,onChange:()=>(async(s,e,r)=>{O(`${s}-${e}`);try{let t;if("string"==typeof r)try{t=JSON.parse(r)}catch(c){t={dashboard:!1,proposals:!1,customers:!1,resources:!1}}else t=r||{dashboard:!1,proposals:!1,customers:!1,resources:!1};const n={...t,[e]:!t[e]};await C(k({id:s,data:{modules:n}})).unwrap()}catch(t){}finally{O(null)}})(e.id,r,t),label:o?s.jsx(a,{size:"sm"}):"",size:"sm"})};return D?s.jsx(o,{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx(a,{}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading user groups..."})]})}):H?s.jsx(o,{children:s.jsxs(c,{color:"danger",children:[s.jsx("strong",{children:"Error loading user groups:"})," ",H.message||H.toString()||"Unknown error"]})}):s.jsx(i,{children:s.jsx(l,{xs:12,children:s.jsxs(d,{className:"mb-4",children:[s.jsxs(m,{className:"d-flex justify-content-between align-items-center",children:[s.jsx("strong",{children:_("settings.userGroups.header")}),s.jsxs(u,{color:"primary",onClick:()=>{E("/settings/users/group/create")},className:"d-flex align-items-center gap-2",children:[s.jsx(p,{icon:z,size:"sm"}),_("settings.userGroups.actions.create")]})]}),s.jsxs(x,{children:[H&&s.jsxs(c,{color:"danger",className:"mb-3",children:[_("settings.userGroups.loadFailed"),": ",H.message||H.toString()||_("common.error")]}),s.jsx("div",{className:"d-none d-md-block",children:s.jsxs(j,{hover:!0,responsive:!0,children:[s.jsx(h,{children:s.jsxs(g,{children:[s.jsx(f,{children:_("settings.userGroups.table.name")}),s.jsx(f,{children:_("settings.userGroups.table.type")}),s.jsx(f,{children:_("contractorsAdmin.modules.dashboard")}),s.jsx(f,{children:_("contractorsAdmin.modules.proposals")}),s.jsx(f,{children:_("contractorsAdmin.modules.customers")}),s.jsx(f,{children:_("contractorsAdmin.modules.resources")}),s.jsx(f,{children:_("settings.userGroups.table.actions")})]})}),s.jsx(y,{children:0===I.length?s.jsx(g,{children:s.jsx(N,{colSpan:"7",className:"text-center py-4",children:_("settings.userGroups.empty")})},"empty-state"):I.map(e=>s.jsxs(g,{children:[s.jsxs(N,{children:[s.jsx("strong",{children:e.name||"Unnamed Group"}),!e.name&&s.jsxs("small",{className:"text-muted d-block",children:["ID: ",e.id]})]}),s.jsx(N,{children:s.jsx(b,{color:"contractor"===e.group_type?"info":"secondary",shape:"rounded-pill",children:"contractor"===e.group_type?_("settings.userGroups.types.contractor"):_("settings.userGroups.types.standard")})}),s.jsx(N,{children:L(e,"dashboard")}),s.jsx(N,{children:L(e,"proposals")}),s.jsx(N,{children:L(e,"customers")}),s.jsx(N,{children:L(e,"resources")}),s.jsx(N,{children:s.jsx(u,{color:"primary",variant:"outline",size:"sm",onClick:()=>F(e.id),className:"me-2",title:"Edit Group",children:s.jsx(p,{icon:S,size:"sm"})})})]},e.id))})]})}),s.jsx("div",{className:"d-md-none user-groups-mobile",children:0===I.length?s.jsx("div",{className:"text-center text-muted py-4",children:_("settings.userGroups.empty")}):I.map(e=>s.jsxs("div",{className:"mobile-card mb-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:e.name||"Unnamed Group"}),!e.name&&s.jsxs("small",{className:"text-muted",children:["ID: ",e.id]})]}),s.jsx(b,{color:"contractor"===e.group_type?"info":"secondary",shape:"rounded-pill",children:"contractor"===e.group_type?_("settings.userGroups.types.contractor"):_("settings.userGroups.types.standard")})]}),s.jsxs("div",{className:"row g-2 small",children:[s.jsxs("div",{className:"col-6 d-flex align-items-center justify-content-between",children:[s.jsx("span",{className:"text-muted me-2",children:_("contractorsAdmin.modules.dashboard")}),L(e,"dashboard")]}),s.jsxs("div",{className:"col-6 d-flex align-items-center justify-content-between",children:[s.jsx("span",{className:"text-muted me-2",children:_("contractorsAdmin.modules.proposals")}),L(e,"proposals")]}),s.jsxs("div",{className:"col-6 d-flex align-items-center justify-content-between",children:[s.jsx("span",{className:"text-muted me-2",children:_("contractorsAdmin.modules.customers")}),L(e,"customers")]}),s.jsxs("div",{className:"col-6 d-flex align-items-center justify-content-between",children:[s.jsx("span",{className:"text-muted me-2",children:_("contractorsAdmin.modules.resources")}),L(e,"resources")]})]}),s.jsx("div",{className:"d-flex justify-content-end mt-2",children:s.jsxs(u,{color:"primary",variant:"outline",size:"sm",onClick:()=>F(e.id),title:"Edit Group",children:[s.jsx(p,{icon:S,size:"sm",className:"me-1"}),"Edit"]})})]},`m-${e.id}`))})]})]})})})};export{_ as default};
