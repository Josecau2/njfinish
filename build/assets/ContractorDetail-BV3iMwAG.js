import{j as s}from"./date-vendor-DfW9khhA.js";import{u as e,r as t,h as a}from"./react-vendor-Dhx0OYb2.js";import{u as c,a4 as l,a5 as r,a6 as n,g as i,m as o,a7 as d,a8 as m,d as x,a9 as h}from"./index-BxG4qwLs.js";import{u as j,a as p}from"./redux-vendor-B0DAdCYB.js";import{R as u,S as N,b as g,d as b,r as f,c as A,X as y,Y as v,v as w,ae as _,C as k,T as C,U as S,V as z,ac as P,e as D,Z as H,_ as T,$ as V,a0 as I,a1 as O,a2 as E,ab as L,i as M,j as U,k as Z,l as $,af as F,ag as q,ah as J,ai as B,a as K,m as R,h as W,N as G,B as X,E as Y,O as Q,Q as ss}from"./ui-vendor-pFEG3kEv.js";import{c as es,g as ts,a as as,b as cs,l as ls}from"./DefaultLayout-CDydDzk1.js";import{c as rs}from"./cil-group-DQU-yEHN.js";import{c as ns}from"./cil-briefcase-Bw71BDXV.js";import{a as is,c as os}from"./cil-clock-BhwNMOcP.js";import{c as ds,a as ms,b as xs}from"./cil-x-circle-9Y0mC_t9.js";import{E as hs}from"./EmptyState-BfaRP2bj.js";import{P as js}from"./PaginationComponent-Du09fPLe.js";import{c as ps}from"./cil-search-CDkY_4k-.js";import{c as us}from"./cil-paper-plane-haInf9fd.js";import{c as Ns}from"./cil-info-CmGCY32x.js";import{c as gs}from"./cil-envelope-closed-DSbcONbs.js";import{c as bs}from"./cil-phone-4mwkG2LD.js";import{c as fs}from"./cil-chart-ul2n6BfS.js";import{c as As}from"./cil-arrow-left-D66Kb3Zq.js";import"./form-vendor-C_vzjFiG.js";import"./utils-vendor-Nl-sF5xe.js";import"./icons-vendor-CVrEPnlB.js";var ys=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='400 464 48 464 48 104 240 104 240 72 16 72 16 496 432 496 432 272 400 272 400 464' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='304 16 304 48 441.373 48 188.687 300.687 211.313 323.313 464 70.627 464 208 496 208 496 16 304 16' class='ci-primary'/>"],vs=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M473.605,88.081c-1.352-.137-135.958-14.259-199.218-68.251L269.9,16H242.1l-4.488,3.83C174.464,73.727,39.744,87.944,38.4,88.081L24,89.532V104c0,89.133,14.643,165.443,43.523,226.813,38.105,80.973,100.1,133.669,184.267,156.623l4.21,1.148,4.21-1.148c84.165-22.954,146.162-75.65,184.267-156.623C473.357,269.443,488,193.133,488,104V89.532ZM455.87,118.113q-.237,12.789-.948,25.887H272V57.915C331.921,97.482,421.024,113.237,455.87,118.113ZM272,320H414.266A288.233,288.233,0,0,1,390.9,360H272Zm0-32V248H439.9a402.662,402.662,0,0,1-13.236,42.884V288Zm0-72V176H452.378c-1.4,13.307-3.256,26.682-5.639,40ZM56.13,118.113c34.846-4.876,123.949-20.631,183.87-60.2V450.224C94.012,398.389,58.492,245.387,56.13,118.113ZM272,450.224V392h92.347C340.049,416.7,309.708,436.836,272,450.224Z' class='ci-primary'/>"],ws=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M16,64V448H496V64ZM464,240H352V96H464Zm-272,0V96H320V240Zm128,32V416H192V272ZM160,96V240H48V96ZM48,272H160V416H48ZM352,416V272H464V416Z' class='ci-primary'/>"];const _s=(s,e={})=>{if(!s)return"N/A";try{const t=new Date(s);if(isNaN(t.getTime()))return"N/A";const a={year:"numeric",month:"short",day:"numeric"};return t.toLocaleDateString("en-US",{...a,...e})}catch(t){return"N/A"}},ks=({contractor:e})=>{const{t:t}=c(),a=(s=>{if(!s||"object"!=typeof s)return[];const e={dashboard:{label:t("contractorsAdmin.modules.dashboard"),color:"primary"},proposals:{label:t("contractorsAdmin.modules.proposals"),color:"success"},customers:{label:t("contractorsAdmin.modules.customers"),color:"warning"},resources:{label:t("contractorsAdmin.modules.resources"),color:"info"}};let a=s;if("string"==typeof s)try{a=JSON.parse(s)}catch(c){return[]}return["dashboard","proposals","customers","resources"].map(s=>({key:s,label:e[s]?.label||s,color:e[s]?.color||"secondary",enabled:!0===a[s]}))})(e.modules),l=a.filter(s=>s.enabled).length,r=a.length,n=r>0?l/r*100:0;return s.jsxs(u,{children:[s.jsx(N,{sm:6,lg:3,className:"mb-4",children:s.jsx(g,{className:"text-center",children:s.jsxs(b,{children:[s.jsx(f,{icon:es,size:"2xl",className:"text-primary mb-3"}),s.jsx("h3",{className:"text-primary",children:e.stats?.user_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.table.users")})]})})}),s.jsx(N,{sm:6,lg:3,className:"mb-4",children:s.jsx(g,{className:"text-center",children:s.jsxs(b,{children:[s.jsx(f,{icon:rs,size:"2xl",className:"text-warning mb-3"}),s.jsx("h3",{className:"text-warning",children:e.stats?.customer_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.table.customers")})]})})}),s.jsx(N,{sm:6,lg:3,className:"mb-4",children:s.jsx(g,{className:"text-center",children:s.jsxs(b,{children:[s.jsx(f,{icon:ns,size:"2xl",className:"text-success mb-3"}),s.jsx("h3",{className:"text-success",children:e.stats?.proposal_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.table.proposals")})]})})}),s.jsx(N,{sm:6,lg:3,className:"mb-4",children:s.jsx(g,{className:"text-center",children:s.jsxs(b,{children:[s.jsx(f,{icon:ws,size:"2xl",className:"text-info mb-3"}),s.jsxs("h3",{className:"text-info",children:[l,"/",r]}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.table.modules")})]})})}),s.jsx(N,{md:6,className:"mb-4",children:s.jsxs(g,{children:[s.jsx(A,{children:s.jsx("strong",{children:t("contractorsAdmin.detail.basicInfo.title")})}),s.jsx(b,{children:s.jsxs(y,{flush:!0,children:[s.jsxs(v,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[s.jsx(f,{icon:rs,className:"me-2 text-muted"}),t("contractorsAdmin.detail.basicInfo.contractorName")]}),s.jsx("strong",{children:e.name})]}),s.jsxs(v,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[s.jsx(f,{icon:ts,className:"me-2 text-muted"}),t("contractorsAdmin.detail.basicInfo.createdDate")]}),s.jsx("span",{children:_s(e.created_at)})]}),s.jsxs(v,{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{children:t("contractorsAdmin.detail.basicInfo.groupType")}),s.jsx(w,{color:"info",children:e.group_type||"contractor"})]}),e.contractor_settings?.max_users&&s.jsxs(v,{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{children:t("contractorsAdmin.detail.basicInfo.maxUsers")}),s.jsx("span",{children:e.contractor_settings.max_users})]})]})})]})}),s.jsx(N,{md:6,className:"mb-4",children:s.jsxs(g,{children:[s.jsxs(A,{className:"d-flex justify-content-between align-items-center",children:[s.jsx("strong",{children:t("contractorsAdmin.detail.moduleAccess.title")}),s.jsx("div",{children:s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.moduleAccess.enabledOfTotal",{enabled:l,total:r})})})]}),s.jsxs(b,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx(_,{value:n,color:n>75?"success":n>50?"warning":"danger",className:"mb-2"}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.moduleAccess.percentEnabled",{percent:Math.round(n)})})]}),s.jsx(y,{flush:!0,children:a.map(e=>s.jsxs(v,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[s.jsx(f,{icon:e.enabled?is:ds,className:"me-2 "+(e.enabled?"text-success":"text-danger")}),e.label]}),s.jsx(w,{color:e.enabled?e.color:"secondary",children:e.enabled?t("contractorsAdmin.detail.enabled"):t("contractorsAdmin.detail.disabled")})]},e.key))})]})]})}),s.jsx(N,{xs:12,children:s.jsxs(g,{children:[s.jsx(A,{children:s.jsx("strong",{children:t("contractorsAdmin.detail.activity.title")})}),s.jsx(b,{children:s.jsxs(u,{children:[s.jsx(N,{md:4,className:"border-end",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h4",{className:"text-primary",children:e.stats?.user_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.activity.totalUsers")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.activity.totalUsersHint")})]})}),s.jsx(N,{md:4,className:"border-end",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h4",{className:"text-warning",children:e.stats?.customer_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.activity.totalCustomers")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.activity.totalCustomersHint")})]})}),s.jsx(N,{md:4,children:s.jsxs("div",{className:"text-center",children:[s.jsx("h4",{className:"text-success",children:e.stats?.proposal_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.activity.totalProposals")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.activity.totalProposalsHint")})]})})]})})]})})]})},Cs=({contractor:a,groupId:m})=>{const{t:x}=c(),h=j(),_=e(),{contractorProposals:{data:W,pagination:G,loading:X,error:Y},proposalDetails:Q}=p(s=>s.contractors),[ss,cs]=t.useState(""),[ls,rs]=t.useState(""),[gs,bs]=t.useState("all"),[fs,As]=t.useState({key:"createdAt",direction:"desc"}),[vs,ws]=t.useState(1),[_s]=t.useState(10),[ks,Cs]=t.useState(!1),[Ss,zs]=t.useState(null),Ps={all:{label:x("proposals.tabs.all"),color:"primary",icon:ms},draft:{label:x("proposals.status.draft"),color:"secondary",icon:ms},sent:{label:x("proposals.status.sent"),color:"info",icon:us},pending:{label:x("contractorsAdmin.detail.proposals.status.pending"),color:"warning",icon:os},approved:{label:x("contractorsAdmin.detail.proposals.status.approved"),color:"success",icon:is},accepted:{label:x("proposals.status.accepted"),color:"success",icon:is},rejected:{label:x("proposals.status.rejected"),color:"danger",icon:ds},expired:{label:x("proposals.status.expired"),color:"dark",icon:os},in_progress:{label:x("contractorsAdmin.detail.proposals.status.inProgress"),color:"info",icon:os},completed:{label:x("contractorsAdmin.detail.proposals.status.completed"),color:"success",icon:is}};t.useEffect(()=>{const s=setTimeout(()=>{rs(ss)},500);return()=>clearTimeout(s)},[ss]),t.useEffect(()=>{m&&h(l({groupId:m,page:vs,limit:_s,status:"all"===gs?void 0:gs,search:ls}))},[h,m,vs,_s,gs,ls]),t.useEffect(()=>{Y&&r(x("contractorsAdmin.detail.proposals.loadFailed"),"string"==typeof Y?Y:"")},[Y]);const Ds=()=>{Cs(!1),zs(null),h(d())},Hs=s=>{const e=`/${i(6)}/${i(8)}`+o("/quotes/:proposalId/admin-view",{proposalId:s});_(e)},Ts=s=>{As(e=>{const t=e.key===s&&"asc"===e.direction?"desc":"asc";return{key:s,direction:t}})},Vs=s=>Ps[s]?.color||"secondary",Is=s=>Ps[s]?.icon||ms,Os=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s||0),Es=s=>{if(!s.manufacturersData)return 0;try{const e=JSON.parse(s.manufacturersData);let t=0;return e.forEach(s=>{s.summary&&s.summary.grandTotal&&(t+=s.summary.grandTotal)}),t}catch(e){return 0}},Ls=s=>{if(!s)return"N/A";try{const e=new Date(s);return isNaN(e.getTime())?"N/A":e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(e){return"N/A"}},Ms=s=>{if(!s)return"N/A";try{const e=new Date(s);return isNaN(e.getTime())?"N/A":e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch(e){return"N/A"}},Us=t.useMemo(()=>{const s={all:W?.length||0};return W&&W.length>0&&W.forEach(e=>{const t=e.status||"draft";s[t]=(s[t]||0)+1}),s},[W]),Zs=W||[];return X?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:s.jsx(k,{color:"primary"})}):s.jsxs(s.Fragment,{children:[s.jsx(u,{children:s.jsx(N,{xs:12,children:s.jsxs(g,{children:[s.jsx(A,{children:s.jsxs("strong",{children:[s.jsx(f,{icon:ns,className:"me-2"}),x("contractorsAdmin.detail.proposals.header",{count:G?.total||0})]})}),s.jsxs(b,{children:[Y&&r(x("contractorsAdmin.detail.proposals.loadFailed"),"string"==typeof Y?Y:""),s.jsxs(u,{className:"mb-4",children:[s.jsx(N,{md:6,children:s.jsxs(C,{children:[s.jsx(S,{children:s.jsx(f,{icon:ps})}),s.jsx(z,{type:"text",placeholder:x("contractorsAdmin.detail.proposals.searchPlaceholder"),value:ss,onChange:s=>{cs(s.target.value),ws(1)}})]})}),s.jsx(N,{md:6,className:"d-flex align-items-center justify-content-end",children:s.jsx("small",{className:"text-muted me-2",children:x("contractorsAdmin.detail.proposals.quickFilters")})})]}),s.jsx("div",{className:"mb-4",children:s.jsx(P,{className:"flex-wrap",children:Object.entries(Ps).map(([e,t])=>{const a=Us[e]||0,c=gs===e;return s.jsxs(D,{variant:c?"solid":"outline",color:t.color,size:"sm",className:"me-2 mb-2",onClick:()=>(s=>{bs(s),ws(1)})(e),disabled:0===a&&"all"!==e,children:[s.jsx(f,{icon:t.icon,className:"me-1",size:"sm"}),t.label,a>0&&s.jsx(w,{color:c?"light":t.color,className:"ms-1",children:a})]},e)})})}),s.jsx("div",{className:"table-responsive",children:s.jsxs(H,{hover:!0,striped:!0,children:[s.jsx(T,{children:s.jsxs(V,{children:[s.jsx(I,{scope:"col",className:"cursor-pointer",onClick:()=>Ts("title"),children:x("contractorsAdmin.detail.proposals.table.title")}),s.jsx(I,{scope:"col",className:"cursor-pointer",onClick:()=>Ts("customer_name"),children:x("proposals.headers.customer")}),s.jsx(I,{scope:"col",className:"cursor-pointer",onClick:()=>Ts("status"),children:x("proposals.headers.status")}),s.jsx(I,{scope:"col",className:"cursor-pointer",onClick:()=>Ts("total_amount"),children:x("contractorsAdmin.detail.proposals.table.amount")}),s.jsxs(I,{scope:"col",className:"cursor-pointer",onClick:()=>Ts("createdAt"),children:[x("proposals.headers.date"),"createdAt"===fs.key&&s.jsx("span",{className:"ms-1",children:"asc"===fs.direction?"↑":"↓"})]}),s.jsxs(I,{scope:"col",className:"cursor-pointer",onClick:()=>Ts("updatedAt"),children:[x("contractorsAdmin.detail.proposals.table.updated"),"updatedAt"===fs.key&&s.jsx("span",{className:"ms-1",children:"asc"===fs.direction?"↑":"↓"})]}),s.jsx(I,{scope:"col",className:"text-center",style:{width:"150px"},children:x("proposals.headers.actions")})]})}),s.jsx(O,{children:0===Zs.length?s.jsx(V,{children:s.jsx(E,{colSpan:"7",children:s.jsx(hs,{title:x("contractorsAdmin.detail.proposals.empty.title"),subtitle:x("contractorsAdmin.detail.proposals.empty.subtitle")})})}):Zs.map(e=>s.jsxs(V,{className:"align-middle",children:[s.jsx(E,{children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:e.title||`Proposal #${e.id}`}),s.jsxs("small",{className:"text-muted",children:["ID: ",e.id]})]})}),s.jsx(E,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(f,{icon:es,className:"me-1 text-muted",size:"sm"}),e.customer?.name||e.customer_name||"N/A"]})}),s.jsx(E,{children:s.jsxs(w,{color:Vs(e.status),className:"d-flex align-items-center",style:{width:"fit-content"},children:[s.jsx(f,{icon:Is(e.status),className:"me-1",size:"sm"}),Ps[e.status]?.label||e.status||x("proposals.status.draft")]})}),s.jsx(E,{children:s.jsx("div",{className:"fw-bold text-success",children:Os(Es(e))})}),s.jsx(E,{children:s.jsx("div",{children:s.jsx("small",{className:"text-muted",children:Ms(e.createdAt)})})}),s.jsx(E,{children:s.jsx("div",{children:s.jsx("small",{className:"text-muted",children:Ms(e.updatedAt)})})}),s.jsx(E,{className:"text-center",children:s.jsxs(P,{size:"sm",children:[s.jsx(L,{content:"View Details",children:s.jsx(D,{color:"outline-info",size:"sm",onClick:()=>(s=>{zs(s),Cs(!0),h(n(s.id))})(e),children:s.jsx(f,{icon:ps,size:"sm"})})}),s.jsx(L,{content:"Go to Proposal",children:s.jsx(D,{color:"outline-primary",size:"sm",onClick:()=>Hs(e.id),children:s.jsx(f,{icon:ys,size:"sm"})})})]})})]},e.id))})]})}),G?.totalPages>1&&s.jsx("div",{className:"pt-3 border-top border-light",children:s.jsx(js,{currentPage:vs,totalPages:G?.totalPages||1,onPageChange:s=>{ws(s)},itemsPerPage:_s})})]})]})})}),s.jsxs(M,{visible:ks,onClose:Ds,size:"xl",scrollable:!0,className:"proposal-detail-modal",children:[s.jsx(U,{children:s.jsxs(Z,{children:[s.jsx(f,{icon:ns,className:"me-2"}),x("contractorsAdmin.detail.proposals.modal.title"),Ss&&s.jsx(w,{color:Vs(Ss.status),className:"ms-2",children:Ps[Ss.status]?.label||Ss.status||"Draft"})]})}),s.jsx($,{children:Q.loading?s.jsxs("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"300px"},children:[s.jsx(k,{color:"primary",size:"lg"}),s.jsx("span",{className:"ms-3",children:x("contractorsAdmin.detail.proposals.modal.loading")})]}):Q.data?s.jsxs("div",{children:[s.jsxs(u,{className:"mb-4",children:[s.jsxs(N,{md:8,children:[s.jsx("h4",{className:"mb-2",children:Q.data.title||`Proposal #${Q.data.id}`}),s.jsxs("div",{className:"d-flex flex-wrap gap-3 text-muted",children:[s.jsxs("div",{children:[s.jsx(f,{icon:es,className:"me-1"}),s.jsxs("strong",{children:[x("proposalAcceptance.labels.customer"),":"]})," ",Q.data.customer?.name||x("common.na")]}),s.jsxs("div",{children:[s.jsx(f,{icon:ts,className:"me-1"}),s.jsxs("strong",{children:[x("proposals.headers.date"),":"]})," ",Ls(Q.data.createdAt)]}),s.jsxs("div",{children:[s.jsx(f,{icon:as,className:"me-1"}),s.jsxs("strong",{children:[x("contractorsAdmin.detail.proposals.modal.group"),":"]})," ",a?.name||x("common.na")]})]})]}),s.jsxs(N,{md:4,className:"text-end",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("h3",{className:"text-success mb-0",children:Os(Es(Q.data))}),s.jsx("small",{className:"text-muted",children:x("contractorsAdmin.detail.proposals.modal.totalAmount")})]}),s.jsxs(D,{color:"primary",size:"sm",onClick:()=>Hs(Q.data.id),className:"me-2",children:[s.jsx(f,{icon:ys,className:"me-1"}),x("contractorsAdmin.detail.proposals.modal.goToProposal")]})]})]}),s.jsxs(F,{flush:!0,children:[s.jsxs(q,{itemKey:"1",children:[s.jsxs(J,{children:[s.jsx(f,{icon:Ns,className:"me-2"}),x("contractorsAdmin.detail.proposals.modal.basicInfo")]}),s.jsxs(B,{children:[s.jsxs(u,{children:[s.jsx(N,{md:6,children:s.jsxs(y,{flush:!0,children:[s.jsxs(v,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:x("contractorsAdmin.detail.proposals.modal.proposalId")}),s.jsxs("strong",{children:["#",Q.data.id]})]}),s.jsxs(v,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:x("proposals.headers.status")}),s.jsxs(w,{color:Vs(Q.data.status),children:[s.jsx(f,{icon:Is(Q.data.status),className:"me-1",size:"sm"}),Ps[Q.data.status]?.label||Q.data.status||x("proposals.status.draft")]})]}),s.jsxs(v,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:x("proposalAcceptance.labels.customer")}),s.jsx("span",{children:Q.data.customer?.name||"N/A"})]}),s.jsxs(v,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:x("contractorsAdmin.detail.proposals.modal.totalAmount")}),s.jsx("strong",{className:"text-success",children:Os(Es(Q.data))})]})]})}),s.jsx(N,{md:6,children:s.jsxs(y,{flush:!0,children:[s.jsxs(v,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:x("contractorsAdmin.detail.proposals.modal.created")}),s.jsx("span",{children:Ls(Q.data.createdAt)})]}),s.jsxs(v,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:x("contractorsAdmin.detail.proposals.modal.updated")}),s.jsx("span",{children:Ls(Q.data.updatedAt)})]}),Q.data.sent_at&&s.jsxs(v,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:x("contractorsAdmin.detail.proposals.modal.sent")}),s.jsx("span",{className:"text-info",children:Ls(Q.data.sent_at)})]}),s.jsxs(v,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:x("contractorsAdmin.detail.proposals.modal.contractorGroup")}),s.jsx("span",{children:a?.name||"N/A"})]}),Q.data.accepted_at&&s.jsxs(v,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:x("contractorsAdmin.detail.proposals.modal.accepted")}),s.jsx("span",{className:"text-success",children:Ls(Q.data.accepted_at)})]})]})})]}),Q.data.description&&s.jsxs("div",{className:"mt-3",children:[s.jsx("h6",{className:"text-muted mb-2",children:x("proposals.labels.description")}),s.jsx("div",{className:"bg-light p-3 rounded",children:s.jsx("p",{className:"mb-0",children:Q.data.description})})]})]})]}),s.jsxs(q,{itemKey:"2",children:[s.jsxs(J,{children:[s.jsx(f,{icon:xs,className:"me-2"}),x("contractorsAdmin.detail.proposals.timeline.title")]}),s.jsx(B,{children:s.jsx("div",{className:"timeline",children:(s=>{const e=[];return e.push({status:"created",label:"Created",date:s.createdAt,icon:ms,color:"secondary",completed:!0}),s.sent_at&&e.push({status:"sent",label:"Sent to Customer",date:s.sent_at,icon:us,color:"info",completed:!0}),s.accepted_at&&e.push({status:"accepted",label:"Accepted",date:s.accepted_at,icon:is,color:"success",completed:!0}),s.status&&!["draft","sent","accepted"].includes(s.status)&&e.push({status:s.status,label:Ps[s.status]?.label||s.status,date:s.updatedAt,icon:Is(s.status),color:Vs(s.status),completed:!0}),e})(Q.data).map((e,t)=>s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:`timeline-icon bg-${e.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"40px",height:"40px",minWidth:"40px"},children:s.jsx(f,{icon:e.icon,size:"sm"})}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("strong",{children:e.label}),s.jsx("small",{className:"text-muted",children:Ls(e.date)})]}),"created"===e.status&&s.jsx("small",{className:"text-muted",children:x("contractorsAdmin.detail.proposals.timeline.created")}),"sent"===e.status&&s.jsx("small",{className:"text-info",children:x("contractorsAdmin.detail.proposals.timeline.sent")}),"accepted"===e.status&&s.jsx("small",{className:"text-success",children:x("contractorsAdmin.detail.proposals.timeline.accepted")}),"approved"===e.status&&s.jsx("small",{className:"text-success",children:x("contractorsAdmin.detail.proposals.timeline.approved")})]})]},t))})})]}),Q.data.items&&Q.data.items.length>0&&s.jsxs(q,{itemKey:"3",children:[s.jsxs(J,{children:[s.jsx(f,{icon:ms,className:"me-2"}),x("contractorsAdmin.detail.proposals.itemsTitle",{count:Q.data.items.length})]}),s.jsxs(B,{children:[s.jsx("div",{className:"table-responsive",children:s.jsxs(H,{hover:!0,striped:!0,children:[s.jsx(T,{children:s.jsxs(V,{children:[s.jsx(I,{children:x("proposalColumns.item")}),s.jsx(I,{children:x("proposals.labels.description")}),s.jsx(I,{className:"text-end",children:x("proposalColumns.qty")}),s.jsx(I,{className:"text-end",children:x("proposalDoc.catalog.unitPrice")}),s.jsx(I,{className:"text-end",children:x("proposalColumns.total")})]})}),s.jsx(O,{children:Q.data.items.map((e,t)=>s.jsxs(V,{children:[s.jsx(E,{children:s.jsx("strong",{children:e.name||`Item ${t+1}`})}),s.jsx(E,{children:e.description||"N/A"}),s.jsx(E,{className:"text-end",children:e.quantity||1}),s.jsx(E,{className:"text-end",children:Os(e.unit_price)}),s.jsx(E,{className:"text-end",children:s.jsx("strong",{children:Os((e.quantity||1)*(e.unit_price||0))})})]},t))})]})}),s.jsx("div",{className:"border-top pt-3 mt-3",children:s.jsxs(u,{children:[s.jsx(N,{md:6}),s.jsxs(N,{md:6,children:[s.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[s.jsxs("span",{children:[x("contractorsAdmin.detail.proposals.totals.subtotal"),":"]}),s.jsx("span",{children:Os(Q.data.subtotal_amount||Q.data.total_amount)})]}),Q.data.tax_amount>0&&s.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[s.jsxs("span",{children:[x("contractorsAdmin.detail.proposals.totals.tax"),":"]}),s.jsx("span",{children:Os(Q.data.tax_amount)})]}),s.jsxs("div",{className:"d-flex justify-content-between border-top pt-2",children:[s.jsxs("strong",{children:[x("contractorsAdmin.detail.proposals.totals.total"),":"]}),s.jsx("strong",{className:"text-success",children:Os(Q.data.total_amount)})]})]})]})})]})]})]})]}):s.jsxs(K,{color:"warning",className:"mb-0",children:[s.jsx(f,{icon:Ns,className:"me-2"}),x("contractorsAdmin.detail.proposals.modal.failed")]})}),s.jsxs(R,{className:"d-flex justify-content-between",children:[s.jsx("div",{children:Ss&&s.jsxs(D,{color:"primary",variant:"outline",onClick:()=>Hs(Ss.id),children:[s.jsx(f,{icon:ys,className:"me-1"}),x("contractorsAdmin.detail.proposals.modal.openFull")]})}),s.jsx(D,{color:"secondary",onClick:Ds,children:x("common.cancel")})]})]})]})},Ss=({contractor:e,groupId:a})=>{const{t:l}=c(),n=j(),i=(p(s=>s.contractors)||{}).contractorCustomers||{},o=i.data||[],d=i.pagination||{totalPages:0},x=!!i.loading,h=i.error||null,[y,v]=t.useState(""),[_,P]=t.useState({key:null,direction:"asc"}),[D,L]=t.useState(1),[M]=t.useState(10);t.useEffect(()=>{const s=setTimeout(()=>{a&&n(m({groupId:a,page:D,limit:M,search:y}))},300);return()=>clearTimeout(s)},[n,a,D,M,y]),t.useEffect(()=>{h&&r("Failed to load customers","string"==typeof h?h:"")},[h]);const U=s=>{P(e=>{const t=e.key===s&&"asc"===e.direction?"desc":"asc";return{key:s,direction:t}})},Z=s=>{if(!s)return"N/A";try{const e=new Date(s);return isNaN(e.getTime())?"N/A":e.toLocaleDateString()}catch(e){return"N/A"}},$=s=>{if(!s)return"N/A";const e=s.replace(/\D/g,"");return 10===e.length?`(${e.slice(0,3)}) ${e.slice(3,6)}-${e.slice(6)}`:s},F=s=>{const e=[];s.address&&e.push(s.address),s.aptOrSuite&&e.push(s.aptOrSuite);const t=[];return s.city&&t.push(s.city),s.state&&t.push(s.state),s.zipCode&&t.push(s.zipCode),t.length>0&&e.push(t.join(", ")),e.length>0?e.join(", "):null},q=t.useMemo(()=>{let s=(Array.isArray(o)?o:[]).filter(s=>s.name?.toLowerCase().includes(y.toLowerCase())||s.email?.toLowerCase().includes(y.toLowerCase())||s.phone?.includes(y));return _.key&&s.sort((s,e)=>{let t=s[_.key],a=e[_.key];return"string"==typeof t&&(t=t.toLowerCase(),a=a.toLowerCase()),t<a?"asc"===_.direction?-1:1:t>a?"asc"===_.direction?1:-1:0}),s},[o,y,_]),J=t.useMemo(()=>{const s=(D-1)*M;return q.slice(s,s+M)},[q,D,M]);return Math.ceil(q.length/M),x?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:s.jsx(k,{color:"primary"})}):s.jsx(u,{children:s.jsx(N,{xs:12,children:s.jsxs(g,{children:[s.jsx(A,{children:s.jsxs("strong",{children:[s.jsx(f,{icon:rs,className:"me-2"}),l("contractorsAdmin.detail.customers.header",{count:q.length})]})}),s.jsxs(b,{children:[h&&s.jsx(K,{color:"danger",className:"mb-3",children:"string"==typeof h?h:"Something went wrong"}),s.jsxs(u,{className:"mb-4",children:[s.jsx(N,{md:6,children:s.jsxs(C,{children:[s.jsx(S,{children:s.jsx(f,{icon:ps})}),s.jsx(z,{type:"text",placeholder:l("contractorsAdmin.detail.customers.searchPlaceholder"),value:y,onChange:s=>{return e=s.target.value,v(e),void L(1);var e}})]})}),s.jsx(N,{md:6,className:"d-flex justify-content-end align-items-center",children:s.jsx("div",{className:"text-muted",children:s.jsx("small",{children:l("contractorsAdmin.detail.customers.showing",{count:J.length,total:q.length})})})})]}),s.jsxs(u,{className:"mb-4",children:[s.jsx(N,{sm:6,lg:3,children:s.jsxs("div",{className:"border-start border-start-4 border-start-info py-1 px-3",children:[s.jsx("div",{className:"text-muted small",children:l("contractorsAdmin.detail.customers.stats.total")}),s.jsx("div",{className:"fs-5 fw-semibold",children:o.length})]})}),s.jsx(N,{sm:6,lg:3,children:s.jsxs("div",{className:"border-start border-start-4 border-start-success py-1 px-3",children:[s.jsx("div",{className:"text-muted small",children:l("contractorsAdmin.detail.customers.stats.active")}),s.jsx("div",{className:"fs-5 fw-semibold",children:o.filter(s=>!s.deleted_at).length})]})}),s.jsx(N,{sm:6,lg:3,children:s.jsxs("div",{className:"border-start border-start-4 border-start-warning py-1 px-3",children:[s.jsx("div",{className:"text-muted small",children:l("contractorsAdmin.detail.customers.stats.withEmail")}),s.jsx("div",{className:"fs-5 fw-semibold",children:o.filter(s=>s.email).length})]})}),s.jsx(N,{sm:6,lg:3,children:s.jsxs("div",{className:"border-start border-start-4 border-start-primary py-1 px-3",children:[s.jsx("div",{className:"text-muted small",children:l("contractorsAdmin.detail.customers.stats.withPhone")}),s.jsx("div",{className:"fs-5 fw-semibold",children:o.filter(s=>s.phone).length})]})})]}),s.jsx("div",{className:"table-responsive d-none d-md-block",children:s.jsxs(H,{hover:!0,striped:!0,children:[s.jsx(T,{children:s.jsxs(V,{children:[s.jsxs(I,{scope:"col",className:"cursor-pointer",onClick:()=>U("name"),children:[l("customers.name"),"name"===_.key&&s.jsx(f,{icon:"asc"===_.direction?"cilSortUp":"cilSortDown",className:"ms-1",size:"sm"})]}),s.jsxs(I,{scope:"col",className:"cursor-pointer",onClick:()=>U("email"),children:[l("customers.email"),"email"===_.key&&s.jsx(f,{icon:"asc"===_.direction?"cilSortUp":"cilSortDown",className:"ms-1",size:"sm"})]}),s.jsx(I,{scope:"col",children:l("contractorsAdmin.detail.customers.table.phone")}),s.jsx(I,{scope:"col",children:l("contractorsAdmin.detail.customers.table.address")}),s.jsxs(I,{scope:"col",className:"cursor-pointer",onClick:()=>U("created_at"),children:[l("contractorsAdmin.detail.customers.table.created"),"created_at"===_.key&&s.jsx(f,{icon:"asc"===_.direction?"cilSortUp":"cilSortDown",className:"ms-1",size:"sm"})]}),s.jsx(I,{scope:"col",children:l("contractorsAdmin.detail.customers.table.status")})]})}),s.jsx(O,{children:0===J.length?s.jsx(V,{children:s.jsx(E,{colSpan:"6",children:s.jsx(hs,{title:l("contractorsAdmin.detail.customers.empty.title"),subtitle:l("contractorsAdmin.detail.customers.empty.subtitle")})})}):J.map(e=>s.jsxs(V,{className:"align-middle",children:[s.jsx(E,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(f,{icon:es,className:"me-2 text-muted"}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:e.name}),s.jsxs("small",{className:"text-muted",children:["ID: ",e.id]})]})]})}),s.jsx(E,{children:e.email?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(f,{icon:gs,className:"me-1 text-muted",size:"sm"}),s.jsx("span",{children:e.email})]}):s.jsx("small",{className:"text-muted",children:l("contractorsAdmin.detail.customers.noEmail")})}),s.jsx(E,{children:e.phone?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(f,{icon:bs,className:"me-1 text-muted",size:"sm"}),s.jsx("span",{children:$(e.phone)})]}):s.jsx("small",{className:"text-muted",children:l("contractorsAdmin.detail.customers.noPhone")})}),s.jsx(E,{children:F(e)?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(f,{icon:as,className:"me-1 text-muted",size:"sm"}),s.jsx("small",{children:F(e)})]}):s.jsx("small",{className:"text-muted",children:l("contractorsAdmin.detail.customers.noAddress")})}),s.jsx(E,{children:s.jsxs("small",{className:"text-muted",children:[s.jsx(f,{icon:ts,className:"me-1",size:"sm"}),Z(e.created_at)]})}),s.jsx(E,{children:s.jsx(w,{color:e.deleted_at?"danger":"success",children:e.deleted_at?l("contractorsAdmin.detail.customers.inactive"):l("contractorsAdmin.detail.customers.active")})})]},e.id))})]})}),s.jsx("div",{className:"d-md-none",children:0===J.length?s.jsx(hs,{title:l("contractorsAdmin.detail.customers.empty.title"),subtitle:l("contractorsAdmin.detail.customers.empty.subtitle")}):s.jsx("div",{className:"mobile-customer-cards",children:J.map(e=>s.jsx(g,{className:"mb-3 customer-mobile-card",children:s.jsxs(b,{className:"p-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[s.jsxs("div",{className:"d-flex align-items-center flex-grow-1 min-width-0",children:[s.jsx(f,{icon:es,className:"me-2 text-muted",size:"lg"}),s.jsxs("div",{className:"flex-grow-1 min-width-0",children:[s.jsx("div",{className:"fw-semibold text-truncate",title:e.name,children:e.name}),s.jsxs("small",{className:"text-muted",children:["ID: ",e.id]})]})]}),s.jsx(w,{color:e.deleted_at?"danger":"success",children:e.deleted_at?l("contractorsAdmin.detail.customers.inactive"):l("contractorsAdmin.detail.customers.active")})]}),s.jsxs("div",{className:"row g-2 mb-3",children:[s.jsxs("div",{className:"col-12",children:[s.jsx("div",{className:"small text-muted",children:l("customers.email")}),e.email?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(f,{icon:gs,className:"me-1 text-muted",size:"sm"}),s.jsx("span",{className:"text-truncate-mobile",title:e.email,children:e.email})]}):s.jsx("small",{className:"text-muted",children:l("contractorsAdmin.detail.customers.noEmail")})]}),s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"small text-muted",children:l("contractorsAdmin.detail.customers.table.phone")}),e.phone?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(f,{icon:bs,className:"me-1 text-muted",size:"sm"}),s.jsx("span",{children:$(e.phone)})]}):s.jsx("small",{className:"text-muted",children:"No phone"})]}),s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"small text-muted",children:l("contractorsAdmin.detail.customers.table.created")}),s.jsxs("small",{children:[s.jsx(f,{icon:ts,className:"me-1",size:"sm"}),Z(e.created_at)]})]})]}),F(e)&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"small text-muted",children:l("contractorsAdmin.detail.customers.table.address")}),s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx(f,{icon:as,className:"me-1 text-muted mt-1",size:"sm"}),s.jsx("small",{className:"flex-grow-1",children:F(e)})]})]})]})},e.id))})}),d?.totalPages>1&&s.jsx("div",{className:"pt-3 border-top border-light",children:s.jsx(js,{currentPage:D,totalPages:d?.totalPages||1,onPageChange:s=>{L(s)},itemsPerPage:M})})]})]})})})},zs=({contractor:e})=>{const{t:t}=c(),a=e.contractor_settings||{};let l=e.modules||{};if("string"==typeof l)try{l=JSON.parse(l)}catch(d){l={}}let r=a;if("string"==typeof a)try{r=JSON.parse(a)}catch(d){r={}}const n=e=>e?s.jsxs(w,{color:"success",children:[s.jsx(f,{icon:is,className:"me-1",size:"sm"}),t("contractorsAdmin.detail.enabled")]}):s.jsxs(w,{color:"danger",children:[s.jsx(f,{icon:ds,className:"me-1",size:"sm"}),t("contractorsAdmin.detail.disabled")]}),i={dashboard:t("contractorsAdmin.modules.dashboard"),proposals:t("contractorsAdmin.modules.proposals"),customers:t("contractorsAdmin.modules.customers"),resources:t("contractorsAdmin.modules.resources")},o={allow_subcontractors:t("contractorsAdmin.detail.settings.labels.allowSubcontractors"),max_users:t("contractorsAdmin.detail.settings.labels.maxUsers"),billing_enabled:t("contractorsAdmin.detail.settings.labels.billingEnabled"),custom_branding:t("contractorsAdmin.detail.settings.labels.customBranding"),api_access:t("contractorsAdmin.detail.settings.labels.apiAccess"),notification_preferences:t("contractorsAdmin.detail.settings.labels.notificationPreferences"),data_retention_days:t("contractorsAdmin.detail.settings.labels.dataRetentionDays"),timezone:t("contractorsAdmin.detail.settings.labels.timezone"),locale:t("contractorsAdmin.detail.settings.labels.locale")};return s.jsxs(u,{children:[s.jsx(N,{md:6,className:"mb-4",children:s.jsxs(g,{children:[s.jsx(A,{children:s.jsxs("strong",{children:[s.jsx(f,{icon:vs,className:"me-2"}),t("contractorsAdmin.detail.moduleAccess.title")]})}),s.jsx(b,{children:0===Object.keys(l).length?s.jsxs(K,{color:"info",children:[s.jsx(f,{icon:Ns,className:"me-2"}),t("contractorsAdmin.detail.settings.noModuleSettings")]}):s.jsx(y,{flush:!0,children:Object.entries(l).map(([e,a])=>s.jsxs(v,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[s.jsx("strong",{children:i[e]||e}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["dashboard"===e&&t("contractorsAdmin.detail.settings.moduleDescriptions.dashboard"),"proposals"===e&&t("contractorsAdmin.detail.settings.moduleDescriptions.proposals"),"customers"===e&&t("contractorsAdmin.detail.settings.moduleDescriptions.customers"),"resources"===e&&t("contractorsAdmin.detail.settings.moduleDescriptions.resources")]})]}),n(a)]},e))})})]})}),s.jsx(N,{md:6,className:"mb-4",children:s.jsxs(g,{children:[s.jsx(A,{children:s.jsxs("strong",{children:[s.jsx(f,{icon:cs,className:"me-2"}),t("contractorsAdmin.detail.settings.title")]})}),s.jsx(b,{children:0===Object.keys(r).length?s.jsxs(K,{color:"info",children:[s.jsx(f,{icon:Ns,className:"me-2"}),t("contractorsAdmin.detail.settings.noneConfigured")]}):s.jsx(y,{flush:!0,children:Object.entries(r).map(([e,a])=>s.jsxs(v,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[s.jsx("strong",{children:o[e]||e.replace(/_/g," ")}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["allow_subcontractors"===e&&t("contractorsAdmin.detail.settings.descriptions.allowSubcontractors"),"max_users"===e&&t("contractorsAdmin.detail.settings.descriptions.maxUsers"),"billing_enabled"===e&&t("contractorsAdmin.detail.settings.descriptions.billingEnabled"),"custom_branding"===e&&t("contractorsAdmin.detail.settings.descriptions.customBranding"),"api_access"===e&&t("contractorsAdmin.detail.settings.descriptions.apiAccess"),"data_retention_days"===e&&t("contractorsAdmin.detail.settings.descriptions.dataRetentionDays")]})]}),s.jsx("span",{children:"boolean"==typeof a?n(a):"object"==typeof a?s.jsx(w,{color:"info",children:t("contractorsAdmin.detail.settings.objectLabel")}):s.jsx("strong",{children:a})})]},e))})})]})}),s.jsx(N,{xs:12,children:s.jsxs(g,{children:[s.jsx(A,{children:s.jsxs("strong",{children:[s.jsx(f,{icon:Ns,className:"me-2"}),t("contractorsAdmin.detail.settings.raw.title")]})}),s.jsx(b,{children:s.jsxs(u,{children:[s.jsxs(N,{md:6,children:[s.jsx("h6",{children:t("contractorsAdmin.detail.settings.raw.modules")}),s.jsx("pre",{className:"bg-light p-3 rounded small",children:s.jsx("code",{children:JSON.stringify(l,null,2)})})]}),s.jsxs(N,{md:6,children:[s.jsx("h6",{children:t("contractorsAdmin.detail.settings.raw.contractorSettings")}),s.jsx("pre",{className:"bg-light p-3 rounded small",children:s.jsx("code",{children:JSON.stringify(a,null,2)})})]})]})})]})}),s.jsx(N,{xs:12,children:s.jsxs(g,{children:[s.jsx(A,{children:s.jsx("strong",{children:t("contractorsAdmin.detail.settings.summary.title")})}),s.jsx(b,{children:s.jsxs(u,{children:[s.jsxs(N,{md:4,className:"text-center border-end",children:[s.jsx("h4",{className:"text-primary",children:Object.values(l).filter(Boolean).length}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.settings.summary.enabledModules")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.settings.summary.ofTotal",{total:Object.keys(l).length})})]}),s.jsxs(N,{md:4,className:"text-center border-end",children:[s.jsx("h4",{className:"text-info",children:Object.keys(a).length}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.settings.summary.settingsConfigured")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.settings.summary.customOptions")})]}),s.jsxs(N,{md:4,className:"text-center",children:[s.jsx("h4",{className:"text-success",children:a.max_users||t("contractorsAdmin.detail.settings.summary.unlimited")}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.settings.summary.maxUsers")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.settings.summary.userLimitHint")})]})]})})]})})]})},Ps=()=>{const{t:l}=c(),{groupId:r}=a(),n=x(r),i=j(),o=e(),{selectedContractor:d,loading:m,error:y}=p(s=>s.contractors),[v,_]=t.useState("overview");t.useEffect(()=>{n&&i(h(n))},[i,n]);const C=()=>{o("/admin/contractors")},S=[{key:"overview",label:l("contractorsAdmin.detail.tabs.overview"),icon:fs,component:ks},{key:"proposals",label:l("contractorsAdmin.detail.tabs.proposals"),icon:ns,component:Cs},{key:"customers",label:l("contractorsAdmin.detail.tabs.customers"),icon:rs,component:Ss},{key:"settings",label:l("contractorsAdmin.detail.tabs.settings"),icon:cs,component:zs}];return m?s.jsx(W,{children:s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"300px"},children:s.jsx(k,{color:"primary"})})}):y?s.jsx(W,{children:s.jsxs(K,{color:"danger",children:[s.jsx("h4",{children:l("contractorsAdmin.detail.errorTitle")}),s.jsx("p",{children:y}),s.jsxs(D,{color:"primary",onClick:C,children:[s.jsx(f,{icon:As,className:"me-2"}),l("contractorsAdmin.detail.backToList")]})]})}):d?s.jsx(W,{className:"px-4",children:s.jsx(u,{children:s.jsxs(N,{xs:12,children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4 contractor-detail-header",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(D,{color:"outline-secondary",size:"sm",onClick:C,className:"me-3 d-flex align-items-center",style:{minWidth:"44px",minHeight:"44px"},children:[s.jsx(f,{icon:As,size:"sm"}),s.jsx("span",{className:"d-none d-sm-inline ms-1",children:l("common.back")})]}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-0 d-flex align-items-center",children:[s.jsx(f,{icon:ls,className:"me-2"}),s.jsx("span",{className:"text-truncate",style:{maxWidth:"200px"},children:d.name})]}),s.jsxs("small",{className:"text-muted",children:[l("contractorsAdmin.detail.contractorId"),": ",d.id]})]})]}),s.jsx(w,{color:"info",size:"lg",children:d.group_type||l("contractorsAdmin.detail.contractor")})]}),s.jsxs(g,{children:[s.jsx(A,{className:"pb-0",children:s.jsx(G,{variant:"tabs",role:"tablist",children:S.map(e=>s.jsx(X,{children:s.jsxs(Y,{active:v===e.key,onClick:()=>_(e.key),className:"cursor-pointer",children:[s.jsx(f,{icon:e.icon,className:"me-2"}),e.label]})},e.key))})}),s.jsx(b,{children:s.jsx(Q,{children:S.map(e=>{const t=e.component;return s.jsx(ss,{role:"tabpanel","aria-labelledby":`${e.key}-tab`,visible:v===e.key,children:s.jsx(t,{contractor:d,groupId:n})},e.key)})})})]})]})})}):s.jsx(W,{children:s.jsxs(K,{color:"warning",children:[s.jsx("h4",{children:l("contractorsAdmin.detail.notFoundTitle")}),s.jsx("p",{children:l("contractorsAdmin.detail.notFoundText")}),s.jsxs(D,{color:"primary",onClick:C,children:[s.jsx(f,{icon:As,className:"me-2"}),l("contractorsAdmin.detail.backToList")]})]})})};export{Ps as default};
