import{j as e}from"./date-vendor-D9pAgX5F.js";import{u as s,r as a}from"./react-vendor-DF7UJAlN.js";import{h as r,b as t,d as n,H as i,U as o,V as l,u as c,a8 as d,e as m,I as u,W as p,X as h,J as f,a7 as x,w as g}from"./ui-vendor-DjmSPU99.js";import{u as y,a as j}from"./redux-vendor-BzdbewH4.js";import{u as v,H as b,x as C,N as _}from"./index-DW-yAxzW.js";import{S as N}from"./utils-vendor-Nl-sF5xe.js";import{P as w,c as k,l as S,a as I}from"./DefaultLayout-BUcG_pV2.js";import{c as P}from"./cil-envelope-closed-DSbcONbs.js";import{c as z}from"./cil-lock-locked-DWQzOIEv.js";import{c as A}from"./cil-home-DjIzczOB.js";import{c as R}from"./cil-building-DVuwBvuD.js";import{c as q}from"./cil-arrow-left-D66Kb3Zq.js";import{c as B}from"./cil-save-CHBg7z_U.js";import"./form-vendor-CKNVq0c_.js";import"./icons-vendor-D82TZqJV.js";var E=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M208,16A112.127,112.127,0,0,0,96,128v79.681a80.236,80.236,0,0,0,9.768,38.308l27.455,50.333L60.4,343.656A79.725,79.725,0,0,0,24,410.732V496H312V464H56V410.732a47.836,47.836,0,0,1,21.841-40.246l97.66-63.479-41.64-76.341A48.146,48.146,0,0,1,128,207.681V128a80,80,0,0,1,160,0v79.681a48.146,48.146,0,0,1-5.861,22.985L240.5,307.007,312,353.483V315.317l-29.223-19,27.455-50.334A80.23,80.23,0,0,0,320,207.681V128A112.127,112.127,0,0,0,208,16Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='424 400 424 336 392 336 392 400 328 400 328 432 392 432 392 496 424 496 424 432 488 432 488 400 424 400' class='ci-primary'/>"];const G=({title:s,icon:a,children:r,className:i=""})=>e.jsx(t,{className:`settings-section-card ${i}`,children:e.jsxs(n,{className:"p-3 p-md-4",children:[e.jsxs("div",{className:"settings-section-header",children:[e.jsx("div",{className:"settings-section-icon",children:e.jsx(c,{icon:a,size:"sm"})}),e.jsx("h6",{className:"settings-section-title",children:s})]}),r]})}),V=({label:s,name:a,type:r="text",required:t=!1,icon:n=null,placeholder:i="",value:o,onChange:l,isInvalid:d,feedback:m,...g})=>e.jsxs("div",{className:"mb-3",children:[e.jsxs(u,{htmlFor:a,className:"settings-form-label",children:[s,t&&e.jsx("span",{className:"text-danger ms-1",children:"*"})]}),e.jsxs(p,{children:[n&&e.jsx(h,{className:"settings-form-input-group-text",children:e.jsx(c,{icon:n,size:"sm",className:"text-muted"})}),e.jsx(f,{type:r,id:a,name:a,value:o,onChange:l,placeholder:i,invalid:d,className:"settings-form-input "+(n?"border-start-0":""),...g}),m&&e.jsx(x,{children:m})]})]}),Z=({label:s,name:a,required:r=!1,icon:t=null,children:n,value:i,onChange:o,isInvalid:l,feedback:d,...m})=>e.jsxs("div",{className:"mb-3",children:[e.jsxs(u,{htmlFor:a,className:"settings-form-label",children:[s,r&&e.jsx("span",{className:"text-danger ms-1",children:"*"})]}),e.jsxs(p,{children:[t&&e.jsx(h,{className:"settings-form-input-group-text",children:e.jsx(c,{icon:t,size:"sm",className:"text-muted"})}),e.jsx(g,{id:a,name:a,value:i,onChange:o,invalid:l,className:"settings-form-input "+(t?"border-start-0":""),...m,children:n}),d&&e.jsx(x,{children:d})]})]}),T={name:"",email:"",password:"",confirmPassword:"",userGroup:"",location:"",isSalesRep:!1,street_address:"",city:"",state:"",zip_code:"",country:"",company_name:"",company_street_address:"",company_city:"",company_state:"",company_zip_code:"",company_country:""},D=()=>{const{t:u}=v(),p=y(),{error:h}=j(e=>e.users),{list:f=[]}=j(e=>e.usersGroup||{}),{list:x=[]}=j(e=>e.locations||{}),g=s(),[D,F]=a.useState(T),H=a.useRef(T),[O,$]=a.useState(!1),[J,L]=a.useState(!1),[M,W]=a.useState({}),[U,X]=a.useState(!1);a.useEffect(()=>{p(b()),p(C())},[p]);const Y=e=>{const{name:s,value:a,type:r,checked:t}=e.target;F(e=>({...e,[s]:"checkbox"===r?t:a})),M[s]&&W(e=>({...e,[s]:""}))},K=async(e,s=!1)=>{if(e.preventDefault(),(()=>{const e={};return D.name.trim()||(e.name=u("settings.users.form.validation.nameRequired")),D.email.trim()?/^\S+@\S+\.\S+$/.test(D.email)||(e.email=u("settings.users.form.validation.invalidEmail")):e.email=u("settings.users.form.validation.emailRequired"),D.password||(e.password=u("settings.users.form.validation.passwordRequired")),D.confirmPassword?D.password!==D.confirmPassword&&(e.confirmPassword=u("settings.users.form.validation.passwordMismatch")):e.confirmPassword=u("settings.users.form.validation.confirmPasswordRequired"),D.userGroup||(e.userGroup=u("settings.users.form.validation.userGroupRequired")),W(e),0===Object.keys(e).length})()){X(!0);try{const a=await p(_({...D,force:s}));if(a?.payload?.email_exists_but_deleted){return(await N.fire({title:u("settings.users.alerts.emailDeletedTitle"),text:u("settings.users.alerts.emailDeletedText"),icon:"warning",showCancelButton:!0,confirmButtonText:u("settings.users.alerts.restoreYes"),cancelButtonText:u("common.no")})).isConfirmed?K(e,!0):void 0}200==a?.payload?.status&&(N.fire(u("common.success")+"!",a.payload.message,"success"),g("/settings/users"))}catch(a){N.fire(u("common.error"),a.message||u("settings.users.alerts.genericError"),"error")}finally{X(!1)}}};return e.jsxs(r,{fluid:!0,className:"settings-form-container",children:[e.jsx("style",{children:"\n        .settings-form-container .btn { min-height: 44px; }\n      "}),e.jsx(w,{title:u("settings.users.create.title"),subtitle:u("settings.users.create.subtitle"),icon:E,showBackButton:!0,onBackClick:()=>g("/settings/users")}),h&&e.jsx(t,{className:"settings-section-card",children:e.jsx(n,{className:"p-3",children:e.jsxs("div",{className:"alert alert-danger mb-0",children:[e.jsxs("strong",{children:[u("common.error"),":"]})," ","string"==typeof h?h:h.message||u("settings.users.alerts.genericError")]})})}),e.jsxs(i,{onSubmit:K,children:[e.jsx(G,{title:u("settings.users.form.titles.basicInfo"),icon:k,children:e.jsxs(o,{children:[e.jsx(l,{xs:12,md:6,children:e.jsx(V,{label:u("settings.users.form.labels.fullName"),name:"name",required:!0,icon:k,placeholder:u("settings.users.form.placeholders.fullName"),value:D.name,onChange:Y,isInvalid:!!M.name,feedback:M.name})}),e.jsx(l,{xs:12,md:6,children:e.jsx(V,{label:u("settings.users.form.labels.email"),name:"email",type:"email",required:!0,icon:P,placeholder:u("settings.users.form.placeholders.email"),value:D.email,onChange:Y,isInvalid:!!M.email,feedback:M.email})})]})}),e.jsx(G,{title:u("settings.users.form.titles.security"),icon:S,children:e.jsxs(o,{children:[e.jsx(l,{xs:12,md:6,children:e.jsx(V,{label:u("settings.users.form.labels.password"),name:"password",type:O?"text":"password",required:!0,icon:z,placeholder:u("settings.users.form.placeholders.password"),value:D.password,onChange:Y,isInvalid:!!M.password,feedback:M.password})}),e.jsx(l,{xs:12,md:6,children:e.jsx(V,{label:u("settings.users.form.labels.confirmPassword"),name:"confirmPassword",type:J?"text":"password",required:!0,icon:z,placeholder:u("settings.users.form.placeholders.confirmPassword"),value:D.confirmPassword,onChange:Y,isInvalid:!!M.confirmPassword,feedback:M.confirmPassword})})]})}),e.jsxs(G,{title:u("settings.users.form.titles.roleAccess"),icon:S,children:[e.jsxs(o,{children:[e.jsx(l,{xs:12,md:6,children:e.jsxs(Z,{label:u("settings.users.form.labels.userGroup"),name:"userGroup",required:!0,icon:k,value:D.userGroup,onChange:Y,isInvalid:!!M.userGroup,feedback:M.userGroup,children:[e.jsx("option",{value:"",children:u("settings.users.form.select.group")}),(f||[]).map(s=>{const a=s?.user_group?.name??s?.name??`Group #${s?.id??""}`,r=s?.user_group?.id??s?.id;return e.jsx("option",{value:r,children:a},r??a)})]})}),e.jsx(l,{xs:12,md:6,children:e.jsxs(Z,{label:u("settings.users.form.labels.location"),name:"location",icon:I,value:D.location,onChange:Y,isInvalid:!!M.location,feedback:M.location,children:[e.jsx("option",{value:"",children:u("settings.users.form.select.location")}),x.map(s=>e.jsx("option",{value:s.id,children:s.locationName},s.id))]})})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between p-3 rounded-3",style:{backgroundColor:"#f8f9fa",border:"1px solid #e3e6f0"},children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"32px",height:"32px",backgroundColor:D.isSalesRep?"#e6ffed":"#fff3cd",color:D.isSalesRep?"#28a745":"#856404"},children:e.jsx(c,{icon:k,size:"sm"})}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold text-dark small",children:u("settings.users.form.labels.salesRep")}),e.jsx("div",{className:"text-muted",style:{fontSize:"12px"},children:u("settings.users.form.hints.salesRep")})]})]}),e.jsx(d,{id:"isSalesRep",name:"isSalesRep",checked:D.isSalesRep,onChange:Y,size:"lg",style:{transform:"scale(1.1)"}})]})})]}),e.jsxs(G,{title:u("settings.users.form.titles.personalAddress","Personal Address"),icon:A,children:[e.jsx(o,{children:e.jsx(l,{xs:12,children:e.jsx(V,{label:u("settings.users.form.labels.streetAddress","Street Address"),name:"street_address",icon:A,placeholder:u("settings.users.form.placeholders.streetAddress","Enter street address"),value:D.street_address,onChange:Y,isInvalid:!!M.street_address,feedback:M.street_address})})}),e.jsxs(o,{children:[e.jsx(l,{xs:12,md:6,children:e.jsx(V,{label:u("settings.users.form.labels.city","City"),name:"city",placeholder:u("settings.users.form.placeholders.city","Enter city"),value:D.city,onChange:Y,isInvalid:!!M.city,feedback:M.city})}),e.jsx(l,{xs:12,md:3,children:e.jsx(V,{label:u("settings.users.form.labels.state","State/Province"),name:"state",placeholder:u("settings.users.form.placeholders.state","State"),value:D.state,onChange:Y,isInvalid:!!M.state,feedback:M.state})}),e.jsx(l,{xs:12,md:3,children:e.jsx(V,{label:u("settings.users.form.labels.zipCode","ZIP/Postal Code"),name:"zip_code",placeholder:u("settings.users.form.placeholders.zipCode","ZIP Code"),value:D.zip_code,onChange:Y,isInvalid:!!M.zip_code,feedback:M.zip_code})})]}),e.jsx(o,{children:e.jsx(l,{xs:12,md:6,children:e.jsx(V,{label:u("settings.users.form.labels.country","Country"),name:"country",placeholder:u("settings.users.form.placeholders.country","Enter country"),value:D.country,onChange:Y,isInvalid:!!M.country,feedback:M.country})})})]}),e.jsxs(G,{title:u("settings.users.form.titles.companyInfo","Company Information"),icon:R,children:[e.jsx(o,{children:e.jsx(l,{xs:12,md:6,children:e.jsx(V,{label:u("settings.users.form.labels.companyName","Company Name"),name:"company_name",icon:R,placeholder:u("settings.users.form.placeholders.companyName","Enter company name"),value:D.company_name,onChange:Y,isInvalid:!!M.company_name,feedback:M.company_name})})}),e.jsx(o,{children:e.jsx(l,{xs:12,children:e.jsx(V,{label:u("settings.users.form.labels.companyStreetAddress","Company Address"),name:"company_street_address",icon:A,placeholder:u("settings.users.form.placeholders.companyStreetAddress","Enter company street address"),value:D.company_street_address,onChange:Y,isInvalid:!!M.company_street_address,feedback:M.company_street_address})})}),e.jsxs(o,{children:[e.jsx(l,{xs:12,md:6,children:e.jsx(V,{label:u("settings.users.form.labels.companyCity","Company City"),name:"company_city",placeholder:u("settings.users.form.placeholders.companyCity","Enter company city"),value:D.company_city,onChange:Y,isInvalid:!!M.company_city,feedback:M.company_city})}),e.jsx(l,{xs:12,md:3,children:e.jsx(V,{label:u("settings.users.form.labels.companyState","Company State/Province"),name:"company_state",placeholder:u("settings.users.form.placeholders.companyState","State"),value:D.company_state,onChange:Y,isInvalid:!!M.company_state,feedback:M.company_state})}),e.jsx(l,{xs:12,md:3,children:e.jsx(V,{label:u("settings.users.form.labels.companyZipCode","Company ZIP/Postal Code"),name:"company_zip_code",placeholder:u("settings.users.form.placeholders.companyZipCode","ZIP Code"),value:D.company_zip_code,onChange:Y,isInvalid:!!M.company_zip_code,feedback:M.company_zip_code})})]}),e.jsx(o,{children:e.jsx(l,{xs:12,md:6,children:e.jsx(V,{label:u("settings.users.form.labels.companyCountry","Company Country"),name:"company_country",placeholder:u("settings.users.form.placeholders.companyCountry","Enter company country"),value:D.company_country,onChange:Y,isInvalid:!!M.company_country,feedback:M.company_country})})})]}),e.jsx(t,{className:"settings-form-actions",children:e.jsx(n,{className:"p-3 p-md-4",children:e.jsxs("div",{className:"d-flex flex-column flex-md-row gap-2 gap-md-3 justify-content-end",children:[e.jsxs(m,{type:"button",color:"light",size:"md",className:"settings-form-cancel-btn order-2 order-md-1",onClick:()=>{JSON.stringify(D)!==JSON.stringify(H.current)?N.fire({title:u("common.confirm")||"Are you sure?",text:u("settings.users.form.alerts.leaveWarning"),icon:"warning",showCancelButton:!0,confirmButtonText:u("settings.users.form.alerts.leaveAnyway"),cancelButtonText:u("settings.users.form.alerts.stayOnPage"),confirmButtonColor:"#d33",cancelButtonColor:"#6c757d"}).then(e=>{e.isConfirmed&&g("/settings/users")}):g("/settings/users")},children:[e.jsx(c,{icon:q,className:"me-2"}),u("common.cancel")]}),e.jsx(m,{type:"submit",color:"success",size:"md",disabled:U,className:"settings-form-submit-btn order-1 order-md-2",children:U?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",style:{width:"14px",height:"14px"},children:e.jsx("span",{className:"visually-hidden",children:u("common.loading")})}),u("settings.users.create.submitting")]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{icon:B,className:"me-2"}),u("settings.users.create.submit")]})})]})})})]})]})};export{D as default};
