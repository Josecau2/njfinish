import{j as e}from"./date-vendor-D9pAgX5F.js";import{r as s}from"./react-vendor-DF7UJAlN.js";import{a as t,u as r}from"./redux-vendor-BzdbewH4.js";import{u as l,H as i,I as a,J as n,K as o,L as d}from"./index-DW-yAxzW.js";import{P as c}from"./DefaultLayout-BUcG_pV2.js";import{i as u,H as m,l as p,a as h,h as x,U as g,V as j,I as b,J as f,m as y,e as N,v,b as G,d as w,W as C,X as S,$ as k,a0 as z,a1 as _,a2 as H,a3 as B,a4 as P,a8 as F}from"./ui-vendor-DjmSPU99.js";import{S as R}from"./utils-vendor-Nl-sF5xe.js";import{P as $}from"./PaginationComponent-B2yVAl0f.js";import{j as L,k as O,U as W,S as I,a as M}from"./icons-vendor-D82TZqJV.js";import"./form-vendor-CKNVq0c_.js";const T=({show:r,onClose:i,manufacturer:a,onSave:n})=>{const{t:o}=l();t(e=>e.customization);const[d,v]=s.useState({name:"",multiplier:"",enabled:!1}),[G,w]=s.useState(null);s.useEffect(()=>{a&&v({name:a.user_group.name||"",multiplier:a.multiplier||"",enabled:a.enabled||!1})},[a]);const C={backgroundColor:"#f8f9fa",border:"1px solid #dcdcdc",borderRadius:"8px",padding:"10px 14px",fontSize:"15px"},S={...C,backgroundColor:"#f1f3f5",color:"#6c757d",cursor:"not-allowed"};return e.jsx(u,{visible:r,onClose:i,size:"lg",backdrop:"static",alignment:"center",scrollable:!0,children:e.jsxs(m,{onSubmit:e=>{e.preventDefault(),w(null),n(d)},children:[e.jsxs(p,{className:"p-0",children:[e.jsx(c,{title:o("settings.userGroups.multipliers.modal.title"),cardClassName:"mb-0 rounded-top-3"}),e.jsxs("div",{className:"p-4",children:[G&&e.jsx(h,{color:"danger",role:"alert","aria-live":"assertive",children:G}),e.jsxs(x,{fluid:!0,children:[e.jsxs(g,{className:"mb-3",children:[e.jsxs(j,{xs:6,md:6,children:[e.jsx(b,{htmlFor:"name",children:o("settings.userGroups.multipliers.modal.labels.name")}),e.jsx(f,{type:"text",id:"name",name:"name",value:d.name,readOnly:!0,placeholder:o("settings.userGroups.multipliers.modal.placeholders.name"),style:S,"aria-label":o("settings.userGroups.multipliers.modal.labels.name")})]}),e.jsxs(j,{xs:6,md:6,children:[e.jsx(b,{htmlFor:"multiplier",children:o("settings.userGroups.multipliers.modal.labels.multiplier")}),e.jsx(f,{type:"number",step:"0.01",id:"multiplier",name:"multiplier",value:d.multiplier,onChange:e=>{const s=e.target.value;(""===s||/^(?:\d{0,4})(?:\.\d{0,2})?$/.test(s))&&v(e=>({...e,multiplier:s}))},placeholder:o("settings.userGroups.multipliers.modal.placeholders.multiplier"),style:C,"aria-label":o("settings.userGroups.multipliers.modal.labels.multiplier")})]})]}),e.jsx(g,{children:e.jsx(j,{xs:6,md:6,children:e.jsxs("div",{className:"form-check form-switch mt-5",style:{transform:"scale(1.0)",display:"flex",alignItems:"center"},children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"enabled",name:"enabled",checked:d.enabled,onChange:e=>{const{name:s,value:t,type:r,checked:l}=e.target;v(e=>({...e,[s]:"checkbox"===r?l:t}))},"aria-label":o("settings.userGroups.multipliers.modal.labels.enabled")}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:"enabled",style:{fontSize:"1.1rem"},children:o("settings.userGroups.multipliers.modal.labels.enabled")})]})})})]})]})]}),e.jsxs(y,{children:[e.jsx(N,{color:"secondary",variant:"outline",onClick:i,style:{minHeight:"44px"},children:o("common.cancel")}),e.jsx(N,{color:"primary",type:"submit",style:{minHeight:"44px"},children:o("common.save")})]})]})})},E=()=>{const{t:u}=l(),m=r(),{list:p=[],allGroups:h=[]}=t(e=>e.usersGroup||{}),{list:b=[]}=t(e=>e.multiManufacturer||{}),y=t(e=>e.customization),[E,X]=s.useState(""),[D,J]=s.useState("name"),[U,A]=s.useState("desc"),[K,V]=s.useState(!1),[q,Q]=s.useState(null),[Y,Z]=s.useState(1),[ee,se]=s.useState(10);s.useEffect(()=>{m(i()),m(a()),m(n())},[m]);const te=h.map(e=>{const s=p.find(s=>s.user_group?.id===e.id);return{id:s?.id||null,user_group:e,multiplier:s?.multiplier||null,enabled:s?.enabled||0}}).filter(e=>2!==e.user_group.id),re=te.filter(e=>(e.user_group?.name||"").toLowerCase().includes(E.toLowerCase())),le=(Y-1)*ee,ie=le+ee,ae=re.slice(le,ie),ne=Math.ceil(re.length/ee),oe=te.filter(e=>1===e.enabled).length,de=te.length-oe;return e.jsxs(x,{fluid:!0,className:"p-2 m-2",style:{backgroundColor:"#f8fafc",minHeight:"100vh"},children:[e.jsx(c,{title:e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center",style:{width:"48px",height:"48px",backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"12px"},children:e.jsx(L,{style:{width:24,height:24,color:"white"},"aria-hidden":"true"})}),u("settings.userGroups.multipliers.header")]}),subtitle:u("settings.userGroups.multipliers.subtitle"),rightContent:e.jsxs(v,{color:"light",className:"px-3 py-2",style:{borderRadius:"5px",fontSize:"12px",fontWeight:"500",color:"#6c757d"},children:[e.jsx(L,{className:"me-1",size:14,"aria-hidden":"true"}),te.length," ",u("settings.userGroups.multipliers.groups")]})}),e.jsxs(g,{className:"mb-2",children:[e.jsx(j,{md:4,children:e.jsx(G,{className:"border-0 shadow-sm h-100",children:e.jsx(w,{className:"text-center py-4",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"50px",height:"50px",backgroundColor:"#e6ffed",color:"#28a745"},children:e.jsx(O,{size:22,"aria-hidden":"true"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0 fw-bold text-success",children:oe}),e.jsx("small",{className:"text-muted",children:u("settings.userGroups.multipliers.stats.activeGroups")})]})]})})})}),e.jsx(j,{md:4,children:e.jsx(G,{className:"border-0 shadow-sm h-100",children:e.jsx(w,{className:"text-center py-4",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"50px",height:"50px",backgroundColor:"#ffe6e6",color:"#dc3545"},children:e.jsx(O,{size:22,"aria-hidden":"true"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0 fw-bold text-danger",children:de}),e.jsx("small",{className:"text-muted",children:u("settings.userGroups.multipliers.stats.inactiveGroups")})]})]})})})}),e.jsx(j,{md:4,children:e.jsx(G,{className:"border-0 shadow-sm h-100",children:e.jsx(w,{className:"text-center py-4",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"50px",height:"50px",backgroundColor:`${y.headerBg||"#667eea"}20`,color:y.headerBg||"#667eea"},children:e.jsx(W,{size:22,"aria-hidden":"true"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0 fw-bold text-primary",children:p.length}),e.jsx("small",{className:"text-muted",children:u("settings.userGroups.multipliers.stats.totalGroups")})]})]})})})})]}),e.jsx(G,{className:"border-0 shadow-sm mb-1",children:e.jsx(w,{children:e.jsxs(g,{className:"align-items-center",children:[e.jsx(j,{md:6,lg:4,children:e.jsxs(C,{children:[e.jsx(S,{style:{background:"none",border:"none"},children:e.jsx(I,{"aria-hidden":"true",size:18})}),e.jsx(f,{type:"text",placeholder:u("settings.userGroups.multipliers.searchPlaceholder"),value:E,onChange:e=>{X(e.target.value),Z(1)},style:{border:"1px solid #e3e6f0",borderRadius:"10px",fontSize:"14px",padding:"12px 16px"}})]})}),e.jsx(j,{md:6,lg:8,className:"text-md-end mt-3 mt-md-0",children:e.jsx("span",{className:"text-muted small",children:u("settings.userGroups.multipliers.showing",{count:re?.length||0,total:te?.length||0})})})]})})}),e.jsx(G,{className:"border-0 shadow-sm",children:e.jsxs(w,{className:"p-0",children:[e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs(k,{hover:!0,responsive:!0,className:"mb-0",children:[e.jsx(z,{style:{backgroundColor:"#f8f9fa"},children:e.jsxs(_,{children:[e.jsx(H,{scope:"col",className:"border-0 fw-semibold text-muted py-3",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(L,{size:16,"aria-hidden":"true"}),u("settings.userGroups.multipliers.table.groupName")]})}),e.jsx(H,{scope:"col",className:"border-0 fw-semibold text-muted py-3",children:u("settings.userGroups.multipliers.table.multiplier")}),e.jsx(H,{scope:"col",className:"border-0 fw-semibold text-muted py-3",children:u("settings.userGroups.multipliers.table.status")}),e.jsx(H,{scope:"col",className:"border-0 fw-semibold text-muted py-3 text-center",children:u("settings.userGroups.multipliers.table.actions")})]})}),e.jsx(B,{children:0===ae?.length?e.jsx(_,{children:e.jsx(P,{colSpan:"4",className:"text-center py-5",children:e.jsxs("div",{className:"text-muted",children:[e.jsx(I,{size:28,className:"mb-3 opacity-25","aria-hidden":"true"}),e.jsx("p",{className:"mb-0",children:u("settings.userGroups.multipliers.empty.title")}),e.jsx("small",{children:u("settings.userGroups.multipliers.empty.subtitle")})]})})}):ae.map(s=>e.jsxs(_,{style:{transition:"all 0.2s ease"},children:[e.jsx(P,{className:"py-3 border-0 border-bottom border-light",children:e.jsx("div",{className:"fw-medium text-dark",children:s.user_group?.name||u("common.na")})}),e.jsx(P,{className:"py-3 border-0 border-bottom border-light",children:e.jsx(v,{color:"primary",className:"px-3 py-2",style:{borderRadius:"20px",fontSize:"12px",fontWeight:"600"},children:s.multiplier?`${s.multiplier}`:u("common.na")})}),e.jsx(P,{className:"py-3 border-0 border-bottom border-light",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(F,{checked:1===s.enabled,onChange:()=>((e,s)=>{const t={enabled:!s};e.id?m(d({id:e.id,data:t})).unwrap().then(()=>{m(n()),m(a()),R.fire({toast:!0,position:"top",icon:"success",title:u("settings.userGroups.multipliers.toast.updateSuccess"),showConfirmButton:!1,timer:1500,width:"360px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}).catch(e=>{R.fire({toast:!0,position:"top",icon:"error",title:u("settings.userGroups.multipliers.toast.updateFailed"),showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}):(t.user_group_id=e.user_group.id,t.multiplier=1,m(o(t)).unwrap().then(()=>{m(n()),m(a()),R.fire({toast:!0,position:"top",icon:"success",title:u("settings.userGroups.multipliers.toast.updateSuccess"),showConfirmButton:!1,timer:1500,width:"360px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}).catch(e=>{R.fire({toast:!0,position:"top",icon:"error",title:u("settings.userGroups.multipliers.toast.updateFailed"),showConfirmButton:!1,timer:1500,width:"330px",didOpen:e=>{e.style.padding="8px 12px",e.style.fontSize="14px",e.style.minHeight="auto"}})}))})(s,s.enabled),style:{transform:"scale(1.1)"},"aria-label":1===s.enabled?u("settings.userGroups.multipliers.status.setInactive"):u("settings.userGroups.multipliers.status.setActive")}),e.jsx(v,{color:1===s.enabled?"success":"secondary",className:"px-2 py-1",style:{borderRadius:"15px",fontSize:"10px",fontWeight:"500"},children:1===s.enabled?u("settings.userGroups.multipliers.status.active"):u("settings.userGroups.multipliers.status.inactive")})]})}),e.jsx(P,{className:"py-3 border-0 border-bottom border-light text-center",children:e.jsx(N,{color:"light",size:"sm",className:"p-2 icon-btn",onClick:()=>(e=>{Q(e),V(!0)})(s),title:u("settings.userGroups.multipliers.actions.edit"),"aria-label":u("settings.userGroups.multipliers.actions.edit"),style:{borderRadius:"8px",border:"1px solid #e3e6f0",transition:"all 0.2s ease",minHeight:"44px",minWidth:"44px"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=`${y.headerBg||"#667eea"}20`,e.currentTarget.style.borderColor=y.headerBg||"#667eea"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="",e.currentTarget.style.borderColor="#e3e6f0"},children:e.jsx(M,{size:16,style:{color:y.headerBg||"#667eea"},"aria-hidden":"true"})})})]},s.id||`group-${s.user_group.id}`))})]})}),e.jsx($,{currentPage:Y,totalPages:ne,onPageChange:Z,itemsPerPage:ee})]})}),e.jsx(T,{show:K,onClose:()=>{V(!1),Q(null)},manufacturer:q,onSave:e=>{q&&(q.id?m(d({id:q.id,data:e})).unwrap().then(e=>{V(!1),Q(null),R.fire(u("common.success")+"!",e.message||u("settings.userGroups.multipliers.toast.updateSuccess"),"success"),m(n()),m(a())}).catch(e=>{R.fire(u("common.error"),e.message||u("settings.userGroups.multipliers.toast.updateFailed"),"error")}):(e.user_group_id=q.user_group.id,m(o(e)).unwrap().then(e=>{V(!1),Q(null),R.fire(u("common.success")+"!",e.message||u("settings.userGroups.multipliers.toast.updateSuccess"),"success"),m(n()),m(a())}).catch(e=>{R.fire(u("common.error"),e.message||u("settings.userGroups.multipliers.toast.updateFailed"),"error")})))}})]})};export{E as default};
