import{j as s}from"./date-vendor-D9pAgX5F.js";import{u as e,r as t,i as a}from"./react-vendor-DF7UJAlN.js";import{g as r,b as c,d as l}from"./DefaultLayout-BUcG_pV2.js";import{u as i,a as n}from"./redux-vendor-BzdbewH4.js";import{u as d,af as o,ag as m,ah as x,ai as h,aj as j,ak as u}from"./index-DW-yAxzW.js";import{U as p,V as N,b,d as g,c as f,Z as A,_ as y,v,ae as w,C as z,W as k,X as _,J as C,ab as S,e as I,$ as P,a0 as D,a1 as T,a2 as O,a3 as E,a4 as L,G as U,i as $,j as F,k as H,l as M,af as J,ag as q,ah as B,ai as W,a as G,m as K,h as R,R as V,B as X,E as Z,S as Q,T as Y}from"./ui-vendor-DjmSPU99.js";import{U as ss,j as es,n as ts,o as as,p as rs,q as cs,r as ls,S as is,s as ns,t as ds,u as os,C as ms,i as xs,v as hs,c as js,I as us,H as ps,M as Ns,b as bs,w as gs,k as fs,x as As,m as ys}from"./icons-vendor-D82TZqJV.js";import{E as vs}from"./EmptyState-CAqMnOWD.js";import{P as ws}from"./PaginationComponent-B2yVAl0f.js";import"./form-vendor-CKNVq0c_.js";import"./utils-vendor-Nl-sF5xe.js";import"./cil-search-CDkY_4k-.js";const zs=(s,e={})=>{if(!s)return"N/A";try{const t=new Date(s);if(isNaN(t.getTime()))return"N/A";const a={year:"numeric",month:"short",day:"numeric"};return t.toLocaleDateString("en-US",{...a,...e})}catch(t){return"N/A"}},ks=({contractor:e})=>{const{t:t}=d(),a=(s=>{if(!s||"object"!=typeof s)return[];const e={dashboard:{label:t("contractorsAdmin.modules.dashboard"),color:"primary"},proposals:{label:t("contractorsAdmin.modules.proposals"),color:"success"},customers:{label:t("contractorsAdmin.modules.customers"),color:"warning"},resources:{label:t("contractorsAdmin.modules.resources"),color:"info"}};let a=s;if("string"==typeof s)try{a=JSON.parse(s)}catch(r){return[]}return["dashboard","proposals","customers","resources"].map(s=>({key:s,label:e[s]?.label||s,color:e[s]?.color||"secondary",enabled:!0===a[s]}))})(e.modules),r=a.filter(s=>s.enabled).length,c=a.length,l=c>0?r/c*100:0;return s.jsxs(p,{children:[s.jsx(N,{sm:6,lg:3,className:"mb-4",children:s.jsx(b,{className:"text-center",children:s.jsxs(g,{children:[s.jsx(ss,{size:32,className:"text-primary mb-3","aria-hidden":"true"}),s.jsx("h3",{className:"text-primary",children:e.stats?.user_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.table.users")})]})})}),s.jsx(N,{sm:6,lg:3,className:"mb-4",children:s.jsx(b,{className:"text-center",children:s.jsxs(g,{children:[s.jsx(es,{size:32,className:"text-warning mb-3","aria-hidden":"true"}),s.jsx("h3",{className:"text-warning",children:e.stats?.customer_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.table.customers")})]})})}),s.jsx(N,{sm:6,lg:3,className:"mb-4",children:s.jsx(b,{className:"text-center",children:s.jsxs(g,{children:[s.jsx(ts,{size:32,className:"text-success mb-3","aria-hidden":"true"}),s.jsx("h3",{className:"text-success",children:e.stats?.proposal_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.table.proposals")})]})})}),s.jsx(N,{sm:6,lg:3,className:"mb-4",children:s.jsx(b,{className:"text-center",children:s.jsxs(g,{children:[s.jsx(as,{size:32,className:"text-info mb-3","aria-hidden":"true"}),s.jsxs("h3",{className:"text-info",children:[r,"/",c]}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.table.modules")})]})})}),s.jsx(N,{md:6,className:"mb-4",children:s.jsxs(b,{children:[s.jsx(f,{children:s.jsx("strong",{children:t("contractorsAdmin.detail.basicInfo.title")})}),s.jsx(g,{children:s.jsxs(A,{flush:!0,children:[s.jsxs(y,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[s.jsx(es,{size:16,className:"me-2 text-muted","aria-hidden":"true"}),t("contractorsAdmin.detail.basicInfo.contractorName")]}),s.jsx("strong",{children:e.name})]}),s.jsxs(y,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[s.jsx(rs,{size:16,className:"me-2 text-muted","aria-hidden":"true"}),t("contractorsAdmin.detail.basicInfo.createdDate")]}),s.jsx("span",{children:zs(e.created_at)})]}),s.jsxs(y,{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{children:t("contractorsAdmin.detail.basicInfo.groupType")}),s.jsx(v,{color:"info",children:e.group_type||"contractor"})]}),e.contractor_settings?.max_users&&s.jsxs(y,{className:"d-flex justify-content-between align-items-center",children:[s.jsx("span",{children:t("contractorsAdmin.detail.basicInfo.maxUsers")}),s.jsx("span",{children:e.contractor_settings.max_users})]})]})})]})}),s.jsx(N,{md:6,className:"mb-4",children:s.jsxs(b,{children:[s.jsxs(f,{className:"d-flex justify-content-between align-items-center",children:[s.jsx("strong",{children:t("contractorsAdmin.detail.moduleAccess.title")}),s.jsx("div",{children:s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.moduleAccess.enabledOfTotal",{enabled:r,total:c})})})]}),s.jsxs(g,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx(w,{value:l,color:l>75?"success":l>50?"warning":"danger",className:"mb-2"}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.moduleAccess.percentEnabled",{percent:Math.round(l)})})]}),s.jsx(A,{flush:!0,children:a.map(e=>s.jsxs(y,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[e.enabled?s.jsx(cs,{size:16,className:"me-2 text-success","aria-hidden":"true"}):s.jsx(ls,{size:16,className:"me-2 text-danger","aria-hidden":"true"}),e.label]}),s.jsx(v,{color:e.enabled?e.color:"secondary",children:e.enabled?t("contractorsAdmin.detail.enabled"):t("contractorsAdmin.detail.disabled")})]},e.key))})]})]})}),s.jsx(N,{xs:12,children:s.jsxs(b,{children:[s.jsx(f,{children:s.jsx("strong",{children:t("contractorsAdmin.detail.activity.title")})}),s.jsx(g,{children:s.jsxs(p,{children:[s.jsx(N,{md:4,className:"border-end",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h4",{className:"text-primary",children:e.stats?.user_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.activity.totalUsers")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.activity.totalUsersHint")})]})}),s.jsx(N,{md:4,className:"border-end",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h4",{className:"text-warning",children:e.stats?.customer_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.activity.totalCustomers")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.activity.totalCustomersHint")})]})}),s.jsx(N,{md:4,children:s.jsxs("div",{className:"text-center",children:[s.jsx("h4",{className:"text-success",children:e.stats?.proposal_count||0}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.activity.totalProposals")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.activity.totalProposalsHint")})]})})]})})]})})]})},_s=({contractor:a,groupId:l})=>{const{t:j}=d(),u=i(),w=e(),{contractorProposals:{data:R,pagination:V,loading:X,error:Z},proposalDetails:Q}=n(s=>s.contractors),[Y,es]=t.useState(""),[as,Ns]=t.useState(""),[bs,gs]=t.useState("all"),[fs,As]=t.useState({key:"createdAt",direction:"desc"}),[ys,zs]=t.useState(1),[ks]=t.useState(10),[_s,Cs]=t.useState(!1),[Ss,Is]=t.useState(null),Ps={all:{label:j("proposals.tabs.all"),color:"primary",Icon:os},draft:{label:j("proposals.status.draft"),color:"secondary",Icon:os},sent:{label:j("proposals.status.sent"),color:"info",Icon:ds},pending:{label:j("contractorsAdmin.detail.proposals.status.pending"),color:"warning",Icon:ns},approved:{label:j("contractorsAdmin.detail.proposals.status.approved"),color:"success",Icon:cs},accepted:{label:j("proposals.status.accepted"),color:"success",Icon:cs},rejected:{label:j("proposals.status.rejected"),color:"danger",Icon:ls},expired:{label:j("proposals.status.expired"),color:"dark",Icon:ns},in_progress:{label:j("contractorsAdmin.detail.proposals.status.inProgress"),color:"info",Icon:ns},completed:{label:j("contractorsAdmin.detail.proposals.status.completed"),color:"success",Icon:cs}};t.useEffect(()=>{const s=setTimeout(()=>{Ns(Y)},500);return()=>clearTimeout(s)},[Y]),t.useEffect(()=>{l&&u(o({groupId:l,page:ys,limit:ks,status:"all"===bs?void 0:bs,search:as}))},[u,l,ys,ks,bs,as]),t.useEffect(()=>{Z&&m(j("contractorsAdmin.detail.proposals.loadFailed"),"string"==typeof Z?Z:"")},[Z]);const Ds=()=>{Cs(!1),Is(null),u(h())},Ts=s=>{const e=`/${r(6)}/${r(8)}`+c("/quotes/:proposalId/admin-view",{proposalId:s});w(e)},Os=s=>{As(e=>{const t=e.key===s&&"asc"===e.direction?"desc":"asc";return{key:s,direction:t}})},Es=s=>Ps[s]?.color||"secondary",Ls=s=>Ps[s]?.Icon||os,Us=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s||0),$s=s=>{if(!s.manufacturersData)return 0;try{const e=JSON.parse(s.manufacturersData);let t=0;return e.forEach(s=>{s.summary&&s.summary.grandTotal&&(t+=s.summary.grandTotal)}),t}catch(e){return 0}},Fs=s=>{if(!s)return"N/A";try{const e=new Date(s);return isNaN(e.getTime())?"N/A":e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(e){return"N/A"}},Hs=s=>{if(!s)return"N/A";try{const e=new Date(s);return isNaN(e.getTime())?"N/A":e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch(e){return"N/A"}},Ms=t.useMemo(()=>{const s={all:R?.length||0};return R&&R.length>0&&R.forEach(e=>{const t=e.status||"draft";s[t]=(s[t]||0)+1}),s},[R]),Js=R||[];return X?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:s.jsx(z,{color:"primary"})}):s.jsxs(s.Fragment,{children:[s.jsx(p,{children:s.jsx(N,{xs:12,children:s.jsxs(b,{children:[s.jsx(f,{children:s.jsxs("strong",{children:[s.jsx(ts,{size:16,className:"me-2","aria-hidden":"true"}),j("contractorsAdmin.detail.proposals.header",{count:V?.total||0})]})}),s.jsxs(g,{children:[Z&&m(j("contractorsAdmin.detail.proposals.loadFailed"),"string"==typeof Z?Z:""),s.jsxs(p,{className:"mb-4",children:[s.jsx(N,{md:6,children:s.jsxs(k,{children:[s.jsx(_,{"aria-hidden":"true",children:s.jsx(is,{size:16})}),s.jsx(C,{type:"text",placeholder:j("contractorsAdmin.detail.proposals.searchPlaceholder"),"aria-label":j("contractorsAdmin.detail.proposals.searchAria","Search proposals"),value:Y,onChange:s=>{es(s.target.value),zs(1)}})]})}),s.jsx(N,{md:6,className:"d-flex align-items-center justify-content-end",children:s.jsx("small",{className:"text-muted me-2",children:j("contractorsAdmin.detail.proposals.quickFilters")})})]}),s.jsx("div",{className:"mb-4",children:s.jsx(S,{className:"flex-wrap",children:Object.entries(Ps).map(([e,t])=>{const a=Ms[e]||0,r=bs===e;return s.jsxs(I,{variant:r?"solid":"outline",color:t.color,size:"sm",className:"me-2 mb-2",onClick:()=>(s=>{gs(s),zs(1)})(e),disabled:0===a&&"all"!==e,children:[(()=>{const e=t.Icon;return s.jsx(e,{size:14,className:"me-1","aria-hidden":"true"})})(),t.label,a>0&&s.jsx(v,{color:r?"light":t.color,className:"ms-1",children:a})]},e)})})}),s.jsx("div",{className:"table-wrap",children:s.jsxs(P,{hover:!0,striped:!0,className:"table-modern",children:[s.jsx(D,{children:s.jsxs(T,{children:[s.jsxs(O,{scope:"col",className:"cursor-pointer",onClick:()=>Os("title"),children:[j("contractorsAdmin.detail.proposals.table.title"),"title"===fs.key&&("asc"===fs.direction?s.jsx(ms,{size:14,className:"ms-1","aria-hidden":"true"}):s.jsx(xs,{size:14,className:"ms-1","aria-hidden":"true"}))]}),s.jsxs(O,{scope:"col",className:"cursor-pointer",onClick:()=>Os("customer_name"),children:[j("proposals.headers.customer"),"customer_name"===fs.key&&("asc"===fs.direction?s.jsx(ms,{size:14,className:"ms-1","aria-hidden":"true"}):s.jsx(xs,{size:14,className:"ms-1","aria-hidden":"true"}))]}),s.jsxs(O,{scope:"col",className:"cursor-pointer",onClick:()=>Os("status"),children:[j("proposals.headers.status"),"status"===fs.key&&("asc"===fs.direction?s.jsx(ms,{size:14,className:"ms-1","aria-hidden":"true"}):s.jsx(xs,{size:14,className:"ms-1","aria-hidden":"true"}))]}),s.jsxs(O,{scope:"col",className:"cursor-pointer",onClick:()=>Os("total_amount"),children:[j("contractorsAdmin.detail.proposals.table.amount"),"total_amount"===fs.key&&("asc"===fs.direction?s.jsx(ms,{size:14,className:"ms-1","aria-hidden":"true"}):s.jsx(xs,{size:14,className:"ms-1","aria-hidden":"true"}))]}),s.jsxs(O,{scope:"col",className:"cursor-pointer",onClick:()=>Os("createdAt"),children:[j("proposals.headers.date"),"createdAt"===fs.key&&("asc"===fs.direction?s.jsx(ms,{size:14,className:"ms-1","aria-hidden":"true"}):s.jsx(xs,{size:14,className:"ms-1","aria-hidden":"true"}))]}),s.jsxs(O,{scope:"col",className:"cursor-pointer",onClick:()=>Os("updatedAt"),children:[j("contractorsAdmin.detail.proposals.table.updated"),"updatedAt"===fs.key&&("asc"===fs.direction?s.jsx(ms,{size:14,className:"ms-1","aria-hidden":"true"}):s.jsx(xs,{size:14,className:"ms-1","aria-hidden":"true"}))]}),s.jsx(O,{scope:"col",className:"text-center",style:{width:"150px"},children:j("proposals.headers.actions")})]})}),s.jsx(E,{children:0===Js.length?s.jsx(T,{children:s.jsx(L,{colSpan:"7",children:s.jsx(vs,{title:j("contractorsAdmin.detail.proposals.empty.title"),subtitle:j("contractorsAdmin.detail.proposals.empty.subtitle")})})}):Js.map(e=>s.jsxs(T,{className:"align-middle",children:[s.jsx(L,{children:s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:e.title||`Proposal #${e.id}`}),s.jsxs("small",{className:"text-muted",children:["ID: ",e.id]})]})}),s.jsx(L,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ss,{size:14,className:"me-1 text-muted","aria-hidden":"true"}),e.customer?.name||e.customer_name||"N/A"]})}),s.jsx(L,{children:s.jsxs(v,{color:Es(e.status),className:"d-flex align-items-center",style:{width:"fit-content"},children:[(()=>{const t=Ls(e.status);return s.jsx(t,{size:14,className:"me-1","aria-hidden":"true"})})(),Ps[e.status]?.label||e.status||j("proposals.status.draft")]})}),s.jsx(L,{children:s.jsx("div",{className:"fw-bold text-success",children:Us($s(e))})}),s.jsx(L,{children:s.jsx("div",{children:s.jsx("small",{className:"text-muted",children:Hs(e.createdAt)})})}),s.jsx(L,{children:s.jsx("div",{children:s.jsx("small",{className:"text-muted",children:Hs(e.updatedAt)})})}),s.jsx(L,{className:"text-center",children:s.jsxs(S,{size:"sm",children:[s.jsx(U,{content:"View Details",children:s.jsx(I,{color:"outline-info",size:"sm",className:"icon-btn","aria-label":j("contractorsAdmin.detail.proposals.actions.viewDetails","View proposal details"),onClick:()=>(s=>{Is(s),Cs(!0),u(x(s.id))})(e),children:s.jsx(is,{size:16,"aria-hidden":"true"})})}),s.jsx(U,{content:"Go to Proposal",children:s.jsx(I,{color:"outline-primary",size:"sm",className:"icon-btn","aria-label":j("contractorsAdmin.detail.proposals.actions.open","Open proposal"),onClick:()=>Ts(e.id),children:s.jsx(hs,{size:16,"aria-hidden":"true"})})})]})})]},e.id))})]})}),V?.totalPages>1&&s.jsx("div",{className:"pt-3 border-top border-light",children:s.jsx(ws,{currentPage:ys,totalPages:V?.totalPages||1,onPageChange:s=>{zs(s)},itemsPerPage:ks})})]})]})})}),s.jsxs($,{visible:_s,onClose:Ds,size:"xl",scrollable:!0,className:"proposal-detail-modal",children:[s.jsx(F,{children:s.jsxs(H,{children:[s.jsx(ts,{size:16,className:"me-2","aria-hidden":"true"}),j("contractorsAdmin.detail.proposals.modal.title"),Ss&&s.jsx(v,{color:Es(Ss.status),className:"ms-2",children:Ps[Ss.status]?.label||Ss.status||"Draft"})]})}),s.jsx(M,{children:Q.loading?s.jsxs("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"300px"},children:[s.jsx(z,{color:"primary",size:"lg"}),s.jsx("span",{className:"ms-3",children:j("contractorsAdmin.detail.proposals.modal.loading")})]}):Q.data?s.jsxs("div",{children:[s.jsxs(p,{className:"mb-4",children:[s.jsxs(N,{md:8,children:[s.jsx("h4",{className:"mb-2",children:Q.data.title||`Proposal #${Q.data.id}`}),s.jsxs("div",{className:"d-flex flex-wrap gap-3 text-muted",children:[s.jsxs("div",{children:[s.jsx(ss,{size:14,className:"me-1","aria-hidden":"true"}),s.jsxs("strong",{children:[j("proposalAcceptance.labels.customer"),":"]})," ",Q.data.customer?.name||j("common.na")]}),s.jsxs("div",{children:[s.jsx(rs,{size:14,className:"me-1","aria-hidden":"true"}),s.jsxs("strong",{children:[j("proposals.headers.date"),":"]})," ",Fs(Q.data.createdAt)]}),s.jsxs("div",{children:[s.jsx(js,{size:14,className:"me-1","aria-hidden":"true"}),s.jsxs("strong",{children:[j("contractorsAdmin.detail.proposals.modal.group"),":"]})," ",a?.name||j("common.na")]})]})]}),s.jsxs(N,{md:4,className:"text-end",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("h3",{className:"text-success mb-0",children:Us($s(Q.data))}),s.jsx("small",{className:"text-muted",children:j("contractorsAdmin.detail.proposals.modal.totalAmount")})]}),s.jsxs(I,{color:"primary",size:"sm",className:"icon-btn","aria-label":j("contractorsAdmin.detail.proposals.modal.goToProposal"),onClick:()=>Ts(Q.data.id),children:[s.jsx(hs,{size:16,className:"me-1","aria-hidden":"true"}),j("contractorsAdmin.detail.proposals.modal.goToProposal")]})]})]}),s.jsxs(J,{flush:!0,children:[s.jsxs(q,{itemKey:"1",children:[s.jsxs(B,{children:[s.jsx(us,{size:16,className:"me-2","aria-hidden":"true"}),j("contractorsAdmin.detail.proposals.modal.basicInfo")]}),s.jsxs(W,{children:[s.jsxs(p,{children:[s.jsx(N,{md:6,children:s.jsxs(A,{flush:!0,children:[s.jsxs(y,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:j("contractorsAdmin.detail.proposals.modal.proposalId")}),s.jsxs("strong",{children:["#",Q.data.id]})]}),s.jsxs(y,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:j("proposals.headers.status")}),s.jsxs(v,{color:Es(Q.data.status),children:[(()=>{const e=Ls(Q.data.status);return s.jsx(e,{size:14,className:"me-1","aria-hidden":"true"})})(),Ps[Q.data.status]?.label||Q.data.status||j("proposals.status.draft")]})]}),s.jsxs(y,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:j("proposalAcceptance.labels.customer")}),s.jsx("span",{children:Q.data.customer?.name||"N/A"})]}),s.jsxs(y,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:j("contractorsAdmin.detail.proposals.modal.totalAmount")}),s.jsx("strong",{className:"text-success",children:Us($s(Q.data))})]})]})}),s.jsx(N,{md:6,children:s.jsxs(A,{flush:!0,children:[s.jsxs(y,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:j("contractorsAdmin.detail.proposals.modal.created")}),s.jsx("span",{children:Fs(Q.data.createdAt)})]}),s.jsxs(y,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:j("contractorsAdmin.detail.proposals.modal.updated")}),s.jsx("span",{children:Fs(Q.data.updatedAt)})]}),Q.data.sent_at&&s.jsxs(y,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:j("contractorsAdmin.detail.proposals.modal.sent")}),s.jsx("span",{className:"text-info",children:Fs(Q.data.sent_at)})]}),s.jsxs(y,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:j("contractorsAdmin.detail.proposals.modal.contractorGroup")}),s.jsx("span",{children:a?.name||"N/A"})]}),Q.data.accepted_at&&s.jsxs(y,{className:"d-flex justify-content-between align-items-center border-0 px-0",children:[s.jsx("span",{className:"text-muted",children:j("contractorsAdmin.detail.proposals.modal.accepted")}),s.jsx("span",{className:"text-success",children:Fs(Q.data.accepted_at)})]})]})})]}),Q.data.description&&s.jsxs("div",{className:"mt-3",children:[s.jsx("h6",{className:"text-muted mb-2",children:j("proposals.labels.description")}),s.jsx("div",{className:"bg-light p-3 rounded",children:s.jsx("p",{className:"mb-0",children:Q.data.description})})]})]})]}),s.jsxs(q,{itemKey:"2",children:[s.jsxs(B,{children:[s.jsx(ps,{size:16,className:"me-2","aria-hidden":"true"}),j("contractorsAdmin.detail.proposals.timeline.title")]}),s.jsx(W,{children:s.jsx("div",{className:"timeline",children:(s=>{const e=[];return e.push({status:"created",label:"Created",date:s.createdAt,Icon:os,color:"secondary",completed:!0}),s.sent_at&&e.push({status:"sent",label:"Sent to Customer",date:s.sent_at,Icon:ds,color:"info",completed:!0}),s.accepted_at&&e.push({status:"accepted",label:"Accepted",date:s.accepted_at,Icon:cs,color:"success",completed:!0}),s.status&&!["draft","sent","accepted"].includes(s.status)&&e.push({status:s.status,label:Ps[s.status]?.label||s.status,date:s.updatedAt,Icon:Ls(s.status),color:Es(s.status),completed:!0}),e})(Q.data).map((e,t)=>s.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.jsx("div",{className:`timeline-icon bg-${e.color} text-white rounded-circle d-flex align-items-center justify-content-center me-3`,style:{width:"40px",height:"40px",minWidth:"40px"},children:(()=>{const t=e.Icon||os;return s.jsx(t,{size:18,"aria-hidden":"true"})})()}),s.jsxs("div",{className:"flex-grow-1",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsx("strong",{children:e.label}),s.jsx("small",{className:"text-muted",children:Fs(e.date)})]}),"created"===e.status&&s.jsx("small",{className:"text-muted",children:j("contractorsAdmin.detail.proposals.timeline.created")}),"sent"===e.status&&s.jsx("small",{className:"text-info",children:j("contractorsAdmin.detail.proposals.timeline.sent")}),"accepted"===e.status&&s.jsx("small",{className:"text-success",children:j("contractorsAdmin.detail.proposals.timeline.accepted")}),"approved"===e.status&&s.jsx("small",{className:"text-success",children:j("contractorsAdmin.detail.proposals.timeline.approved")})]})]},t))})})]}),Q.data.items&&Q.data.items.length>0&&s.jsxs(q,{itemKey:"3",children:[s.jsxs(B,{children:[s.jsx(os,{size:16,className:"me-2","aria-hidden":"true"}),j("contractorsAdmin.detail.proposals.itemsTitle",{count:Q.data.items.length})]}),s.jsxs(W,{children:[s.jsx("div",{className:"table-responsive",children:s.jsxs(P,{hover:!0,striped:!0,children:[s.jsx(D,{children:s.jsxs(T,{children:[s.jsx(O,{children:j("proposalColumns.item")}),s.jsx(O,{children:j("proposals.labels.description")}),s.jsx(O,{className:"text-end",children:j("proposalColumns.qty")}),s.jsx(O,{className:"text-end",children:j("proposalDoc.catalog.unitPrice")}),s.jsx(O,{className:"text-end",children:j("proposalColumns.total")})]})}),s.jsx(E,{children:Q.data.items.map((e,t)=>s.jsxs(T,{children:[s.jsx(L,{children:s.jsx("strong",{children:e.name||`Item ${t+1}`})}),s.jsx(L,{children:e.description||"N/A"}),s.jsx(L,{className:"text-end",children:e.quantity||1}),s.jsx(L,{className:"text-end",children:Us(e.unit_price)}),s.jsx(L,{className:"text-end",children:s.jsx("strong",{children:Us((e.quantity||1)*(e.unit_price||0))})})]},t))})]})}),s.jsx("div",{className:"border-top pt-3 mt-3",children:s.jsxs(p,{children:[s.jsx(N,{md:6}),s.jsxs(N,{md:6,children:[s.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[s.jsxs("span",{children:[j("contractorsAdmin.detail.proposals.totals.subtotal"),":"]}),s.jsx("span",{children:Us(Q.data.subtotal_amount||Q.data.total_amount)})]}),Q.data.tax_amount>0&&s.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[s.jsxs("span",{children:[j("contractorsAdmin.detail.proposals.totals.tax"),":"]}),s.jsx("span",{children:Us(Q.data.tax_amount)})]}),s.jsxs("div",{className:"d-flex justify-content-between border-top pt-2",children:[s.jsxs("strong",{children:[j("contractorsAdmin.detail.proposals.totals.total"),":"]}),s.jsx("strong",{className:"text-success",children:Us(Q.data.total_amount)})]})]})]})})]})]})]})]}):s.jsxs(G,{color:"warning",className:"mb-0",children:[s.jsx(us,{size:16,className:"me-2","aria-hidden":"true"}),j("contractorsAdmin.detail.proposals.modal.failed")]})}),s.jsxs(K,{className:"d-flex justify-content-between",children:[s.jsx("div",{children:Ss&&s.jsxs(I,{color:"primary",variant:"outline",className:"icon-btn","aria-label":j("contractorsAdmin.detail.proposals.modal.openFull"),onClick:()=>Ts(Ss.id),children:[s.jsx(hs,{size:16,className:"me-1","aria-hidden":"true"}),j("contractorsAdmin.detail.proposals.modal.openFull")]})}),s.jsx(I,{color:"secondary",onClick:Ds,children:j("common.cancel")})]})]})]})},Cs=({contractor:e,groupId:a})=>{const{t:r}=d(),c=i(),l=(n(s=>s.contractors)||{}).contractorCustomers||{},o=l.data||[],x=l.pagination||{totalPages:0},h=!!l.loading,u=l.error||null,[A,y]=t.useState(""),[w,S]=t.useState({key:null,direction:"asc"}),[I,U]=t.useState(1),[$]=t.useState(10);t.useEffect(()=>{const s=setTimeout(()=>{a&&c(j({groupId:a,page:I,limit:$,search:A}))},300);return()=>clearTimeout(s)},[c,a,I,$,A]),t.useEffect(()=>{u&&m("Failed to load customers","string"==typeof u?u:"")},[u]);const F=s=>{S(e=>{const t=e.key===s&&"asc"===e.direction?"desc":"asc";return{key:s,direction:t}})},H=s=>{if(!s)return"N/A";try{const e=new Date(s);return isNaN(e.getTime())?"N/A":e.toLocaleDateString()}catch(e){return"N/A"}},M=s=>{if(!s)return"N/A";const e=s.replace(/\D/g,"");return 10===e.length?`(${e.slice(0,3)}) ${e.slice(3,6)}-${e.slice(6)}`:s},J=s=>{const e=[];s.address&&e.push(s.address),s.aptOrSuite&&e.push(s.aptOrSuite);const t=[];return s.city&&t.push(s.city),s.state&&t.push(s.state),s.zipCode&&t.push(s.zipCode),t.length>0&&e.push(t.join(", ")),e.length>0?e.join(", "):null},q=t.useMemo(()=>{let s=(Array.isArray(o)?o:[]).filter(s=>s.name?.toLowerCase().includes(A.toLowerCase())||s.email?.toLowerCase().includes(A.toLowerCase())||s.phone?.includes(A));return w.key&&s.sort((s,e)=>{let t=s[w.key],a=e[w.key];return"string"==typeof t&&(t=t.toLowerCase(),a=a.toLowerCase()),t<a?"asc"===w.direction?-1:1:t>a?"asc"===w.direction?1:-1:0}),s},[o,A,w]),B=t.useMemo(()=>{const s=(I-1)*$;return q.slice(s,s+$)},[q,I,$]);return Math.ceil(q.length/$),h?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"200px"},children:s.jsx(z,{color:"primary"})}):s.jsx(p,{children:s.jsx(N,{xs:12,children:s.jsxs(b,{children:[s.jsx(f,{children:s.jsxs("strong",{children:[s.jsx(es,{size:16,className:"me-2","aria-hidden":"true"}),r("contractorsAdmin.detail.customers.header",{count:q.length})]})}),s.jsxs(g,{children:[u&&s.jsx(G,{color:"danger",className:"mb-3",children:"string"==typeof u?u:"Something went wrong"}),s.jsxs(p,{className:"mb-4",children:[s.jsx(N,{md:6,children:s.jsxs(k,{children:[s.jsx(_,{"aria-hidden":"true",children:s.jsx(is,{size:16})}),s.jsx(C,{type:"text",placeholder:r("contractorsAdmin.detail.customers.searchPlaceholder"),"aria-label":r("contractorsAdmin.detail.customers.searchAria","Search contractor customers"),value:A,onChange:s=>{return e=s.target.value,y(e),void U(1);var e}})]})}),s.jsx(N,{md:6,className:"d-flex justify-content-end align-items-center",children:s.jsx("div",{className:"text-muted",children:s.jsx("small",{children:r("contractorsAdmin.detail.customers.showing",{count:B.length,total:q.length})})})})]}),s.jsxs(p,{className:"mb-4",children:[s.jsx(N,{sm:6,lg:3,children:s.jsxs("div",{className:"border-start border-start-4 border-start-info py-1 px-3",children:[s.jsx("div",{className:"text-muted small",children:r("contractorsAdmin.detail.customers.stats.total")}),s.jsx("div",{className:"fs-5 fw-semibold",children:o.length})]})}),s.jsx(N,{sm:6,lg:3,children:s.jsxs("div",{className:"border-start border-start-4 border-start-success py-1 px-3",children:[s.jsx("div",{className:"text-muted small",children:r("contractorsAdmin.detail.customers.stats.active")}),s.jsx("div",{className:"fs-5 fw-semibold",children:o.filter(s=>!s.deleted_at).length})]})}),s.jsx(N,{sm:6,lg:3,children:s.jsxs("div",{className:"border-start border-start-4 border-start-warning py-1 px-3",children:[s.jsx("div",{className:"text-muted small",children:r("contractorsAdmin.detail.customers.stats.withEmail")}),s.jsx("div",{className:"fs-5 fw-semibold",children:o.filter(s=>s.email).length})]})}),s.jsx(N,{sm:6,lg:3,children:s.jsxs("div",{className:"border-start border-start-4 border-start-primary py-1 px-3",children:[s.jsx("div",{className:"text-muted small",children:r("contractorsAdmin.detail.customers.stats.withPhone")}),s.jsx("div",{className:"fs-5 fw-semibold",children:o.filter(s=>s.phone).length})]})})]}),s.jsx("div",{className:"table-wrap d-none d-md-block",children:s.jsxs(P,{hover:!0,striped:!0,className:"table-modern",children:[s.jsx(D,{children:s.jsxs(T,{children:[s.jsxs(O,{scope:"col",className:"cursor-pointer",onClick:()=>F("name"),children:[r("customers.name"),"name"===w.key&&("asc"===w.direction?s.jsx(ms,{size:14,className:"ms-1","aria-hidden":"true"}):s.jsx(xs,{size:14,className:"ms-1","aria-hidden":"true"}))]}),s.jsxs(O,{scope:"col",className:"cursor-pointer",onClick:()=>F("email"),children:[r("customers.email"),"email"===w.key&&("asc"===w.direction?s.jsx(ms,{size:14,className:"ms-1","aria-hidden":"true"}):s.jsx(xs,{size:14,className:"ms-1","aria-hidden":"true"}))]}),s.jsx(O,{scope:"col",children:r("contractorsAdmin.detail.customers.table.phone")}),s.jsx(O,{scope:"col",children:r("contractorsAdmin.detail.customers.table.address")}),s.jsxs(O,{scope:"col",className:"cursor-pointer",onClick:()=>F("created_at"),children:[r("contractorsAdmin.detail.customers.table.created"),"created_at"===w.key&&("asc"===w.direction?s.jsx(ms,{size:14,className:"ms-1","aria-hidden":"true"}):s.jsx(xs,{size:14,className:"ms-1","aria-hidden":"true"}))]}),s.jsx(O,{scope:"col",children:r("contractorsAdmin.detail.customers.table.status")})]})}),s.jsx(E,{children:0===B.length?s.jsx(T,{children:s.jsx(L,{colSpan:"6",children:s.jsx(vs,{title:r("contractorsAdmin.detail.customers.empty.title"),subtitle:r("contractorsAdmin.detail.customers.empty.subtitle")})})}):B.map(e=>s.jsxs(T,{className:"align-middle",children:[s.jsx(L,{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(ss,{size:16,className:"me-2 text-muted","aria-hidden":"true"}),s.jsxs("div",{children:[s.jsx("div",{className:"fw-semibold",children:e.name}),s.jsxs("small",{className:"text-muted",children:["ID: ",e.id]})]})]})}),s.jsx(L,{children:e.email?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ns,{size:14,className:"me-1 text-muted","aria-hidden":"true"}),s.jsx("span",{children:e.email})]}):s.jsx("small",{className:"text-muted",children:r("contractorsAdmin.detail.customers.noEmail")})}),s.jsx(L,{children:e.phone?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(bs,{size:14,className:"me-1 text-muted","aria-hidden":"true"}),s.jsx("span",{children:M(e.phone)})]}):s.jsx("small",{className:"text-muted",children:r("contractorsAdmin.detail.customers.noPhone")})}),s.jsx(L,{children:J(e)?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(js,{size:14,className:"me-1 text-muted","aria-hidden":"true"}),s.jsx("small",{children:J(e)})]}):s.jsx("small",{className:"text-muted",children:r("contractorsAdmin.detail.customers.noAddress")})}),s.jsx(L,{children:s.jsxs("small",{className:"text-muted",children:[s.jsx(rs,{size:14,className:"me-1","aria-hidden":"true"}),H(e.created_at)]})}),s.jsx(L,{children:s.jsx(v,{color:e.deleted_at?"danger":"success",children:e.deleted_at?r("contractorsAdmin.detail.customers.inactive"):r("contractorsAdmin.detail.customers.active")})})]},e.id))})]})}),s.jsx("div",{className:"d-md-none",children:0===B.length?s.jsx(vs,{title:r("contractorsAdmin.detail.customers.empty.title"),subtitle:r("contractorsAdmin.detail.customers.empty.subtitle")}):s.jsx("div",{className:"mobile-customer-cards",children:B.map(e=>s.jsx(b,{className:"mb-3 customer-mobile-card",children:s.jsxs(g,{className:"p-3",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[s.jsxs("div",{className:"d-flex align-items-center flex-grow-1 min-width-0",children:[s.jsx(ss,{size:20,className:"me-2 text-muted","aria-hidden":"true"}),s.jsxs("div",{className:"flex-grow-1 min-width-0",children:[s.jsx("div",{className:"fw-semibold text-truncate",title:e.name,children:e.name}),s.jsxs("small",{className:"text-muted",children:["ID: ",e.id]})]})]}),s.jsx(v,{color:e.deleted_at?"danger":"success",children:e.deleted_at?r("contractorsAdmin.detail.customers.inactive"):r("contractorsAdmin.detail.customers.active")})]}),s.jsxs("div",{className:"row g-2 mb-3",children:[s.jsxs("div",{className:"col-12",children:[s.jsx("div",{className:"small text-muted",children:r("customers.email")}),e.email?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(Ns,{size:14,className:"me-1 text-muted","aria-hidden":"true"}),s.jsx("span",{className:"text-truncate-mobile",title:e.email,children:e.email})]}):s.jsx("small",{className:"text-muted",children:r("contractorsAdmin.detail.customers.noEmail")})]}),s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"small text-muted",children:r("contractorsAdmin.detail.customers.table.phone")}),e.phone?s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(bs,{size:14,className:"me-1 text-muted","aria-hidden":"true"}),s.jsx("span",{children:M(e.phone)})]}):s.jsx("small",{className:"text-muted",children:"No phone"})]}),s.jsxs("div",{className:"col-6",children:[s.jsx("div",{className:"small text-muted",children:r("contractorsAdmin.detail.customers.table.created")}),s.jsxs("small",{children:[s.jsx(rs,{size:14,className:"me-1","aria-hidden":"true"}),H(e.created_at)]})]})]}),J(e)&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"small text-muted",children:r("contractorsAdmin.detail.customers.table.address")}),s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx(js,{size:14,className:"me-1 text-muted mt-1","aria-hidden":"true"}),s.jsx("small",{className:"flex-grow-1",children:J(e)})]})]})]})},e.id))})}),x?.totalPages>1&&s.jsx("div",{className:"pt-3 border-top border-light",children:s.jsx(ws,{currentPage:I,totalPages:x?.totalPages||1,onPageChange:s=>{U(s)},itemsPerPage:$})})]})]})})})},Ss=({contractor:e})=>{const{t:t}=d(),a=e.contractor_settings||{};let r=e.modules||{};if("string"==typeof r)try{r=JSON.parse(r)}catch(o){r={}}let c=a;if("string"==typeof a)try{c=JSON.parse(a)}catch(o){c={}}const l=e=>e?s.jsxs(v,{color:"success",children:[s.jsx(cs,{size:14,className:"me-1","aria-hidden":"true"}),t("contractorsAdmin.detail.enabled")]}):s.jsxs(v,{color:"danger",children:[s.jsx(ls,{size:14,className:"me-1","aria-hidden":"true"}),t("contractorsAdmin.detail.disabled")]}),i={dashboard:t("contractorsAdmin.modules.dashboard"),proposals:t("contractorsAdmin.modules.proposals"),customers:t("contractorsAdmin.modules.customers"),resources:t("contractorsAdmin.modules.resources")},n={allow_subcontractors:t("contractorsAdmin.detail.settings.labels.allowSubcontractors"),max_users:t("contractorsAdmin.detail.settings.labels.maxUsers"),billing_enabled:t("contractorsAdmin.detail.settings.labels.billingEnabled"),custom_branding:t("contractorsAdmin.detail.settings.labels.customBranding"),api_access:t("contractorsAdmin.detail.settings.labels.apiAccess"),notification_preferences:t("contractorsAdmin.detail.settings.labels.notificationPreferences"),data_retention_days:t("contractorsAdmin.detail.settings.labels.dataRetentionDays"),timezone:t("contractorsAdmin.detail.settings.labels.timezone"),locale:t("contractorsAdmin.detail.settings.labels.locale")};return s.jsxs(p,{children:[s.jsx(N,{md:6,className:"mb-4",children:s.jsxs(b,{children:[s.jsx(f,{children:s.jsxs("strong",{children:[s.jsx(gs,{size:16,className:"me-2","aria-hidden":"true"}),t("contractorsAdmin.detail.moduleAccess.title")]})}),s.jsx(g,{children:0===Object.keys(r).length?s.jsxs(G,{color:"info",children:[s.jsx(us,{size:16,className:"me-2","aria-hidden":"true"}),t("contractorsAdmin.detail.settings.noModuleSettings")]}):s.jsx(A,{flush:!0,children:Object.entries(r).map(([e,a])=>s.jsxs(y,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[s.jsx("strong",{children:i[e]||e}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["dashboard"===e&&t("contractorsAdmin.detail.settings.moduleDescriptions.dashboard"),"proposals"===e&&t("contractorsAdmin.detail.settings.moduleDescriptions.proposals"),"customers"===e&&t("contractorsAdmin.detail.settings.moduleDescriptions.customers"),"resources"===e&&t("contractorsAdmin.detail.settings.moduleDescriptions.resources")]})]}),l(a)]},e))})})]})}),s.jsx(N,{md:6,className:"mb-4",children:s.jsxs(b,{children:[s.jsx(f,{children:s.jsxs("strong",{children:[s.jsx(fs,{size:16,className:"me-2","aria-hidden":"true"}),t("contractorsAdmin.detail.settings.title")]})}),s.jsx(g,{children:0===Object.keys(c).length?s.jsxs(G,{color:"info",children:[s.jsx(us,{size:16,className:"me-2","aria-hidden":"true"}),t("contractorsAdmin.detail.settings.noneConfigured")]}):s.jsx(A,{flush:!0,children:Object.entries(c).map(([e,a])=>s.jsxs(y,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("span",{children:[s.jsx("strong",{children:n[e]||e.replace(/_/g," ")}),s.jsx("br",{}),s.jsxs("small",{className:"text-muted",children:["allow_subcontractors"===e&&t("contractorsAdmin.detail.settings.descriptions.allowSubcontractors"),"max_users"===e&&t("contractorsAdmin.detail.settings.descriptions.maxUsers"),"billing_enabled"===e&&t("contractorsAdmin.detail.settings.descriptions.billingEnabled"),"custom_branding"===e&&t("contractorsAdmin.detail.settings.descriptions.customBranding"),"api_access"===e&&t("contractorsAdmin.detail.settings.descriptions.apiAccess"),"data_retention_days"===e&&t("contractorsAdmin.detail.settings.descriptions.dataRetentionDays")]})]}),s.jsx("span",{children:"boolean"==typeof a?l(a):"object"==typeof a?s.jsx(v,{color:"info",children:t("contractorsAdmin.detail.settings.objectLabel")}):s.jsx("strong",{children:a})})]},e))})})]})}),s.jsx(N,{xs:12,children:s.jsxs(b,{children:[s.jsx(f,{children:s.jsxs("strong",{children:[s.jsx(us,{size:16,className:"me-2","aria-hidden":"true"}),t("contractorsAdmin.detail.settings.raw.title")]})}),s.jsx(g,{children:s.jsxs(p,{children:[s.jsxs(N,{md:6,children:[s.jsx("h6",{children:t("contractorsAdmin.detail.settings.raw.modules")}),s.jsx("pre",{className:"bg-light p-3 rounded small",children:s.jsx("code",{children:JSON.stringify(r,null,2)})})]}),s.jsxs(N,{md:6,children:[s.jsx("h6",{children:t("contractorsAdmin.detail.settings.raw.contractorSettings")}),s.jsx("pre",{className:"bg-light p-3 rounded small",children:s.jsx("code",{children:JSON.stringify(a,null,2)})})]})]})})]})}),s.jsx(N,{xs:12,children:s.jsxs(b,{children:[s.jsx(f,{children:s.jsx("strong",{children:t("contractorsAdmin.detail.settings.summary.title")})}),s.jsx(g,{children:s.jsxs(p,{children:[s.jsxs(N,{md:4,className:"text-center border-end",children:[s.jsx("h4",{className:"text-primary",children:Object.values(r).filter(Boolean).length}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.settings.summary.enabledModules")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.settings.summary.ofTotal",{total:Object.keys(r).length})})]}),s.jsxs(N,{md:4,className:"text-center border-end",children:[s.jsx("h4",{className:"text-info",children:Object.keys(a).length}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.settings.summary.settingsConfigured")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.settings.summary.customOptions")})]}),s.jsxs(N,{md:4,className:"text-center",children:[s.jsx("h4",{className:"text-success",children:a.max_users||t("contractorsAdmin.detail.settings.summary.unlimited")}),s.jsx("p",{className:"text-muted mb-0",children:t("contractorsAdmin.detail.settings.summary.maxUsers")}),s.jsx("small",{className:"text-muted",children:t("contractorsAdmin.detail.settings.summary.userLimitHint")})]})]})})]})})]})},Is=()=>{const{t:r}=d(),{groupId:c}=a(),o=l(c),m=i(),x=e(),{selectedContractor:h,loading:j,error:A}=n(s=>s.contractors),[y,w]=t.useState("overview");t.useEffect(()=>{o&&m(u(o))},[m,o]);const k=()=>{x("/admin/contractors")},_=[{key:"overview",label:r("contractorsAdmin.detail.tabs.overview"),icon:"chart",component:ks},{key:"proposals",label:r("contractorsAdmin.detail.tabs.proposals"),icon:"briefcase",component:_s},{key:"customers",label:r("contractorsAdmin.detail.tabs.customers"),icon:"group",component:Cs},{key:"settings",label:r("contractorsAdmin.detail.tabs.settings"),icon:"settings",component:Ss}];return j?s.jsx(R,{children:s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"300px"},children:s.jsx(z,{color:"primary"})})}):A?s.jsx(R,{children:s.jsxs(G,{color:"danger",children:[s.jsx("h4",{children:r("contractorsAdmin.detail.errorTitle")}),s.jsx("p",{children:A}),s.jsxs(I,{color:"primary",onClick:k,"aria-label":r("common.back"),className:"d-inline-flex align-items-center",children:[s.jsx(As,{size:16,className:"me-2","aria-hidden":"true"}),r("contractorsAdmin.detail.backToList")]})]})}):h?s.jsx(R,{className:"px-4",children:s.jsx(p,{children:s.jsxs(N,{xs:12,children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4 contractor-detail-header",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsxs(I,{color:"outline-secondary",size:"sm",onClick:k,className:"me-3 d-flex align-items-center",style:{minWidth:"44px",minHeight:"44px"},children:[s.jsx(As,{size:16,"aria-hidden":"true"}),s.jsx("span",{className:"d-none d-sm-inline ms-1",children:r("common.back")})]}),s.jsxs("div",{children:[s.jsxs("h2",{className:"mb-0 d-flex align-items-center",children:[s.jsx(es,{size:20,className:"me-2","aria-hidden":"true"}),s.jsx("span",{className:"text-truncate",style:{maxWidth:"200px"},children:h.name})]}),s.jsxs("small",{className:"text-muted",children:[r("contractorsAdmin.detail.contractorId"),": ",h.id]})]})]}),s.jsx(v,{color:"info",size:"lg",children:h.group_type||r("contractorsAdmin.detail.contractor")})]}),s.jsxs(b,{children:[s.jsx(f,{className:"pb-0",children:s.jsx(V,{variant:"tabs",role:"tablist",children:_.map(e=>s.jsx(X,{children:s.jsxs(Z,{active:y===e.key,onClick:()=>w(e.key),className:"cursor-pointer","aria-current":y===e.key?"page":void 0,role:"tab",children:["chart"===e.icon&&s.jsx(ys,{size:16,className:"me-2","aria-hidden":"true"}),"briefcase"===e.icon&&s.jsx(ts,{size:16,className:"me-2","aria-hidden":"true"}),"group"===e.icon&&s.jsx(es,{size:16,className:"me-2","aria-hidden":"true"}),"settings"===e.icon&&s.jsx(fs,{size:16,className:"me-2","aria-hidden":"true"}),e.label]})},e.key))})}),s.jsx(g,{children:s.jsx(Q,{children:_.map(e=>{const t=e.component;return s.jsx(Y,{role:"tabpanel","aria-labelledby":`${e.key}-tab`,visible:y===e.key,children:s.jsx(t,{contractor:h,groupId:o})},e.key)})})})]})]})})}):s.jsx(R,{children:s.jsxs(G,{color:"warning",children:[s.jsx("h4",{children:r("contractorsAdmin.detail.notFoundTitle")}),s.jsx("p",{children:r("contractorsAdmin.detail.notFoundText")}),s.jsxs(I,{color:"primary",onClick:k,"aria-label":r("common.back"),className:"d-inline-flex align-items-center",children:[s.jsx(As,{size:16,className:"me-2","aria-hidden":"true"}),r("contractorsAdmin.detail.backToList")]})]})})};export{Is as default};
