import{j as e}from"./date-vendor-D9pAgX5F.js";import{u as s,i as o,r}from"./react-vendor-DF7UJAlN.js";import{u as a,a as t}from"./redux-vendor-BzdbewH4.js";import{d as l,c as i,a as n}from"./DefaultLayout-BUcG_pV2.js";import{h as m,U as c,V as d,b as u,c as h,e as x,u as j,d as p,a as f,H as v,I as b,W as y,X as g,J as C,w as N,a5 as S,C as F}from"./ui-vendor-DjmSPU99.js";import{u as k,m as w,o as T,p as z}from"./index-DW-yAxzW.js";import{w as D}from"./withContractorScope-CFJqUjZ-.js";import{S as O}from"./utils-vendor-Nl-sF5xe.js";import{c as P}from"./cil-arrow-left-D66Kb3Zq.js";import{c as I}from"./cil-envelope-closed-DSbcONbs.js";import{c as B}from"./cil-phone-4mwkG2LD.js";import{c as E}from"./cil-save-CHBg7z_U.js";import"./form-vendor-CKNVq0c_.js";import"./icons-vendor-D82TZqJV.js";const G=D(({isContractor:D,contractorGroupId:G,contractorModules:R,contractorGroupName:W})=>{const q=a(),H=s(),{id:L}=o(),A=l(L),J=Boolean(A),{t:M}=k(),{loading:U,error:V}=t(e=>e.customers),X=t(e=>e.customers.list),[Y,$]=r.useState({name:"",email:"",homePhone:"",mobile:"",address:"",aptOrSuite:"",city:"",state:"",zipCode:"",companyName:"",customerType:"",leadSource:"",defaultDiscount:0,note:""}),[K,Q]=r.useState({});r.useEffect(()=>{if(J&&X.length>0){const e=X.find(e=>e.id===parseInt(A));e?$({name:e.name||"",email:e.email||"",homePhone:e.homePhone||"",mobile:e.mobile||"",address:e.address||"",aptOrSuite:e.aptOrSuite||"",city:e.city||"",state:e.state||"",zipCode:e.zipCode||"",companyName:e.companyName||"",customerType:e.customerType||"",leadSource:e.leadSource||"",defaultDiscount:e.defaultDiscount||0,note:e.note||""}):X.length>0&&(O.fire(M("common.error"),M("customers.form.alerts.notFound"),"error"),H("/customers"))}},[J,A,X,H]),r.useEffect(()=>{if(J&&0===X.length){q(w({page:1,limit:1e3,groupId:D?G:null}))}},[J,X.length,q,D,G]);const Z=e=>{const{name:s,value:o}=e.target;$(e=>({...e,[s]:o})),K[s]&&Q(e=>({...e,[s]:""}))},_=()=>{H("/customers")};return e.jsxs(m,{fluid:!0,children:[e.jsx("style",{children:"\n        .settings-form-container .btn, .add-new-customer .btn, .customers-form .btn { min-height: 44px; }\n      "}),e.jsx(c,{children:e.jsx(d,{xs:12,children:e.jsxs(u,{children:[e.jsxs(h,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:M(J?"customers.form.titles.edit":"customers.form.titles.add")}),D&&e.jsx("p",{className:"text-muted mb-0",children:W})]}),e.jsxs(x,{color:"light",onClick:_,className:"d-flex align-items-center gap-2","aria-label":M("customers.form.actions.backToCustomers"),children:[e.jsx(j,{icon:P,size:"sm"}),M("customers.form.actions.backToCustomers")]})]}),e.jsxs(p,{children:[V&&e.jsx(f,{color:"danger",className:"mb-3",children:V}),e.jsxs(v,{onSubmit:async e=>{e.preventDefault();const s=(()=>{const e={};return Y.name.trim()||(e.name=M("customers.form.validation.nameRequired")),Y.email&&!/\S+@\S+\.\S+/.test(Y.email)&&(e.email=M("customers.form.validation.invalidEmail")),Y.mobile.trim()||Y.homePhone.trim()||(e.phone=M("customers.form.validation.phoneAtLeastOne")),e})();if(Object.keys(s).length>0)Q(s);else try{J?(await q(T({id:parseInt(A),customerData:Y})).unwrap(),O.fire(M("common.success"),M("customers.form.alerts.updatedText"),"success")):(await q(z(Y)).unwrap(),O.fire(M("common.success"),M("customers.form.alerts.createdText"),"success")),H("/customers")}catch(o){O.fire(M("common.error"),o.message||M("customers.form.alerts.saveFailed"),"error")}},children:[e.jsxs(c,{children:[e.jsx(d,{md:6,children:e.jsxs("div",{style:{marginBottom:"var(--sp-3)"},children:[e.jsxs(b,{htmlFor:"name",children:[M("customers.form.labels.fullName")," *"]}),e.jsxs(y,{children:[e.jsx(g,{children:e.jsx(j,{icon:i})}),e.jsx(C,{type:"text",id:"name",name:"name",value:Y.name,onChange:Z,invalid:!!K.name,required:!0,style:{minHeight:"44px"}})]}),K.name&&e.jsx("div",{className:"invalid-feedback d-block",children:K.name})]})}),e.jsx(d,{md:6,children:e.jsxs("div",{style:{marginBottom:"var(--sp-3)"},children:[e.jsx(b,{htmlFor:"email",children:M("customers.form.labels.email")}),e.jsxs(y,{children:[e.jsx(g,{children:e.jsx(j,{icon:I})}),e.jsx(C,{type:"email",id:"email",name:"email",value:Y.email,onChange:Z,invalid:!!K.email})]}),K.email&&e.jsx("div",{className:"invalid-feedback d-block",children:K.email})]})})]}),e.jsxs(c,{children:[e.jsx(d,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"mobile",children:M("customers.form.labels.mobile")}),e.jsxs(y,{children:[e.jsx(g,{children:e.jsx(j,{icon:B})}),e.jsx(C,{type:"tel",id:"mobile",name:"mobile",value:Y.mobile,onChange:Z,invalid:!!K.phone})]})]})}),e.jsx(d,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"homePhone",children:M("customers.form.labels.homePhone")}),e.jsxs(y,{children:[e.jsx(g,{children:e.jsx(j,{icon:B})}),e.jsx(C,{type:"tel",id:"homePhone",name:"homePhone",value:Y.homePhone,onChange:Z,invalid:!!K.phone})]}),K.phone&&e.jsx("div",{className:"invalid-feedback d-block",children:K.phone})]})})]}),e.jsx(c,{children:e.jsx(d,{md:12,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"address",children:M("customers.form.labels.address")}),e.jsxs(y,{children:[e.jsx(g,{children:e.jsx(j,{icon:n})}),e.jsx(C,{type:"text",id:"address",name:"address",value:Y.address,onChange:Z})]})]})})}),e.jsxs(c,{children:[e.jsx(d,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"aptOrSuite",children:M("customers.form.labels.aptSuite")}),e.jsx(C,{type:"text",id:"aptOrSuite",name:"aptOrSuite",value:Y.aptOrSuite,onChange:Z})]})}),e.jsx(d,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"city",children:M("customers.form.labels.city")}),e.jsx(C,{type:"text",id:"city",name:"city",value:Y.city,onChange:Z})]})}),e.jsx(d,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"state",children:M("customers.form.labels.state")}),e.jsx(C,{type:"text",id:"state",name:"state",value:Y.state,onChange:Z})]})}),e.jsx(d,{md:3,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"zipCode",children:M("customers.form.labels.zipCode")}),e.jsx(C,{type:"text",id:"zipCode",name:"zipCode",value:Y.zipCode,onChange:Z})]})})]}),e.jsxs(c,{children:[e.jsx(d,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"companyName",children:M("customers.form.labels.companyName")}),e.jsx(C,{type:"text",id:"companyName",name:"companyName",value:Y.companyName,onChange:Z})]})}),e.jsx(d,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"customerType",children:M("customers.form.labels.customerType")}),e.jsxs(N,{id:"customerType",name:"customerType",value:Y.customerType,onChange:Z,children:[e.jsx("option",{value:"",children:M("customers.form.select.selectType")}),e.jsx("option",{value:"Residential",children:M("customers.form.types.residential")}),e.jsx("option",{value:"Commercial",children:M("customers.form.types.commercial")}),e.jsx("option",{value:"Contractor",children:M("customers.form.types.contractor")}),e.jsx("option",{value:"Sub Contractor",children:M("customers.form.types.subContractor")})]})]})})]}),e.jsxs(c,{children:[e.jsx(d,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"leadSource",children:M("customers.form.labels.leadSource")}),e.jsxs(N,{id:"leadSource",name:"leadSource",value:Y.leadSource,onChange:Z,children:[e.jsx("option",{value:"",children:M("customers.form.select.selectSource")}),e.jsx("option",{value:"Website",children:M("customers.form.sources.website")}),e.jsx("option",{value:"Referral",children:M("customers.form.sources.referral")}),e.jsx("option",{value:"Google",children:M("customers.form.sources.google")}),e.jsx("option",{value:"Facebook",children:M("customers.form.sources.facebook")}),e.jsx("option",{value:"Phone Call",children:M("customers.form.sources.phoneCall")}),e.jsx("option",{value:"Walk-in",children:M("customers.form.sources.walkIn")}),e.jsx("option",{value:"Other",children:M("customers.form.sources.other")})]})]})}),e.jsx(d,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"defaultDiscount",children:M("customers.form.labels.defaultDiscount")}),e.jsx(C,{type:"number",id:"defaultDiscount",name:"defaultDiscount",value:Y.defaultDiscount,onChange:Z,min:"0",max:"100"})]})})]}),e.jsx(c,{children:e.jsx(d,{md:12,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(b,{htmlFor:"note",children:M("customers.form.labels.notes")}),e.jsx(S,{id:"note",name:"note",rows:"3",value:Y.note,onChange:Z,placeholder:M("customers.form.placeholders.notes")})]})})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(x,{type:"button",color:"light",onClick:_,disabled:U,children:M("customers.form.actions.cancel")}),e.jsxs(x,{type:"submit",color:"primary",disabled:U,className:"d-flex align-items-center gap-2",children:[U?e.jsx(F,{size:"sm"}):e.jsx(j,{icon:E,size:"sm"}),M(J?"customers.form.actions.update":"customers.form.actions.create")]})]})]})]})]})})})]})},"customers");export{G as default};
