import{j as s}from"./date-vendor-D9pAgX5F.js";import{r as e}from"./react-vendor-DF7UJAlN.js";import{a as t}from"./redux-vendor-BzdbewH4.js";import{k as r,P as a,p as n,q as i,s as o}from"./DefaultLayout-BUcG_pV2.js";import{S as l}from"./utils-vendor-Nl-sF5xe.js";import{u as c}from"./index-DW-yAxzW.js";import{U as d,V as m,b as h,d as u,H as x,a5 as j,e as g,$ as p,a0 as v,a1 as b,a2 as f,a3 as w,a4 as y,v as N}from"./ui-vendor-DjmSPU99.js";import"./form-vendor-CKNVq0c_.js";import"./icons-vendor-D82TZqJV.js";const S=()=>{const{t:S}=c(),C=t(s=>s.auth.user),E=e.useMemo(()=>r(C),[C]),[P,k]=e.useState(""),[T,V]=e.useState(null),[A,M]=e.useState(!1),[F,U]=e.useState({version:null,users:[]}),q=async()=>{try{const s=await n(),e=s?.data?.data;if(e?(k(e.content||""),V(e.version)):(k(""),V(null)),E){const s=await i();U(s?.data?.data||{version:null,users:[]})}}catch(s){k(""),V(null)}};e.useEffect(()=>{q()},[]);const B=async s=>{if(E){M(!0);try{await o({content:P,bumpVersion:!!s}),await l.fire({icon:"success",title:s?S("settings.terms.publishedTitle","Published"):S("common.saved","Saved"),text:s?S("settings.terms.publishedMessage","A new version of your Terms & Conditions has been published."):S("settings.terms.updatedMessage","Your Terms & Conditions have been updated."),timer:1600,showConfirmButton:!1}),await q()}catch(e){l.fire({icon:"error",title:S("common.error","Error"),text:e?.response?.data?.message||S("settings.terms.saveError","Failed to save terms. Please try again.")})}finally{M(!1)}}};return E?s.jsxs(s.Fragment,{children:[s.jsx("style",{children:"\n        .settings-terms .btn, .btn { min-height: 44px; }\n      "}),s.jsx(a,{title:S("settings.terms.title","Terms & Conditions"),subtitle:S("settings.terms.subtitle","Edit terms and track acceptance")}),s.jsxs(d,{className:"g-3",children:[s.jsx(m,{lg:6,children:s.jsx(h,{className:"border-0 shadow-sm",children:s.jsxs(u,{children:[s.jsx("h6",{className:"mb-3",children:S("settings.terms.editor","Editor")}),s.jsxs(x,{children:[s.jsx(j,{rows:16,value:P,onChange:s=>k(s.target.value),placeholder:S("settings.terms.placeholder","Enter terms and conditions...")}),s.jsxs("div",{className:"mt-3 d-flex gap-2",children:[s.jsx(g,{color:"primary",disabled:A,onClick:()=>B(!1),children:A?S("common.saving","Saving..."):S("common.save","Save")}),s.jsx(g,{color:"warning",variant:"outline",disabled:A,onClick:()=>B(!0),children:S("settings.terms.publishNew","Publish as new version")})]}),T&&s.jsxs("div",{className:"text-muted mt-2 small",children:[S("settings.terms.currentVersion","Current version"),": ",T]})]})]})})}),s.jsx(m,{lg:6,children:s.jsx(h,{className:"border-0 shadow-sm",children:s.jsxs(u,{children:[s.jsx("h6",{className:"mb-3",children:S("settings.terms.acceptance","Acceptance")}),s.jsxs("div",{className:"text-muted small mb-2",children:[S("settings.terms.version","Version"),": ",F?.version??"-"]}),s.jsxs(p,{hover:!0,responsive:!0,children:[s.jsx(v,{children:s.jsxs(b,{children:[s.jsx(f,{children:S("common.user","User")}),s.jsx(f,{children:S("common.email","Email")}),s.jsx(f,{className:"text-end",children:S("settings.terms.status","Status")})]})}),s.jsx(w,{children:(F.users||[]).map(e=>s.jsxs(b,{children:[s.jsx(y,{children:e.name||"-"}),s.jsx(y,{children:e.email||"-"}),s.jsx(y,{className:"text-end",children:e.accepted?s.jsx(N,{color:"success",children:S("settings.terms.accepted","Accepted")}):s.jsx(N,{color:"secondary",children:S("settings.terms.pending","Pending")})})]},e.id))})]})]})})})]})]}):null};export{S as default};
